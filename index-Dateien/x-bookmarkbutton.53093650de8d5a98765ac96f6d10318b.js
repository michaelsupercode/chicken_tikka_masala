/*! For license information please see x-bookmarkbutton.53093650de8d5a98765ac96f6d10318b.js.LICENSE.txt */
(()=>{"use strict";var t={75496:(t,e,r)=>{function n(t,e){return e.get?e.get.call(t):e.value}r.d(e,{c:()=>n})},54496:(t,e,r)=>{function n(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}r.d(e,{c:()=>n})},41640:(t,e,r)=>{function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}r.d(e,{c:()=>n})},96672:(t,e,r)=>{function n(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}r.d(e,{c:()=>n})},35420:(t,e,r)=>{r.d(e,{c:()=>o});var n=r(75496),i=r(96672);function o(t,e){var r=(0,i.c)(t,e,"get");return(0,n.c)(t,r)}},36972:(t,e,r)=>{r.d(e,{c:()=>o});var n=r(54496),i=r(96672);function o(t,e,r){var o=(0,i.c)(t,e,"set");return(0,n.c)(t,o,r),r}},60664:(t,e,r)=>{r.d(e,{c:()=>o});var n=r(48852);function i(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(0,n.c)(i.key),i)}}function o(t,e,r){return e&&i(t.prototype,e),r&&i(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}},668:(t,e,r)=>{r.d(e,{c:()=>i});var n=r(15804);function i(t,e){if("object"!=(0,n.c)(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=(0,n.c)(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}},48852:(t,e,r)=>{r.d(e,{c:()=>o});var n=r(15804),i=r(668);function o(t){var e=(0,i.c)(t,"string");return"symbol"==(0,n.c)(e)?e:String(e)}},15804:(t,e,r)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}r.d(e,{c:()=>n})}},e={};function r(n){var i=e[n];if(void 0!==i)return i.exports;var o=e[n]={exports:{}};return t[n](o,o.exports,r),o.exports}r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t=r(41640),e=r(60664),n=r(35420),i=r(36972);function o(){return a&&(!0===navigator.connection.saveData||["slow-2g","2g"].includes(navigator.connection.effectiveType))}const a="connection"in navigator,s="IntersectionObserver"in window,c="x-bookmarkbutton",l=document.createElement("style");l.innerHTML=`\n  ${c} {\n    display: block;\n  }\n  ${c}[disabled] button {\n    pointer-events: none;\n  }\n`,document.head.appendChild(l);const u=document.createElement("template");u.innerHTML='<button class="bookmarkbutton"></button>';class d extends HTMLElement{static get observedAttributes(){return["active","disabled"]}get csrfRef(){return this.getAttribute("csrf-ref")}get contentId(){return this.getAttribute("content-id")}get paidCategory(){return this.getAttribute("paid-category")}get disabled(){return this.hasAttribute("disabled")}get active(){return this.hasAttribute("active")}set active(t){t?this.setAttribute("active",""):this.removeAttribute("active")}get root(){return this.hasAttribute("root")?this.closest(this.getAttribute("root")):null}get rootMargin(){return this.hasAttribute("rootMargin")?this.getAttribute("rootMargin"):null}constructor(){super(),this.appendChild(u.content.cloneNode(!0)),this.$bookmarkButton=this.querySelector(".bookmarkbutton")}disconnectedCallback(){this.intersectionObserver&&this.intersectionObserver.disconnect()}connectedCallback(){this.intersectionObserver=null,this.setButtonAriaLabel(this.active),this.initialize(),this.registerEvents()}initialize(){this.disabled||(s?this.intersectionObserver=function(t,e,r,n=!0){const i={rootMargin:o()?"0px 0px 0px 0px":"300% 25%",threshold:n?[0,.25,.5,.75,1]:0},a=new IntersectionObserver((([r])=>{!r.isIntersecting&&r.intersectionRatio<=0||(e.bind(t)(r),n&&a.unobserve(t))}),{...i,...r});return a.observe(t),a}(this,this.load,{...this.root&&{root:this.root},...this.rootMargin&&!o()&&{rootMargin:this.rootMargin}}):this.load())}registerEvents(){this.$bookmarkButton.addEventListener("click",(()=>{this.disabled||(this.active?this.deleteBookmark():this.addBookmark())}))}async load(){this.active||(this.active=await this.getBookmarked())}async getCSRFToken(){const t=document.querySelector(this.csrfRef);if(!t)throw new Error("Attribute 'csrf-ref' must point to a valid CSRF token provider.");return await window.customElements.whenDefined(t.tagName.toLowerCase()).then((async()=>{if(!t||!("token"in t))throw new Error("Attribute 'csrf-ref' must point to a valid CSRF token provider.");return await t.token}))}async getBookmarked(){const t=`/p-api/lists/bookmarks/items?contentId=${this.contentId}`;let e=null;try{e=await this.fetchResult(t)}catch(t){this.handleError(t)}return e?.items?.length>0}async addBookmark(){this.active=!0;try{const t=await this.getCSRFToken(),e=await fetch("/p-api/lists/bookmarks/items",{method:"POST",body:JSON.stringify({contentId:this.contentId,paidCategories:this.paidCategory?this.paidCategory.split(","):[]}),headers:{"X-CSRF-Token":t}});if(!1===e.ok)throw new Error(`Request failed: ${e.status} - ${e.statusText}`);this.triggerEvent("toggleBookmark",{action:"add"})}catch(t){this.active=!1,this.handleError(t)}}async deleteBookmark(){this.active=!1;const t=`/p-api/lists/bookmarks/items/${this.contentId}`;try{const e=await this.getCSRFToken(),r=await fetch(t,{method:"DELETE",headers:{"X-CSRF-Token":e}});if(!1===r.ok)throw new Error(`Request failed: ${r.status} - ${r.statusText}`);this.triggerEvent("toggleBookmark",{action:"delete"})}catch(t){this.active=!0,this.handleError(t)}}async fetchResult(t){try{const e=await fetch(t,{headers:{accept:"application/json"}});if(!1===e.ok)throw new Error(`Request failed: ${e.status} - ${e.statusText}`);return await e.json()}catch(t){throw new Error(t.message)}}triggerEvent(t,e={}){this.dispatchEvent(new CustomEvent(t,{detail:{...e,contentId:this.contentId,paidCategory:this.paidCategory}}))}handleError(t){console.error(t.message),this.triggerEvent("error",{message:t.message})}setButtonAriaLabel(t){this.$bookmarkButton.setAttribute("aria-label",t?"Von Merkliste entfernen":"Zur Merkliste hinzuf√ºgen")}attributeChangedCallback(t,e,r){"disabled"===t&&null===r&&this.initialize(),"active"===t&&e!==r&&this.setButtonAriaLabel(null!==r)}}"customElements"in window&&void 0===window.customElements.get(c)&&window.customElements.define(c,d);var h="notify";function v(t,e,r){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,r)}var b=new WeakMap,f=new WeakMap,p=new WeakMap,g=new WeakMap,m=new WeakMap,k=function(){function r(e,o){var a=this;(0,t.c)(this,r),v(this,b,{writable:!0,value:void 0}),v(this,f,{writable:!0,value:void 0}),v(this,p,{writable:!0,value:function(t){var e;null!==(e=(0,n.c)(a,f).config.get("loginState.hasFullAccess"))&&void 0!==e&&e||(0,n.c)(a,f).eventObserver.dispatch("paywall-overlay:open-modal","BOOKMARK_REJECT")}}),v(this,g,{writable:!0,value:function(t){var e=t.detail.action,r=t.target,i=r.closest(".teaser");r.classList.contains("x-bookmarkbutton--authors")&&(0,n.c)(a,f).eventObserver.dispatch("bookmarks",t),"add"===e?(0,n.c)(a,f).eventObserver.dispatch(h,"BOOKMARK_ADD",t):"delete"===e&&(i&&(i.style.display="none"),(0,n.c)(a,f).eventObserver.dispatch(h,"BOOKMARK_DELETE",t))}}),v(this,m,{writable:!0,value:function(t){(0,n.c)(a,f).eventObserver.dispatch(h,"BOOKMARK_ERROR",t)}}),(0,i.c)(this,b,e),(0,i.c)(this,f,o)}return(0,e.c)(r,[{key:"init",value:function(){var t=this;(0,n.c)(this,b).forEach((function(e){e.addEventListener("click",(0,n.c)(t,p)),e.addEventListener("error",(0,n.c)(t,m)),e.addEventListener("toggleBookmark",(0,n.c)(t,g))}))}},{key:"destroy",value:function(){var t=this;(0,n.c)(this,b).forEach((function(e){e.removeEventListener("click",(0,n.c)(t,p)),e.removeEventListener("error",(0,n.c)(t,m)),e.removeEventListener("toggleBookmark",(0,n.c)(t,g))}))}}]),r}(),w=window.gujService,y=Array.from(document.querySelectorAll("x-bookmarkbutton"));y.length&&w&&!w.isAlreadyExecuted("file:///usr/src/app/client/site/webcomponents/x-bookmarkbutton/scripts/x-bookmarkbutton.js")&&new k(y,w).init()})()})();