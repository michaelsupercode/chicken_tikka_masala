/*! For license information please see x-token.2d52ff84df2ef77fe58ffb6091b9a5b3.js.LICENSE.txt */
(()=>{"use strict";const e="x-token";class t extends HTMLElement{#e={};get token(){return this.#t()}get section(){return this.getAttribute("section")||""}get ttl(){return Number(this.getAttribute("ttl"))||3600}get url(){return this.getAttribute("url")||"/p-api/csrf/"}async#t(){let e=this.#n();if(void 0===e){const t=this.url+this.section,n=await this.#i(t);n?.token&&(e=n.token,this.#s(n.token))}return e}#s(e){this.#e.expires=Date.now()+1e3*this.ttl,this.#e.value=e}#n(){if(this.#e?.value&&this.#e?.expires){if(Date.now()<this.#e.expires)return this.#e.value}}async#i(e,t=1){return fetch(e,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"}).then((n=>{if(!n.ok){if(t>0)return this.#i(e,t-1);throw new Error(`Status: ${n.status}`)}return n.json()})).catch((e=>{console.error(`Error while fetching token: ${e.message}`)}))}}"customElements"in window&&void 0===window.customElements.get(e)&&window.customElements.define(e,t)})();