"use strict";var foundation=foundation||{};foundation.plugin=foundation.plugin||{};foundation.plugin.ssai=(()=>{var bc=Object.create;var Hr=Object.defineProperty;var kc=Object.getOwnPropertyDescriptor;var Ic=Object.getOwnPropertyNames;var Pc=Object.getPrototypeOf,_c=Object.prototype.hasOwnProperty;var Lc=(t=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(t,{get:(i,e)=>(typeof require!="undefined"?require:i)[e]}):t)(function(t){if(typeof require!="undefined")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});var D=(t,i)=>()=>(i||t((i={exports:{}}).exports,i),i.exports),wc=(t,i)=>{for(var e in i)Hr(t,e,{get:i[e],enumerable:!0})},ko=(t,i,e,r)=>{if(i&&typeof i=="object"||typeof i=="function")for(let n of Ic(i))!_c.call(t,n)&&n!==e&&Hr(t,n,{get:()=>i[n],enumerable:!(r=kc(i,n))||r.enumerable});return t};var Re=(t,i,e)=>(e=t!=null?bc(Pc(t)):{},ko(i||!t||!t.__esModule?Hr(e,"default",{value:t,enumerable:!0}):e,t)),Cc=t=>ko(Hr({},"__esModule",{value:!0}),t);var Io=D(qr=>{"use strict";Object.defineProperty(qr,"__esModule",{value:!0});qr.ErrorCodes=void 0;qr.ErrorCodes={FALLBACK_DRM_ERROR:1e4,AUTHENTICATION_FAILED:11e3,TOKEN_PROBLEM:11100,TOKEN_INVALID:11110,TOKEN_MISSING:11120,PERMISSION_PROBLEM:11200,PAY_PERMISSION_MISSING:11210,DOWNLOAD_PERMISSION_MISSING:11220,RIGHTS_RESTRICTIONS_NOT_MET:12e3,GEOBLOCKING:12100,USING_OF_AN_ANONYM_PROXY_OR_VPN:12110,LOCATION_NOT_ALLOWED:12120,HDCP_REQUIREMENT_NOT_FULFILLED:12300,DEVICE_IS_DENYLISTED_BY_GOOGLE_FOR_WIDEVINE:12400,LICENSE:13e3,LICENSE_EXPIRED:13100,LICENSE_NOT_PERSISTABLE:13200,LICENSE_ENVIRONMENT:13300,INVALID_MISSING_FAIRPLAY_CERTIFICATE_URL:13310,INVALID_FAIRPLAY_CERTIFICATE_DATA:13320,CONTENT:2e4,MEDIA_FORMAT_UNSUPPORTED:20100,AVAILABILITY:21e3,CONTENT_NOT_AVAILABLE:21100,SOURCE_MATERIAL_NOT_AVAILABLE:21110,CONTENT_NOT_DOWNLOADABLE:21200,CLIENT:3e4,NO_PLAYABLE_TRACK_LEFT:30100,NETWORK_PROBLEM:31e3,BAD_INTERNET_CONNECTION:31110,PLATFORM:32e3,UNSUPPORTED_DRM:32100,NO_DRM_OPTION_AVAILABLE_ANY_MORE:32110,DRM_NOT_FULLY_IMPLEMENTED:32120,UNSUPPORTED_STREAM_TECH:32200,NO_MANIFESTS_PLAYABLE:32210,MANIFEST_NOT_SUPPORTED:32220,MAX_CONCURRENT_STREAMS_REACHED:33100,PLAYERCONFIG_PROBLEM:34e3,ADBLOCKER_DETECTED:34100,VIDEOSOURCES_CONFIG:34200,NO_MANIFEST_IN_CONFIG:34210,MISSING_PLAYER_ELEMENT_OR_ID:34300,FAULTY_ADVERTISING_ISLAND_CONFIGURED:34510,PLAYER_ALREADY_DESTROYED:35100,FAULTY_SETUP_FOR_NON_LINEAR_ADVERTISING:35210,MISSING_USER_INTERACTION:35310,OPERATION_ABORTED:35400,OPERATION_ABORTED_PLAY:35410,OPERATION_ABORTED_LOAD:35420,OPERATION_ABORTED_POWER_SAVING:35430,OPERATION_ABORTED_VIDEO_REMOVED:35440,DEPENDENCY:4e4,V3_UNAVAILABLE:41100,ENTITLEMENT_UNAVAILABLE:41200,DB_UNAVAILABLE:41300,GOOGLE_WIDEVINE_UNAVAILABLE:41400,MANIFEST_API_UNAVAILABLE:41500,OTHER_UNAVAILABLE:41600,ATV_SCHEDULER_UNAVAILABLE:41700,STUS_UNAVAILABLE:41800,ATV_SCHEDULER_REQUEST_FAILED_HTTP_STATUS_CODE_4XX:42700,ATV_SCHEDULER_REQUEST_FAILED_HTTP_STATUS_CODE_5XX:42710,STUS_RETURNS_4XX_ERROR:42800,ATV_SCHEDULER_REQUEST_TIMED_OUT:43700,INTERNAL_PLAYER_ERROR:5e4,UNEXPECTED_EVENT:51e3,PLAYER_DEPENDENCIES_COULD_NOT_BE_LOADED:52110,PLAYER_DEPENDENCY_MISSING:52120,PLAYER_DEPENDENCY_INVALID:52130,ERROR_NOT_TREATED:59e3}});var je=D(Gr=>{"use strict";Object.defineProperty(Gr,"__esModule",{value:!0});Gr.ErrorCodes=void 0;var Dc=Io();Object.defineProperty(Gr,"ErrorCodes",{enumerable:!0,get:function(){return Dc.ErrorCodes}})});var Zo=D(ti=>{"use strict";ti.__esModule=!0;ti.Logger=void 0;var cu=function(){function t(){}return t.debug=function(e){console.log(e)},t.error=function(e){console.error(e)},t.info=function(e){console.info(e)},t.warn=function(e){console.warn(e)},t}();ti.Logger=cu});var Ne=D(K=>{"use strict";K.__esModule=!0;K.VISIBLE_EVENTS=K.VERIFICATION_EVENTS=K.TIMELINE_EVENTS=K.Payload=K.PLAYER_OPERATION_EVENTS=K.NON_LINEAR_EVENTS=K.LINEAR_EVENTS=K.INTERACTIVE_EVENTS=K.Constant=K.COMPANION_EVENTS=K.CAT_TIMELINE_EVENTS=K.CAT_AD_BREAK_EVENTS=K.AD_BREAK_EVENTS=void 0;K.getLogTag=Tu;var uu="Yospace SDK/3.0",du=["mute","unmute","pause","resume","rewind","playerExpand","playerCollapse","closeLinear","skip"];K.PLAYER_OPERATION_EVENTS=du;var hu=["creativeView"];K.COMPANION_EVENTS=hu;var fu=["interactiveStart"];K.INTERACTIVE_EVENTS=fu;var pu=["loaded","start","firstQuartile","midpoint","thirdQuartile","complete","progress","mute","unmute","pause","resume","rewind","playerExpand","playerCollapse","closeLinear","skip","otherAdInteraction"];K.LINEAR_EVENTS=pu;var gu=["creativeView","mute","unmute","pause","resume","rewind","skip","playerExpand","playerCollapse","adExpand","adCollapse","minimize","overlayViewDuration","acceptInvitation","close","otherAdInteraction"];K.NON_LINEAR_EVENTS=gu;var vu=["creativeView","close","interactiveStart"];K.VISIBLE_EVENTS=vu;var yu=["verificationNotExecuted"];K.VERIFICATION_EVENTS=yu;var mu=["loaded","start","firstQuartile","midpoint","thirdQuartile","complete","progress"];K.TIMELINE_EVENTS=mu;var Eu=["breakStart","breakEnd"];K.AD_BREAK_EVENTS=Eu;var Au=Object.freeze({ADVERT_START_TIMESLOT:5,DEFAULT_POLLING_DELAY:11e3,EVENT_CUEPOINT_TOL:10,EXPECTED_POLL_COMPLETE_TIME:250,INTERSEGMENT_TIMEOUT:2700,REQUEST_TIMEOUT:5e3,MAX_CADENCE:250,MIN_INTRASEGMENT_TIMEOUT:2500,MIN_SEGMENT_LENGTH:2e3,USER_AGENT:uu});K.Constant=Au;function Tu(){return"YoAdManagement: "}var Su=1;K.CAT_AD_BREAK_EVENTS=Su;var bu=2;K.CAT_TIMELINE_EVENTS=bu;var ku=Object.freeze({IDENTIFIER:"SESSIONIDENTIFIER",LOCATION:"LOCATION",HOSTNODE:"HOST",PORT:"PORT",ANALYTICURL:"ANALYTICURL",PAUSEURL:"PAUSEURL",SCHEME:"SCHEME",QS:"QUERYSTRING",AVAILABILITYSTART:"AVAILABILITYSTARTTIME"});K.Payload=ku});var J=D(re=>{"use strict";re.__esModule=!0;re.YoLog=re.DebugFlags=re.DEBUG_VALIDATION=re.DEBUG_STATE_MACHINE=re.DEBUG_REPORTS=re.DEBUG_POLLING=re.DEBUG_PLAYBACK=re.DEBUG_PARSING=re.DEBUG_LIFECYCLE=re.DEBUG_HTTP_REQUESTS=re.DEBUG_ALL=void 0;var Iu=Zo(),ri=Ne(),We=Object.freeze({DEBUG_PLAYBACK:1,DEBUG_LIFECYCLE:2,DEBUG_POLLING:4,DEBUG_REPORTS:8,DEBUG_STATE_MACHINE:16,DEBUG_HTTP_REQUESTS:32,DEBUG_PARSING:64,DEBUG_VALIDATION:128,DEBUG_ALL:Number.MAX_SAFE_INTEGER});re.DebugFlags=We;var Pu=We.DEBUG_PLAYBACK;re.DEBUG_PLAYBACK=Pu;var _u=We.DEBUG_LIFECYCLE;re.DEBUG_LIFECYCLE=_u;var Lu=We.DEBUG_POLLING;re.DEBUG_POLLING=Lu;var wu=We.DEBUG_REPORTS;re.DEBUG_REPORTS=wu;var Cu=We.DEBUG_STATE_MACHINE;re.DEBUG_STATE_MACHINE=Cu;var Du=We.DEBUG_HTTP_REQUESTS;re.DEBUG_HTTP_REQUESTS=Du;var Ru=We.DEBUG_PARSING;re.DEBUG_PARSING=Ru;var Nu=We.DEBUG_VALIDATION;re.DEBUG_VALIDATION=Nu;var Ou=We.DEBUG_ALL;re.DEBUG_ALL=Ou;var Un=function(){function t(){}return t.setLogger=function(e){t.logger=e},t.setDebugFlags=function(e){t.debugflags=e},t.getDebugFlags=function(){return t.debugflags},t.d=function(e,r){t.debugflags&e&&t.logger.debug((0,ri.getLogTag)()+r)},t.e=function(e){t.logger.error((0,ri.getLogTag)()+e)},t.i=function(e,r){t.debugflags&e&&t.logger.info((0,ri.getLogTag)()+r)},t.w=function(e){t.logger.warn((0,ri.getLogTag)()+e)},t.trace=function(e){t.d(We.DEBUG_VALIDATION,"["+Date.now()+"][YoSDK:"+e+"]")},t}();re.YoLog=Un;Un.debugflags=0;Un.logger=Iu.Logger});var ut=D(ii=>{"use strict";ii.__esModule=!0;ii.XmlValidation=void 0;var Mu=function(){function t(){if((this instanceof t?this.constructor:void 0)===t)throw new TypeError("Cannot construct abstract class XmlValidation directly")}var i=t.prototype;return i.isValid=function(){return!0},t}();ii.XmlValidation=Mu});var Vn=D(ni=>{"use strict";ni.__esModule=!0;ni.AdBreakEventHandler=void 0;var Bu=ut();function Uu(t,i){t.prototype=Object.create(i.prototype),t.prototype.constructor=t,Fn(t,i)}function Fn(t,i){return Fn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},Fn(t,i)}var Fu=function(t){Uu(i,t);function i(){return t.apply(this,arguments)||this}var e=i.prototype;return e.onNonLinearTrackingEvent=function(n){throw new Error("Function must be overridden")},i}(Bu.XmlValidation);ni.AdBreakEventHandler=Fu});var X=D(gt=>{"use strict";gt.__esModule=!0;gt.equalsIgnoreCase=Vu;gt.formatHtml=xu;gt.isNullOrEmpty=qu;gt.isString=xn;gt.toIndentedString=Yu;gt.toUnindentedString=Hu;function Vu(t,i){return t===null?i===null:t===void 0?i===void 0:xn(t)&&xn(i)?t.toUpperCase()===i.toUpperCase():!1}function xn(t){return typeof t=="string"||t instanceof String}function xu(t){if(!t)return"";try{for(var i=0,e="",r=null,n=0,a=0;a<t.length;++a){if(r=t[a],r==="<"){var o=t[a+1];o==="/"&&i--,e=Gu(e,n,i),o!=="/"&&o!=="!"&&i++}e+=r,n=r}if(i===0)return e}catch(s){}return t}function Yu(t){return t?"    "+t.toString().replace(`
`,`
    `):"null"}function Hu(t){return t?""+t.toString().replace(`
    `,`
`):"null"}function qu(t){return!t||t===""}function Gu(t,i,e){var r=t;if(i===0||i===">"){r+=`
`;for(var n=0;n<e*4;++n)r+=" "}return r}});var Lt=D(_t=>{"use strict";_t.__esModule=!0;_t.millisToTimeString=zu;_t.millisToTimestamp=Ku;_t.pdtToMillis=ju;_t.stringToIntegerNumber=Xu;_t.timeStringToMillis=Wu;function ju(t,i){if(!t||t.length===0||t.indexOf("T")===-1)return i;var e=t.substring(t.indexOf("T"),t.length-1);e.indexOf("+")===-1&&e.indexOf("-")===-1&&Number.isInteger(Number.parseInt(t.charAt(t.length-1)))&&(t=t+"Z");var r=Date.parse(t);return Number.isNaN(r)?i:r}function Wu(t,i){var e=i!==void 0?i:-1;if(!(typeof t=="string"&&t.length>0))return e;var r=t.split(":");if(r.length!==3)return e;var n=parseInt(r[0]),a=parseInt(r[1]);if(Number.isNaN(n)||Number.isNaN(a))return e;var o=0,s=0,c=r[2].split(".");return c.length!==2?o=parseInt(r[2]):(o=parseInt(c[0]),s=parseInt(c[1])),Number.isNaN(o)||Number.isNaN(s)||n>23||a>59||o>59?e:n*36e5+a*6e4+o*1e3+s}function Ku(t){return new Date(t).toISOString()}function zu(t){var i=Math.floor(t/1e3%60),e=Math.floor(t/(1e3*60)%60),r=Math.floor(t/(1e3*60*60)%24);return t=Math.round(t%1e3),""+(r<10?0:"")+r+":"+(e<10?0:"")+e+":"+(i<10?0:"")+i+"."+(t<10?"00":t<100?"0":"")+t}function Xu(t,i){var e=Number.parseInt(t);return Number.isInteger(e)?e:i}});var Ze=D(ai=>{"use strict";ai.__esModule=!0;ai.TrackingReport=void 0;var Ke=Ne(),$u=J();function Qu(t,i){var e=typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e)return(e=e.call(t)).next.bind(e);if(Array.isArray(t)||(e=Ju(t))||i&&t&&typeof t.length=="number"){e&&(t=e);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ju(t,i){if(t){if(typeof t=="string")return es(t,i);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return es(t,i)}}function es(t,i){(i==null||i>t.length)&&(i=t.length);for(var e=0,r=new Array(i);e<i;e++)r[e]=t[e];return r}var Zu=function(){t.categoryForEvent=function(r){return t.isValidAdBreakEvent(r)?Ke.CAT_AD_BREAK_EVENTS:t.isTimelineEvent(r)?Ke.CAT_TIMELINE_EVENTS:0},t.isValidPlayerOperationEvent=function(r){return Ke.PLAYER_OPERATION_EVENTS.indexOf(r)!==-1},t.isValidCompanionEvent=function(r){return Ke.COMPANION_EVENTS.indexOf(r)!==-1},t.isValidInteractiveEvent=function(r){return Ke.INTERACTIVE_EVENTS.indexOf(r)!==-1},t.isValidLinearEvent=function(r){return Ke.LINEAR_EVENTS.indexOf(r)!==-1},t.isValidNonLinearEvent=function(r){return Ke.NON_LINEAR_EVENTS.indexOf(r)!==-1},t.isValidVerificationEvent=function(r){return Ke.VERIFICATION_EVENTS.indexOf(r)!==-1},t.isTimelineEvent=function(r){return Ke.TIMELINE_EVENTS.indexOf(r)!==-1},t.isValidAdBreakEvent=function(r){return Ke.AD_BREAK_EVENTS.indexOf(r)!==-1},t.isValidVisibleEvent=function(r){return Ke.VISIBLE_EVENTS.indexOf(r)!==-1};function t(e,r){this.trackingEvent=e,this.trackingUrls=JSON.parse(JSON.stringify(r||[]))}var i=t.prototype;return i.addTrackingUrl=function(r){r?this.trackingUrls.push(r):$u.YoLog.e("addTrackingUrl: url was null")},i.getEventType=function(){return this.trackingEvent},i.getTrackingUrls=function(){return Object.assign([],this.trackingUrls)},i.removeTrackingUrls=function(){this.trackingUrls=[]},i.toString=function(){var r="";r+="Event:",r+=this.trackingEvent;for(var n=Qu(this.trackingUrls),a;!(a=n()).done;){var o=a.value;r+=`
 - Url:`,r+=o}return r},t}();ai.TrackingReport=Zu});var si=D(oi=>{"use strict";oi.__esModule=!0;oi.isValidCallbackImplementation=id;oi.raiseCallback=rd;var Tr=J();function ed(t,i){var e=typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e)return(e=e.call(t)).next.bind(e);if(Array.isArray(t)||(e=td(t))||i&&t&&typeof t.length=="number"){e&&(t=e);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function td(t,i){if(t){if(typeof t=="string")return ts(t,i);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return ts(t,i)}}function ts(t,i){(i==null||i>t.length)&&(i=t.length);for(var e=0,r=new Array(i);e<i;e++)r[e]=t[e];return r}function rd(t,i){t&&(i=i.bind(t));var e=null;try{for(var r=arguments.length,n=new Array(r>2?r-2:0),a=2;a<r;a++)n[a-2]=arguments[a];e=i.apply(void 0,n)}catch(d){var o=i.toString(),s=/function ([^\(]*)/,c=s.exec(o);c&&c.length>0?Tr.YoLog.e("Exception thrown from callback function "+c[1]+": "+d):Tr.YoLog.e("Exception thrown from callback function.")}return e}function id(t,i){if(!t)return Tr.YoLog.e(i.name+" has not been implemented"),!1;for(var e=!0,r=new i,n=Object.getOwnPropertyNames(i.prototype),a=ed(n),o;!(o=a()).done;){var s=o.value;if(s!=="constructor"){var c=t[s];c?c.toString()===r[s].toString()&&(Tr.YoLog.e(i.name+" does not provide an override for "+s),e=!1):(Tr.YoLog.e(i.name+" does not implement "+s),e=!1)}}return e}});var Yn=D(li=>{"use strict";li.__esModule=!0;li.SessionError=void 0;var nd=function(){function t(e){this.utcTimestamp=e}var i=t.prototype;return i.toJsonString=function(){return JSON.stringify(this)},i.getUtcTimestamp=function(){return this.utcTimestamp},t}();li.SessionError=nd});var qn=D(ci=>{"use strict";ci.__esModule=!0;ci.TrackingError=void 0;var ad=Lt(),od=Yn();function sd(t,i){t.prototype=Object.create(i.prototype),t.prototype.constructor=t,Hn(t,i)}function Hn(t,i){return Hn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},Hn(t,i)}var ld=function(t){sd(i,t);function i(r,n,a){var o;return o=t.call(this,(0,ad.millisToTimestamp)(Date.now()))||this,o.url=r,o.errorCode=n,o.event=a,o}var e=i.prototype;return e.getUrl=function(){return this.url},e.getErrorCode=function(){return this.errorCode},e.getEvent=function(){return this.event},i}(od.SessionError);ci.TrackingError=ld});var ui=D(xt=>{"use strict";xt.__esModule=!0;xt.ReportsManager=xt.ReportingParams=void 0;var Gn=Lt(),rs=Ze(),wt=J(),cd=et(),ud=X(),dd=Ct(),vt=si(),hd=qn();function Ue(t,i){var e=typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e)return(e=e.call(t)).next.bind(e);if(Array.isArray(t)||(e=fd(t))||i&&t&&typeof t.length=="number"){e&&(t=e);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fd(t,i){if(t){if(typeof t=="string")return is(t,i);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return is(t,i)}}function is(t,i){(i==null||i>t.length)&&(i=t.length);for(var e=0,r=new Array(i);e<i;e++)r[e]=t[e];return r}var pd=function(){function t(e,r){this.properties=e,this.suppress=!1,this.observers=[],this.addTrackingError=r}var i=t.prototype;return i.addAnalyticObserver=function(r){r?this.observers.push(r):wt.YoLog.e("addAnalyticObserver: listener was null")},i.applyEncryptedTracking=function(r){return this.properties.getApplyEncryptedTracking()&&(r=r.replace("http:","https:")),r},i.fire=function(r,n){var a=this,o={method:"GET"};this.properties.getAllowCorsForAnalytics()?(0,ud.isNullOrEmpty)(this.properties.getUserAgent())||(o.headers=(0,cd.createHeaders)(this.properties.getUserAgent())):o.mode="no-cors";for(var s=function(){var f=d.value;a.performMacroSubstitutionForUrl(f,n),a.applyEncryptedTracking(f),wt.YoLog.d(wt.DebugFlags.DEBUG_REPORTS,"Firing report url: "+f),dd.HttpConnection.get(f,o,a.properties.getResourceTimeout()).then(function(w){!w.ok&&w.status!==0&&a.addTrackingError(new hd.TrackingError(f,w.status,r.trackingEvent))})},c=Ue(r.getTrackingUrls()),d;!(d=c()).done;)s()},i.fireBeacon=function(r,n){if(r&&r.getTrackingUrls().length>0&&!this.shouldSuppress(r.event))try{this.fire(r,n)}catch(a){throw wt.YoLog.e("Unable to fire tracking URLs for report: "+a),a}},i.fireBeacons=function(r,n){for(var a=[],o=Ue(r),s;!(s=o()).done;)for(var c=s.value,d=Ue(c.getTrackingUrls()),p;!(p=d()).done;){var f=p.value;a.push(f)}this.fireBeacon(new rs.TrackingReport("",a),n)},i.performMacroSubstitutionForUrl=function(r,n){var a="",o=(0,Gn.millisToTimestamp)(Date.now()),s=(0,Gn.millisToTimeString)(n.getPlayhead()),c=n.getAdvertStart()===-1?"-1":(0,Gn.millisToTimeString)(n.getAdvertStart());a=encodeURIComponent(n.getAssetUri()),o=encodeURIComponent(o),s=encodeURIComponent(s),c=encodeURIComponent(c);var d=1e7+Math.round(Math.random()*1e8);r=r.replace("[ASSETURI]",a).replace("%5BASSETURI%5D",a).replace("[CACHEBUSTING]",d).replace("%5BCACHEBUSTING%5D",d).replace("[TIMESTAMP]",o).replace("%5BTIMESTAMP%5D",o).replace("[CONTENTPLAYHEAD]",s).replace("%5BCONTENTPLAYHEAD%5D",s).replace("[MEDIAPLAYHEAD]",s).replace("%5BMEDIAPLAYHEAD%5D",s).replace("[ADPLAYHEAD]",c).replace("%5BADPLAYHEAD%5D",c);for(var p=Ue(n.getMacroSubstitutions()),f;!(f=p()).done;){var w=f.value,B=w[0],_=w[1];r=r.replace("["+B+"]",_).replace("%5B"+B+"%5D",_)}return r=r.replace(/\[(.*?)]/g,"-1"),r=r.replace(/%5B(.*)%5D/g,"-1"),r},i.raiseAdBreakEarlyReturn=function(r,n){wt.YoLog.trace("earlyreturn");for(var a=Ue(this.observers),o;!(o=a()).done;){var s=o.value;(0,vt.raiseCallback)(s,s.onAdvertBreakEarlyReturn,r,n)}},i.raiseAdBreakCallback=function(r,n,a){if(r==="start")for(var o=Ue(this.observers),s;!(s=o()).done;){var c=s.value;(0,vt.raiseCallback)(c,c.onAdvertBreakStart,n,a)}else if(r==="end")for(var d=Ue(this.observers),p;!(p=d()).done;){var f=p.value;(0,vt.raiseCallback)(f,f.onAdvertBreakEnd,a)}},i.raiseAdvertCallback=function(r,n,a){if(r==="start")for(var o=Ue(this.observers),s;!(s=o()).done;){var c=s.value;(0,vt.raiseCallback)(c,c.onAdvertStart,n,a)}else if(r==="end")for(var d=Ue(this.observers),p;!(p=d()).done;){var f=p.value;(0,vt.raiseCallback)(f,f.onAdvertEnd,a)}},i.raiseAnalyticUpdateCallback=function(r){if(!this.suppress)for(var n=Ue(this.observers),a;!(a=n()).done;){var o=a.value;(0,vt.raiseCallback)(o,o.onAnalyticUpdate,r)}},i.raiseSessionErrorCallback=function(r,n){for(var a=Ue(this.observers),o;!(o=a()).done;){var s=o.value;(0,vt.raiseCallback)(s,s.onSessionError,r,n)}},i.raiseTrackingCallback=function(r,n){if(!this.shouldSuppress(r))for(var a=Ue(this.observers),o;!(o=a()).done;){var s=o.value;(0,vt.raiseCallback)(s,s.onTrackingEvent,r,n)}},i.removeAnalyticObserver=function(r){this.observers.splice(this.observers.indexOf(r))},i.reportsSuppressed=function(){return this.suppress},i.shouldSuppress=function(r){var n=rs.TrackingReport.categoryForEvent(r);return(this.properties.getExcludedCategories()&n)===0&&this.suppress},i.suppressReports=function(r){this.suppress!==r&&(this.suppress=r,wt.YoLog.d(wt.DebugFlags.DEBUG_REPORTS,r?"Suppress reports":"Unsuppress reports"))},t}();xt.ReportsManager=pd;var gd=function(){function t(e,r,n,a){this.playhead=e,this.advertStart=r&&r>=0?e-r:-1,this.assetUri=n||"",this.macroSubstitutions=a||new Map}var i=t.prototype;return i.getAdvertStart=function(){return this.advertStart},i.getAssetUri=function(){return this.assetUri},i.getMacroSubstitutions=function(){return this.macroSubstitutions},i.getPlayhead=function(){return this.playhead},t}();xt.ReportingParams=gd});var Wn=D(di=>{"use strict";di.__esModule=!0;di.PlaybackPolicy=void 0;var vd=ut();function yd(t,i){t.prototype=Object.create(i.prototype),t.prototype.constructor=t,jn(t,i)}function jn(t,i){return jn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},jn(t,i)}var md=function(t){yd(i,t);function i(){return t.apply(this,arguments)||this}var e=i.prototype;return e.canStop=function(){throw new Error("Function must be overridden")},e.canPause=function(){throw new Error("Function must be overridden")},e.canSkip=function(){throw new Error("Function must be overridden")},e.willSeekTo=function(n){throw new Error("Function must be overridden")},e.canChangeVolume=function(n){throw new Error("Function must be overridden")},e.canResize=function(n){throw new Error("Function must be overridden")},e.canResizeCreative=function(n){throw new Error("Function must be overridden")},e.canClickThrough=function(n){throw new Error("Function must be overridden")},i}(vd.XmlValidation);di.PlaybackPolicy=md});var hi=D(Yt=>{"use strict";Yt.__esModule=!0;Yt.TypeWithinSegment=Yt.TimedMetadata=void 0;var Sr=J(),Ed=function(){function t(e,r,n,a,o,s){this.mediaId=t.decodeString(e),this.offset=o,this.segmentCount=n,this.segmentNumber=r,this.playhead=s,this.timestamp=Date.now(),this.typeWithinSegment=a}t.createFromMetadata=function(r,n,a,o,s){if(!r)return Sr.YoLog.e("Failed to interpret ymid"),null;a=t.decodeString(a);var c=Fe.getForKey(a);if(c==null)return Sr.YoLog.e("Failed to interpret ytyp"),null;var d=t.decodeString(n).split(":");if(d.length!==2)return Sr.YoLog.e("Failed to interpret yseq"),null;var p=parseInt(d[0]),f=parseInt(d[1]);if(isNaN(p)||p===0||isNaN(f)||f===0)return Sr.YoLog.e("Failed to interpret yseq"),null;var w=parseFloat(this.decodeString(o)),B=Number.isNaN(w)?0:Math.round(w*1e3);return s<0?(Sr.YoLog.w("Invalid playhead provided:"+s),null):new t(r,p,f,c,B,s)},t.decodeString=function(r){return r&&r.length>0&&r[0]===3?r.substring(1):r};var i=t.prototype;return i.getMediaId=function(){return this.mediaId},i.getOffset=function(){return this.offset},i.getPlayhead=function(){return this.playhead},i.getSegmentCount=function(){return this.segmentCount},i.getSegmentNumber=function(){return this.segmentNumber},i.getTimestamp=function(){return this.timestamp},i.getTypeWithinSegment=function(){return this.typeWithinSegment},i.isDuplicate=function(r){return r?this.mediaId===r.mediaId&&this.segmentNumber===r.segmentNumber&&this.segmentCount===r.segmentCount&&this.typeWithinSegment===r.typeWithinSegment&&this.offset===r.offset:!1},i.isFirstInSequence=function(){return this.isFirstInSegment()&&this.segmentNumber===1},i.isFirstInSegment=function(){return this.typeWithinSegment===Fe.START},i.isInSequence=function(r){if(!r)return!0;if(this.mediaId!==r.mediaId)return this.isFirstInSequence();var n=this.segmentNumber-r.segmentNumber;return n===0?this.typeWithinSegment.isInSequence(r.typeWithinSegment)||this.typeWithinSegment.isEqualMidType(r.typeWithinSegment)&&this.offset>r.offset:n>0},i.isLastInSegment=function(){return this.typeWithinSegment===Fe.END},i.isLastInSequence=function(){return this.isLastInSegment()&&this.isLastSegment()},i.isLastSegment=function(){return this.segmentNumber===this.segmentCount},i.toString=function(){return"Metadata [ @"+this.playhead+" / "+this.mediaId+" / "+this.segmentNumber+":"+this.segmentCount+" / "+this.typeWithinSegment.key+" : "+this.offset+" ]"},t}();Yt.TimedMetadata=Ed;var Fe=function(){function t(e,r){this.key=e,this.order=r}t.getForKey=function(r){if(!t.initialised){var n=t.END,a=t.MID,o=t.START;t.KEY_MAP.set(n.key,n),t.KEY_MAP.set(a.key,a),t.KEY_MAP.set(o.key,o),t.initialised=!0}return t.KEY_MAP.get(r)};var i=t.prototype;return i.isEqualMidType=function(r){return r?this.order===1&&r.order===1:!1},i.isInSequence=function(r){return r?this.order>r.order:!0},t}();Yt.TypeWithinSegment=Fe;Fe.END=new Fe("E",2);Fe.MID=new Fe("M",1);Fe.START=new Fe("S",0);Fe.KEY_MAP=new Map;Fe.initialised=!1});var Ht=D(yt=>{"use strict";yt.__esModule=!0;yt.ViewSize=yt.PlayerEvent=yt.PlaybackEventHandler=void 0;var Ad=Wn(),tE=hi();function Td(t,i){t.prototype=Object.create(i.prototype),t.prototype.constructor=t,Kn(t,i)}function Kn(t,i){return Kn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},Kn(t,i)}var Sd=Object.freeze({START:0,STOP:1,PAUSE:2,RESUME:3,STALL:4,CONTINUE:5,ADVERT_REWIND:6,ADVERT_SKIP:7,SEEK:8,PLAYBACK_READY:9});yt.PlayerEvent=Sd;var bd=Object.freeze({COLLAPSED:0,EXPANDED:1});yt.ViewSize=bd;var kd=function(t){Td(i,t);function i(){return t.apply(this,arguments)||this}var e=i.prototype;return e.onPlayerEvent=function(n,a){throw new Error("Function must be overridden")},e.onPlayheadUpdate=function(n){throw new Error("Function must be overridden")},e.onTimedMetadata=function(n){throw new Error("Function must be overridden")},e.onViewSizeChange=function(n){throw new Error("Function must be overridden")},e.onVolumeChange=function(n){throw new Error("Function must be overridden")},i}(Ad.PlaybackPolicy);yt.PlaybackEventHandler=kd});var ns=D(fi=>{"use strict";fi.__esModule=!0;fi.AnalyticBroker=void 0;var Id=Ht();function Pd(t,i){t.prototype=Object.create(i.prototype),t.prototype.constructor=t,zn(t,i)}function zn(t,i){return zn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},zn(t,i)}var _d=function(t){Pd(i,t);function i(){return t.apply(this,arguments)||this}var e=i.prototype;return e.addParsingError=function(n){throw new Error("Function must be overridden")},e.clearParsingErrors=function(){throw new Error("Function must be overridden")},e.fireTrackingReport=function(n){throw new Error("Function must be overridden")},e.fireTrackingReportForCreative=function(n,a){throw new Error("Function must be overridden")},e.fireTrackingReportForIcon=function(n,a){throw new Error("Function must be overridden")},e.raiseTrackingCallbackForCreative=function(n,a){throw new Error("Function must be overridden")},e.getSessionProperties=function(){throw new Error("Function must be overridden")},e.normaliseAdBreakStart=function(n,a){throw new Error("Function must be overridden")},i}(Id.PlaybackEventHandler);fi.AnalyticBroker=_d});var gi=D(pi=>{"use strict";pi.__esModule=!0;pi.PlaybackPolicyHandler=void 0;var nE=Ve(),Ld=function(){function t(){}var i=t.prototype;return i.canStop=function(r,n){throw new Error("Must be overridden")},i.canPause=function(r,n){throw new Error("Must be overridden")},i.canSkip=function(r,n,a){throw new Error("Must be overridden")},i.willSeekTo=function(r,n,a){throw new Error("Must be overridden")},i.canChangeVolume=function(r,n,a){throw new Error("Must be overridden")},i.canResize=function(r,n,a){throw new Error("Must be overridden")},i.canResizeCreative=function(r,n,a){throw new Error("Must be overridden")},i.canClickThrough=function(r,n,a){throw new Error("Must be overridden")},i.setPlaybackMode=function(r){throw new Error("Must be overridden")},i.didSkip=function(r,n,a){throw new Error("Must be overridden")},i.didSeek=function(r,n,a){throw new Error("Must be overridden")},t}();pi.PlaybackPolicyHandler=Ld});var br=D(vi=>{"use strict";vi.__esModule=!0;vi.DefaultPlaybackPolicyHandler=void 0;var wd=gi(),ie=Ve();function Cd(t,i){t.prototype=Object.create(i.prototype),t.prototype.constructor=t,Xn(t,i)}function Xn(t,i){return Xn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},Xn(t,i)}var Dd=function(t){Cd(i,t);function i(r){var n;return n=t.call(this)||this,n.playbackMode=r,n}var e=i.prototype;return e.canStop=function(n,a){switch(this.playbackMode){case ie.PlaybackMode.LIVE:case ie.PlaybackMode.DVRLIVE:case ie.PlaybackMode.VOD:default:return!0}},e.canPause=function(n,a){switch(this.playbackMode){case ie.PlaybackMode.LIVE:return!1;case ie.PlaybackMode.DVRLIVE:case ie.PlaybackMode.VOD:default:return!0}},e.canSkip=function(n,a,o){switch(this.playbackMode){case ie.PlaybackMode.LIVE:return-1;case ie.PlaybackMode.DVRLIVE:return 0;case ie.PlaybackMode.VOD:return 0;default:return 0}},e.willSeekTo=function(n,a,o){switch(this.playbackMode){case ie.PlaybackMode.LIVE:return o;case ie.PlaybackMode.DVRLIVE:return n;case ie.PlaybackMode.VOD:default:return n}},e.canChangeVolume=function(n,a,o){switch(this.playbackMode){case ie.PlaybackMode.LIVE:case ie.PlaybackMode.DVRLIVE:case ie.PlaybackMode.VOD:default:return!0}},e.canResize=function(n,a,o){switch(this.playbackMode){case ie.PlaybackMode.LIVE:case ie.PlaybackMode.DVRLIVE:case ie.PlaybackMode.VOD:default:return!0}},e.canResizeCreative=function(n,a,o){switch(this.playbackMode){case ie.PlaybackMode.LIVE:case ie.PlaybackMode.DVRLIVE:case ie.PlaybackMode.VOD:default:return!0}},e.canClickThrough=function(n,a,o){switch(this.playbackMode){case ie.PlaybackMode.LIVE:case ie.PlaybackMode.DVRLIVE:case ie.PlaybackMode.VOD:default:return!0}},e.setPlaybackMode=function(n){this.playbackMode=n},e.didSkip=function(n,a,o){},e.didSeek=function(n,a,o){},i}(wd.PlaybackPolicyHandler);vi.DefaultPlaybackPolicyHandler=Dd});var $n=D(qt=>{"use strict";qt.__esModule=!0;qt.copyMap=Md;qt.getKeyFromValue=Fd;qt.mapToString=Ud;qt.objectToMap=Bd;var Rd=J();function Nd(t,i){var e=typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e)return(e=e.call(t)).next.bind(e);if(Array.isArray(t)||(e=Od(t))||i&&t&&typeof t.length=="number"){e&&(t=e);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Od(t,i){if(t){if(typeof t=="string")return as(t,i);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return as(t,i)}}function as(t,i){(i==null||i>t.length)&&(i=t.length);for(var e=0,r=new Array(i);e<i;e++)r[e]=t[e];return r}function Md(t){for(var i=new Map,e=Nd(t),r;!(r=e()).done;){var n=r.value,a=n[0],o=n[1];i.set(a,o)}return i}function Bd(t){var i=new Map;if(t)for(var e in t)i.set(e,t[e]);return i}function Ud(t){return t?"{"+Array.from(t,function(i){var e=i[0],r=i[1];return e+": "+r}).join(", ")+"}":"{}"}function Fd(t,i){if(!i)return Rd.YoLog.e("getKeyFromValue: obj is null"),null;for(var e=0,r=Object.entries(i);e<r.length;e++){var n=r[e],a=n[0],o=n[1];if(t===o)return a}return null}});var Qn=D(yi=>{"use strict";yi.__esModule=!0;yi.AnalyticEventObserver=void 0;var lE=Gt(),cE=kr(),uE=Ve(),Vd=function(){function t(){}var i=t.prototype;return i.onAdvertBreakStart=function(r,n){throw new Error("Function must be overridden")},i.onAdvertBreakEnd=function(r){throw new Error("Function must be overridden")},i.onAdvertBreakEarlyReturn=function(r,n){throw new Error("Function must be overridden")},i.onAdvertEnd=function(r){throw new Error("Function must be overridden")},i.onAdvertStart=function(r,n){throw new Error("Function must be overridden")},i.onAnalyticUpdate=function(r){throw new Error("Function must be overridden")},i.onTrackingEvent=function(r,n){throw new Error("Function must be overridden")},i.onSessionError=function(r,n){throw new Error("Function must be overridden")},t}();yi.AnalyticEventObserver=Vd});var Ir=D(mi=>{"use strict";mi.__esModule=!0;mi.CreativeEventHandler=void 0;var xd=ut();function Yd(t,i){t.prototype=Object.create(i.prototype),t.prototype.constructor=t,Jn(t,i)}function Jn(t,i){return Jn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},Jn(t,i)}var Hd=function(t){Yd(i,t);function i(){return t.apply(this,arguments)||this}var e=i.prototype;return e.onClickThrough=function(){throw new Error("Function must be overridden")},e.onTrackingEvent=function(n){throw new Error("Function must be overridden")},e.setVisible=function(n){throw new Error("Function must be overridden")},i}(xd.XmlValidation);mi.CreativeEventHandler=Hd});var _r=D(Ei=>{"use strict";Ei.__esModule=!0;Ei.XmlNode=void 0;var Pr=X();function os(t,i){var e=typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e)return(e=e.call(t)).next.bind(e);if(Array.isArray(t)||(e=qd(t))||i&&t&&typeof t.length=="number"){e&&(t=e);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qd(t,i){if(t){if(typeof t=="string")return ss(t,i);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return ss(t,i)}}function ss(t,i){(i==null||i>t.length)&&(i=t.length);for(var e=0,r=new Array(i);e<i;e++)r[e]=t[e];return r}var Gd=function(){function t(e,r){this.name=e,this.attributes=r||new Map,this.text="",this.children=[]}t.attributeToString=function(r,n){return" "+r+'="'+n+'"'};var i=t.prototype;return i.getAttributes=function(){return this.attributes},i.getAttribute=function(r){return this.attributes.get(r)},i.getChildren=function(){return this.children},i.getInnerText=function(){return this.text},i.getName=function(){return this.name},i.addChild=function(r){this.children.push(r)},i.setInnerText=function(r){this.text=r},i.toString=function(){var r="<";r+=this.name;for(var n=os(this.attributes),a;!(a=n()).done;){var o=a.value,s=o[0],c=o[1];r+=t.attributeToString(s,c)}if(this.children.length===0&&(0,Pr.isNullOrEmpty)(this.text))r+="/>";else{r+=">",(0,Pr.isNullOrEmpty)(this.text)||(r+=this.text);for(var d=os(this.children),p;!(p=d()).done;){var f=p.value;r+=(0,Pr.toIndentedString)(`
`+f)}!(0,Pr.isNullOrEmpty)(this.text)&&this.children.length===0?(r+="</",r+=this.name,r+=">"):r+=(0,Pr.toUnindentedString)(`
</`+this.name+">")}return r},t}();Ei.XmlNode=Gd});var Lr=D(Ai=>{"use strict";Ai.__esModule=!0;Ai.Creative=void 0;var Zn=X(),jd=Ir(),pE=_r();function ls(t,i){var e=typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e)return(e=e.call(t)).next.bind(e);if(Array.isArray(t)||(e=Wd(t))||i&&t&&typeof t.length=="number"){e&&(t=e);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wd(t,i){if(t){if(typeof t=="string")return cs(t,i);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return cs(t,i)}}function cs(t,i){(i==null||i>t.length)&&(i=t.length);for(var e=0,r=new Array(i);e<i;e++)r[e]=t[e];return r}function Kd(t,i){t.prototype=Object.create(i.prototype),t.prototype.constructor=t,ea(t,i)}function ea(t,i){return ea=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},ea(t,i)}var zd=function(t){Kd(i,t);function i(r){var n;return n=t.call(this)||this,n.advertId=r.advertId?r.advertId:"",n.creativeId=r.id?r.id:"",n.universalAdIds=r.universalAdIds,n.sequence=r.sequence,n.adParameters=r.adParameters,n.extensions=null,n.nonLinear=!1,n}var e=i.prototype;return e.postParse=function(n){if(this.extensions=n,this.companionExtensions)for(var a=ls(this.companionExtensions.getChildren()),o;!(o=a()).done;){var s=o.value;this.extensions.addChild(s)}},e.getAdvertIdentifier=function(){return this.advertId},e.getAdParameters=function(){return this.adParameters},e.getExtensions=function(){return this.extensions},e.getCreativeIdentifier=function(){return this.creativeId},e.getSequence=function(){return this.sequence},e.getUniversalAdIds=function(){return this.universalAdIds},e.isNonLinear=function(){return this.nonLinear},e.setNonLinear=function(n){this.nonLinear=n},e.setVisible=function(n){},e.toString=function(){var n="";if(n+=`
 - Id:`+this.creativeId+" AdId:"+this.advertId+" Sequence:"+this.sequence,this.adParameters&&(n+=`
 - AdParameters:`,n+=`
`+(0,Zn.toIndentedString)(this.adParameters)),this.universalAdIds){n+=`
 - UniversalAdIds:`;for(var a=ls(this.universalAdIds),o;!(o=a()).done;){var s=o.value;n+=`
`+(0,Zn.toIndentedString)(s)}}return this.extensions&&(n+=`
 - CreativeExtensions:`,n+=`
`+(0,Zn.toIndentedString)(this.extensions)),n},i}(jd.CreativeEventHandler);Ai.Creative=zd});var jt=D(Ti=>{"use strict";Ti.__esModule=!0;Ti.VideoClicks=void 0;var Xd=X();function us(t,i){var e=typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e)return(e=e.call(t)).next.bind(e);if(Array.isArray(t)||(e=$d(t))||i&&t&&typeof t.length=="number"){e&&(t=e);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $d(t,i){if(t){if(typeof t=="string")return ds(t,i);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return ds(t,i)}}function ds(t,i){(i==null||i>t.length)&&(i=t.length);for(var e=0,r=new Array(i);e<i;e++)r[e]=t[e];return r}var Qd=function(){function t(e,r,n){this.clickThroughUrl=e||"",this.clickTrackingUrls=r||[],this.customClicks=n||[]}var i=t.prototype;return i.getClickThroughUrl=function(){return this.clickThroughUrl},i.getClickTrackingUrls=function(){return this.clickTrackingUrls},i.getCustomClicks=function(){return this.customClicks},i.toString=function(){var r="";if((0,Xd.isNullOrEmpty)(this.clickThroughUrl)||(r+=`
* Click-through Url: `,r+=this.clickThroughUrl),this.clickTrackingUrls.length>0)for(var n=us(this.clickTrackingUrls),a;!(a=n()).done;){var o=a.value;r+=`
* Click tracking Url: `,r+=o}if(this.customClicks.length>0)for(var s=us(this.customClicks),c;!(c=s()).done;){var d=c.value;r+=`
* Custom click Url: `,r+=d}return r},t}();Ti.VideoClicks=Qd});var Wt=D(wr=>{"use strict";wr.__esModule=!0;wr.getClickTrackingReport=eh;wr.isValidSize=th;wr.prefetch=rh;var hs=X(),Jd=Ze();function ps(t,i){var e=typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e)return(e=e.call(t)).next.bind(e);if(Array.isArray(t)||(e=Zd(t))||i&&t&&typeof t.length=="number"){e&&(t=e);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zd(t,i){if(t){if(typeof t=="string")return fs(t,i);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return fs(t,i)}}function fs(t,i){(i==null||i>t.length)&&(i=t.length);for(var e=0,r=new Array(i);e<i;e++)r[e]=t[e];return r}function eh(t,i){return t.length>0?new Jd.TrackingReport(i,t):null}function th(t){if(!t)return!1;for(var i=null,e=null,r=ps(t),n;!(n=r()).done;){var a=n.value,o=a.getName(),s=a.getValue();o==="width"&&!(0,hs.isNullOrEmpty)(s)?i=a:o==="height"&&!(0,hs.isNullOrEmpty)(s)&&(e=a)}return!!(i&&e)}function rh(t,i){for(var e=ps(t),r;!(r=e()).done;){var n=r.value,a=n[1];a.prefetch(i)}}});var Cr=D(Si=>{"use strict";Si.__esModule=!0;Si.LinearCreative=void 0;var ih=Lr(),gs=Lt(),nh=jt(),ta=J(),ra=Ze(),ah=Wt(),ia=X();function vs(t,i){var e=typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e)return(e=e.call(t)).next.bind(e);if(Array.isArray(t)||(e=oh(t))||i&&t&&typeof t.length=="number"){e&&(t=e);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oh(t,i){if(t){if(typeof t=="string")return ys(t,i);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return ys(t,i)}}function ys(t,i){(i==null||i>t.length)&&(i=t.length);for(var e=0,r=new Array(i);e<i;e++)r[e]=t[e];return r}function sh(t,i){t.prototype=Object.create(i.prototype),t.prototype.constructor=t,na(t,i)}function na(t,i){return na=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},na(t,i)}var lh=function(t){sh(i,t);function i(r,n,a,o){var s;return s=t.call(this,r)||this,s.duration=(0,gs.timeStringToMillis)(r.duration,0),s.trackingMap=r.trackingMap?r.trackingMap:new Map,s.videoClicks=n||new nh.VideoClicks("",null,null),s.icons=r.icons,s.assetUri=r.currentAssetUri?r.currentAssetUri:"",s.interactiveCreative=a,s.skipOffset=r.skipOffset,s.broker=o,s}var e=i.prototype;return e.getAssetUri=function(){return this.assetUri},e.getClickThroughUrl=function(){return this.videoClicks.getClickThroughUrl()},e.getClickTrackingUrls=function(){return this.videoClicks.getClickTrackingUrls()},e.getCustomClickUrls=function(){return this.videoClicks.getCustomClicks()},e.getDuration=function(){return this.duration},e.getIndustryIcons=function(){return Object.assign([],this.icons)},e.getInteractiveCreative=function(){return this.interactiveCreative},e.getSkipOffset=function(){if(!this.skipOffset||this.skipOffset==="")return-1;if(this.skipOffset.indexOf("%")!==-1){var n=parseFloat(this.skipOffset.substring(0,this.skipOffset.length-1));return n?Math.round(n*this.duration/100):(ta.YoLog.w("Invalid skipoffset string: "+this.skipOffset),-1)}else return(0,gs.timeStringToMillis)(this.skipOffset,-1)},e.getTrackingMap=function(){return this.trackingMap},e.getTrackingReport=function(n){return this.trackingMap.has(n)?this.trackingMap.get(n):null},e.initialiseInteractiveCreative=function(n){this.interactiveCreative&&this.interactiveCreative.initialise(this.getAdParameters(),this.duration,n)},e.isNonLinear=function(){return!1},e.isValid=function(){return this.duration>0},e.onClickThrough=function(){var n=this.videoClicks.getClickTrackingUrls();if(n.length>0){var a=(0,ah.getClickTrackingReport)(n,"ClickTracking");this.broker.fireTrackingReportForCreative(a,this)}this.broker.raiseTrackingCallbackForCreative("ClickTracking",this)},e.onTrackingEvent=function(n){if(n==="customClick"){var a=this.videoClicks.getCustomClicks();if(a.length){var o=new ra.TrackingReport(n,a);this.broker.fireTrackingReportForCreative(o,this)}}else{if(ra.TrackingReport.isValidPlayerOperationEvent(n)){ta.YoLog.w("Use PlaybackEventHandler functions to signal event "+n);return}if(ra.TrackingReport.isTimelineEvent(n)){ta.YoLog.w("Invalid event: "+n+". Timeline events are signalled by position updates");return}var s=this.trackingMap.get(n);s&&this.broker.fireTrackingReportForCreative(s,this)}},e.setDuration=function(n){this.duration=n},e.toString=function(){var n="";if(this.trackingMap.size>0){n+=`
 ** Tracking events - `;for(var a=vs(this.trackingMap),o;!(o=a()).done;){var s=o.value,c=s[0],d=s[1];n+=(0,ia.toIndentedString)(`
 `+c+":"+d)}}var p="";if(this.icons.length>0){p+=`
  ** Industry Icon(s) - `;for(var f=vs(this.icons),w;!(w=f()).done;){var B=w.value;p+=B}}var _=`
--- Linear Creative:
 - assetUri:`;return _+=this.assetUri,this.interactiveCreative&&(_+=this.interactiveCreative),_+=t.prototype.toString.call(this),(0,ia.isNullOrEmpty)(this.skipOffset)||(_+=`
 - SkipOffset:`,_+=this.skipOffset),_+=n,_+=(0,ia.toIndentedString)(this.videoClicks),_+=p,_},i}(ih.Creative);Si.LinearCreative=lh});var oa=D(bi=>{"use strict";bi.__esModule=!0;bi.ParsingError=void 0;var ms=X(),ch=Lt(),uh=Yn();function dh(t,i){t.prototype=Object.create(i.prototype),t.prototype.constructor=t,aa(t,i)}function aa(t,i){return aa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},aa(t,i)}var Es=function(t){dh(i,t);function i(r,n,a){var o;o=t.call(this,(0,ch.millisToTimestamp)(Date.now()))||this,o.message=n;var s=(0,ms.isNullOrEmpty)(a)?n:a;return s=s+((0,ms.isNullOrEmpty)(r)?"":" (breakId: "+r+")"),o.errorDetail=s,o}var e=i.prototype;return e.getMessage=function(){return this.message},e.getErrorDetail=function(){return this.errorDetail},i}(uh.SessionError);bi.ParsingError=Es;Es.Message=Object.freeze({BAD_XML:"XML is not well-formed",NO_VMAP:"Document is not VMAP",INCORRECT_VAST_VERSION:"Incorrect VAST version",INVALID_DURATION:"Invalid duration",INVALID_START_TIME:"Invalid start time",EMPTY_ADVERT_AND_TRACKING:"No adverts or tracking",INVALID_MEDIAID:"Yospace media id not found",MISSING_CREATIVE:"Missing Linear Creative",INVALID_TRACKING_URL:"Invalid tracking URL"})});var As=D((AE,hh)=>{hh.exports={name:"@foundation-player/yospace-admanagement-sdk",version:"3.6.5",description:"Yospace AdManagement SDK",homepage:"https://yospace.com",main:"lib/index.js",types:"types/index.d.ts",private:!1,dependencies:{sax:"1.2.4"},devDependencies:{"@babel/core":"^7.22.9","@babel/plugin-transform-modules-commonjs":"^7.22.5","@babel/preset-env":"^7.22.9","babel-jest":"^29.6.2","babel-loader":"^9.1.3","babel-plugin-transform-es2015-modules-simple-commonjs":"^0.3.0",documentation:"^13.2.5",jest:"^29.6.2","jest-jasmine2":"^29.6.2","jest-junit":"^16.0.0","jest-sonar-reporter":"^2.0.0",jsdoc:"^4.0.2",jshint:"^2.13.6","node-fetch":"^3.3.2",nodemon:"^3.0.1","npm-check-updates":"^16.10.17",nwb:"^0.25.2",process:"0.11.10",sinon:"^15.2.0","stream-browserify":"3.0.0",typescript:"5.1.x",webpack:"^5.88.2","webpack-cli":"^5.1.4",ws:"^8.13.0"},scripts:{build:"webpack","build-es5":"webpack --config webpack.config-es5.js","build-unminified":"webpack --config webpack.config-unminified.js","build:npm":"nwb build --no-demo",doc:"documentation build src/** -f html -o Documentation/html --theme src-docs/apidoctemplate",lint:"jshint --config .jshintrc ./src/ || true",test:"jest --coverage --forceExit --bail",testUnit:"jest --coverage --forceExit -t UNIT",testIntegration:"jest --coverage --forceExit --bail -t INTEGRATION",tsdefs:"npx -p typescript tsc src/index.js --stripInternal --declaration --allowJs --emitDeclarationOnly --outDir types",tsdefsHosting:"npx -p typescript tsc src/index.js --stripInternal --declaration --allowJs --emitDeclarationOnly --outDir types-${npm_package_version}"},author:{name:"Yospace Technologies Ltd",email:"sdk-team@yospace.com"},license:"SEE LICENSE IN LICENCE",files:["lib/","docs/","types/"]}});var Ve=D(z=>{"use strict";z.__esModule=!0;z.UNKNOWN_FORMAT=z.SessionState=z.SessionProperties=z.SessionErrorCode=z.Session=z.PlaybackMode=z.PARTIAL_VMAP=z.NO_DVRLIVE=z.MALFORMED_URL=z.INVALID_WINDOW=z.FALLBACK_URL=z.CONNECTION_TIMEOUT=z.CONNECTION_ERROR=void 0;var ki=Ne(),tt=ui(),fh=ns(),Dr=kr(),N=J(),sa=X(),ph=Ze(),_e=Ht(),Le=si(),gh=et(),vh=br(),Kt=$n(),yh=Qn(),TE=Gt(),mh=Cr(),Eh=gi(),SE=oa(),bE=qn();function Dt(t,i){var e=typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e)return(e=e.call(t)).next.bind(e);if(Array.isArray(t)||(e=Ah(t))||i&&t&&typeof t.length=="number"){e&&(t=e);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ah(t,i){if(t){if(typeof t=="string")return Ts(t,i);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Ts(t,i)}}function Ts(t,i){(i==null||i>t.length)&&(i=t.length);for(var e=0,r=new Array(i);e<i;e++)r[e]=t[e];return r}function Th(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Sh(t,i){t.prototype=Object.create(i.prototype),t.prototype.constructor=t,la(t,i)}function la(t,i){return la=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},la(t,i)}var bh=As(),ca=Object.freeze({LIVE:0,DVRLIVE:1,VOD:2});z.PlaybackMode=ca;var mt=Object.freeze({NONE:0,INITIALISED:1,FAILED:2,NO_ANALYTICS:3,SHUTDOWN:4});z.SessionState=mt;var ua=Object.freeze({TIMEOUT:0,UNRESOLVED_BREAK:1,PARSING_ERROR:2,TRACKING_ERROR:3});z.SessionErrorCode=ua;var kh=-1;z.CONNECTION_ERROR=kh;var Ih=-2;z.CONNECTION_TIMEOUT=Ih;var Ph=-3;z.MALFORMED_URL=Ph;var _h=-11;z.NO_DVRLIVE=_h;var Lh=-20;z.UNKNOWN_FORMAT=Lh;var da=-21;z.FALLBACK_URL=da;var wh=-22;z.PARTIAL_VMAP=wh;var Ch=-1;z.INVALID_WINDOW=Ch;var Dh=function(t){Sh(i,t);function i(r){var n;return n=t.call(this)||this,n.sessionProperties=r?Object.assign(Object.create(Object.getPrototypeOf(r)),r):new Ss,n.trackingErrors=[],n.reportsManager=new tt.ReportsManager(r,n.addTrackingError.bind(Th(n))),n.linearAdBreaks=[],n.nonLinearAdBreaks=[],n.displayAdBreaks=[],n.playbackBuffering=!1,n.playing=!1,n.currentAdBreak=null,n.currentAdvert=null,n.identifier="",n.playbackUrl=null,n.analyticsUrl=null,n.lastAnalyticUpdate=null,n.playhead=0,n.lastPlayed=0,n.lastTraced=0,n.sessionState=mt.NONE,n.resultCode=0,n.policyHandler=null,n.parsingErrors=[],n.defaultPolicyHandler=new vh.DefaultPlaybackPolicyHandler(n.getPlaybackMode()),n.analyticPoller=null,N.YoLog.trace("sdk javascript "+i.version()+" "+(0,Kt.getKeyFromValue)(n.getPlaybackMode(),ca)),n.logSessionInfo(),n}i.version=function(){return bh.version};var e=i.prototype;return e.logSessionInfo=function(){if(N.YoLog.logger.debug("Yospace AdManagement SDK for JavaScript v"+i.version()+" ("+(0,Kt.getKeyFromValue)(this.getPlaybackMode(),ca)+")"),N.YoLog.logger.debug("Debug flags:"),N.YoLog.getDebugFlags()===N.DebugFlags.DEBUG_ALL)N.YoLog.logger.debug("  DEBUG_ALL is set");else for(var n in N.DebugFlags)N.DebugFlags[n]!==N.DebugFlags.DEBUG_ALL&&N.DebugFlags[n]&N.YoLog.getDebugFlags()&&N.YoLog.logger.debug("  "+n+" is set");N.YoLog.logger.debug(this.getSessionProperties().toString())},e.addAnalyticObserver=function(n){if(!(0,Le.isValidCallbackImplementation)(n,yh.AnalyticEventObserver))throw new Error("addAnalyticObserver: invalid observer");this.reportsManager.addAnalyticObserver(n),this.parsingErrors.length>0&&this.getReportsManager().raiseSessionErrorCallback(ua.PARSING_ERROR,this)},e.addParsingError=function(n){this.parsingErrors.push(n)},e.addTrackingError=function(n){this.trackingErrors.push(n)},e.clearTrackingErrors=function(){this.trackingErrors=[]},e.analyticsSuppressed=function(){return this.reportsManager.reportsSuppressed()},e.adjustForEarlyReturn=function(n){var a=this.getAdBreakForPlayhead(n);a&&a.adjustForEarlyReturn(n)&&(this.getReportsManager().raiseAdBreakEarlyReturn(a,this),a.isValid()||this.linearAdBreaks.splice(this.linearAdBreaks.indexOf(a)))},e.canChangeVolume=function(n){var a=(0,Le.raiseCallback)(this.policyHandler,this.policyHandler.canChangeVolume,n,this.playhead,this.linearAdBreaks);return a===null&&(a=this.defaultPolicyHandler.canChangeVolume(n,this.playhead,this.linearAdBreaks)),a},e.canClickThrough=function(n){var a=(0,Le.raiseCallback)(this.policyHandler,this.policyHandler.canClickThrough,n,this.playhead,this.linearAdBreaks);return a===null&&(a=this.defaultPolicyHandler.canClickThrough(n,this.playhead,this.linearAdBreaks)),a},e.canPause=function(){var n=(0,Le.raiseCallback)(this.policyHandler,this.policyHandler.canPause,this.playhead,this.linearAdBreaks);return n===null&&(n=this.defaultPolicyHandler.canPause(this.playhead,this.linearAdBreaks)),n},e.canResize=function(n){var a=(0,Le.raiseCallback)(this.policyHandler,this.policyHandler.canResize,n,this.playhead,this.linearAdBreaks);return a===null&&(a=this.defaultPolicyHandler.canResize(n,this.playhead,this.linearAdBreaks)),a},e.canResizeCreative=function(n){var a=(0,Le.raiseCallback)(this.policyHandler,this.policyHandler.canResizeCreative,n,this.playhead,this.linearAdBreaks);return a===null&&(a=this.defaultPolicyHandler.canResizeCreative(n,this.playhead,this.linearAdBreaks)),a},e.canSkip=function(){var n=(0,Le.raiseCallback)(this.policyHandler,this.policyHandler.canSkip,this.playhead,this.linearAdBreaks,0);return n===null&&(n=this.defaultPolicyHandler.canSkip(this.playhead,this.linearAdBreaks,0)),n},e.canStop=function(){var n=(0,Le.raiseCallback)(this.policyHandler,this.policyHandler.canStop,this.playhead,this.linearAdBreaks);return n===null&&(n=this.defaultPolicyHandler.canStop(this.playhead,this.linearAdBreaks)),n},e.clearParsingErrors=function(){this.parsingErrors=[]},e.completeWithStatus=function(n,a){this.setState(n),this.setResultCode(a),n===mt.INITIALISED&&N.YoLog.trace("sessionStart")},e.fireImpressionReport=function(){var n=this.currentAdvert;if(n&&n.isActive()){var a=n.getImpressions(!0);if(a){N.YoLog.trace("impression");var o=new ph.TrackingReport(a.trackingEvent,a.trackingUrls),s=new tt.ReportingParams(this.getPlayhead(),n.getStart(),n.getLinearCreative().getAssetUri(),n.getMacroSubstitutions());this.reportsManager.fireBeacon(o,s),a.removeTrackingUrls()}}},e.fireTrackingReport=function(n){var a=null,o=null,s=null,c=this.getCurrentAdvert();c&&(a=c.getStart(),c.getLinearCreative()&&(o=c.getLinearCreative().getAssetUri()),s=c.getMacroSubstitutions()),N.YoLog.trace("trackingEvent "+n.getEventType());var d=new tt.ReportingParams(this.getPlayhead(),a,o,s);this.reportsManager.fireBeacon(n,d)},e.fireTrackingReportForCreative=function(n,a){var o=null,s=this.getAdvertForCreative(a);if(s){s.getLinearCreative()&&(o=s.getLinearCreative().getAssetUri()),N.YoLog.trace("trackingEvent "+n.getEventType());var c=new tt.ReportingParams(this.getPlayhead(),s.getStart(),o,s.getMacroSubstitutions());this.reportsManager.fireBeacon(n,c)}},e.fireTrackingReportForIcon=function(n,a){var o=null,s=this.currentAdvert;if(s&&s.isActive()&&s.containsIcon(a)){s.getLinearCreative()&&(o=s.getLinearCreative().getAssetUri()),N.YoLog.trace("trackingEvent "+n.getEventType());var c=new tt.ReportingParams(this.getPlayhead(),s.getStart(),o,s.getMacroSubstitutions());this.reportsManager.fireBeacon(n,c)}},e.getAdBreakForPlayhead=function(n){for(var a=Dt(this.linearAdBreaks),o;!(o=a()).done;){var s=o.value;if(s.getStart()<=n&&n<s.getStart()+s.getDuration())return s}return null},e.getAdBreaksByType=function(n){switch(n){case Dr.BreakType.LINEAR:return Object.assign([],this.linearAdBreaks);case Dr.BreakType.NONLINEAR:return Object.assign([],this.nonLinearAdBreaks);case Dr.BreakType.DISPLAY:return Object.assign([],this.displayAdBreaks);default:return null}},e.getAnalyticsUrl=function(){return this.analyticsUrl},e.getAdvertForCreative=function(n){var a=this.currentAdvert;if(a&&a.isActive()&&a.getLinearCreative()===n)return a;if(n.isNonLinear()){for(var o=Dt(this.nonLinearAdBreaks),s;!(s=o()).done;){var c=s.value;if(a=c.getAdvertForCreative(n),a)return a}for(var d=Dt(this.displayAdBreaks),p;!(p=d()).done;){var f=p.value;if(a=f.getAdvertForCreative(n),a)return a}}else if(!(n instanceof mh.LinearCreative))for(var w=Dt(this.linearAdBreaks),B;!(B=w()).done;){var _=B.value;if(a=_.getAdvertForCreative(n),a)return a}return null},e.getCurrentAdBreak=function(){return this.currentAdBreak},e.getCurrentAdvert=function(){return this.currentAdvert},e.getIdentifier=function(){return this.identifier},e.getJsonResponseUrl=function(n){try{var a=JSON.parse(n);return a.url}catch(o){return null}},e.getPlaybackMode=function(){throw new Error("This must be overridden")},e.getPlaybackUrl=function(){return this.playbackUrl},e.getPlayhead=function(){return this.playhead},e.getResultCode=function(){return this.resultCode},e.getLastAnalyticUpdate=function(){return this.lastAnalyticUpdate},e.getLastPlayed=function(){return this.lastPlayed},e.getReportsManager=function(){return this.reportsManager},e.getParsingErrors=function(){return Object.assign([],this.parsingErrors)},e.getTrackingErrors=function(){return Object.assign([],this.trackingErrors)},e.getSessionProperties=function(){return Object.freeze(this.sessionProperties)},e.getSessionState=function(){return this.sessionState},e.getToken=function(){return this.sessionProperties.getToken()},e.handleFallbackUrl=function(n){var a=this.getJsonResponseUrl(n);return a&&(0,gh.getUrl)(a)?(this.setPlaybackUrl(a),this.completeWithStatus(mt.NO_ANALYTICS,da),!0):(this.completeWithStatus(mt.FAILED,da),!1)},e.isNotPlaying=function(){return!this.playing},e.isPlaybackBuffering=function(){return this.playbackBuffering},e.normaliseAdBreakStart=function(n,a){var o=this.linearAdBreaks.length;if(o){var s=this.linearAdBreaks[o-1],c=(0,Dr.normalisePosition)(a,n,Dr.BreakType.LINEAR);if(s.getPosition().toLowerCase()===c.toLowerCase()){var d=s.getStart()+s.getDuration(),p=this.analyticPoller?this.analyticPoller.getFrequency():ki.Constant.DEFAULT_POLLING_DELAY,f=Math.min(this.sessionProperties.getConsecutiveBreakTolerance(),p);if(d>n||n-d<f)return d}}return n},e.onAdvertStart=function(n,a){n&&N.YoLog.d(N.DebugFlags.DEBUG_REPORTS,"onAdvertStart: "+(n.isActive()?"active ":"inactive ")+(n.isFiller()?"filler":"advert")+", duration: "+n.getDuration()+", trackingSchedule: "+(0,Kt.mapToString)(n.getTrackingSchedule()))},e.onAdvertSkip=function(n){this.signalActionTrackingEvent("skip"),this.policyHandler&&(0,Le.raiseCallback)(this.policyHandler,this.policyHandler.didSkip,this.playhead,n,this.linearAdBreaks),this.playhead=n},e.onPlaybackContinue=function(){this.playbackBuffering?(this.playbackBuffering=!1,N.YoLog.trace("playbackEvent continue")):N.YoLog.d(N.DebugFlags.DEBUG_PLAYBACK,"Reporting CONTINUE when not buffering")},e.onPlayerEvent=function(n,a){switch(N.YoLog.d(N.DebugFlags.DEBUG_PLAYBACK,"New playback event: "+(0,Kt.getKeyFromValue)(n,_e.PlayerEvent)+", playhead: "+a),n){case _e.PlayerEvent.START:this.onPlaybackStart(a);break;case _e.PlayerEvent.STOP:this.onPlaybackStop();break;case _e.PlayerEvent.PAUSE:this.onPlaybackPause();break;case _e.PlayerEvent.RESUME:this.onPlaybackResume();break;case _e.PlayerEvent.STALL:this.onPlaybackStall();break;case _e.PlayerEvent.CONTINUE:this.onPlaybackContinue();break;case _e.PlayerEvent.ADVERT_REWIND:this.onPlaybackRewind(a);break;case _e.PlayerEvent.ADVERT_SKIP:this.onAdvertSkip(a);break;case _e.PlayerEvent.SEEK:this.onPlaybackSeek(a);break;case _e.PlayerEvent.PLAYBACK_READY:this.onPlaybackReady();break;default:N.YoLog.w("Unknown playback event: "+n)}N.YoLog.d(N.DebugFlags.DEBUG_PLAYBACK,"Playing: "+this.playing+", Buffering: "+this.playbackBuffering)},e.onPlaybackPause=function(){this.playing?(this.playing=!1,this.signalActionTrackingEvent("pause")):N.YoLog.d(N.DebugFlags.DEBUG_PLAYBACK,"Reporting PAUSE when already paused")},e.onPlaybackResume=function(){this.playing?N.YoLog.d(N.DebugFlags.DEBUG_PLAYBACK,"Reporting RESUME when already paying"):(this.playing=!0,this.signalActionTrackingEvent("resume"))},e.onPlaybackReady=function(){N.YoLog.trace("playbackevent ready"),this.getSessionState()!==mt.INITIALISED?N.YoLog.d(N.DebugFlags.DEBUG_PLAYBACK,"Reporting PLAYBACKREADY when the session is not initialised"):this.playing===!0&&N.YoLog.d(N.DebugFlags.DEBUG_PLAYBACK,"Reporting PLAYBACKREADY when playback has already begun")},e.onPlaybackRewind=function(n){this.signalActionTrackingEvent("rewind"),this.playhead=n},e.onPlaybackSeek=function(n){this.policyHandler&&(0,Le.raiseCallback)(this.policyHandler,this.policyHandler.didSeek,this.playhead,n,this.linearAdBreaks),N.YoLog.trace("playbackEvent seek: "+n),this.playhead=n},e.onPlaybackStall=function(){this.playing&&!this.playbackBuffering?(this.playbackBuffering=!0,N.YoLog.trace("playbackEvent stall")):N.YoLog.d(N.DebugFlags.DEBUG_PLAYBACK,"Reporting STALL when not buffering")},e.onPlaybackStart=function(n){this.playing?N.YoLog.d(N.DebugFlags.DEBUG_PLAYBACK,"Reporting START when already playing"):(this.playing=!0,N.YoLog.trace("playbackEvent start"))},e.onPlaybackStop=function(){if(this.playing){this.playing=!1,this.playbackBuffering=!1,N.YoLog.trace("playbackEvent stop");var n=this.currentAdvert;if(n){var a=n.getLinearCreative();if(a){var o=a.getTrackingReport("closeLinear");o&&this.fireTrackingReport(o)}}}},e.onPlayheadSeek=function(n){this.policyHandler&&(0,Le.raiseCallback)(this.policyHandler,this.policyHandler.didSeek,this.playhead,n,this.linearAdBreaks),N.YoLog.trace("playbackEvent seek: "+n),this.playhead=n},e.onPlayheadUpdate=function(n){(this.lastTraced===0||n<this.lastTraced||n-this.lastTraced>=5e3)&&(N.YoLog.trace("sdk playhead "+n),this.lastTraced=n),this.lastPlayed=this.playhead,this.playhead=n},e.onSessionError=function(n){N.YoLog.trace("sessionerror "+n),N.YoLog.e("Yospace session has expired"),n===ua.TIMEOUT&&this.setState(mt.SHUTDOWN),this.getReportsManager().raiseSessionErrorCallback(n,this)},e.onTimedMetadata=function(n){},e.onViewSizeChange=function(n){switch(n){case _e.ViewSize.EXPANDED:this.signalActionTrackingEvent("playerExpand");break;case _e.ViewSize.COLLAPSED:this.signalActionTrackingEvent("playerCollapse");break;default:N.YoLog.w("Unknown ViewSize: "+(0,Kt.getKeyFromValue)(n,_e.ViewSize))}},e.onVolumeChange=function(n){var a=n?"mute":"unmute";this.signalActionTrackingEvent(a)},e.raiseTrackingCallbackForCreative=function(n,a){var o=this.getAdvertForCreative(a);o&&(N.YoLog.trace("trackingEvent "+n),this.getReportsManager().raiseTrackingCallback(n,this))},e.removeAllNonLinearAdBreaks=function(){this.nonLinearAdBreaks=[],this.displayAdBreaks=[]},e.removeAnalyticObserver=function(n){this.reportsManager.removeAnalyticObserver(n)},e.removeNonLinearAdBreak=function(n){for(var a=0;a<this.nonLinearAdBreaks.length;++a){var o=this.nonLinearAdBreaks[a];if(o===n){this.nonLinearAdBreaks.splice(a,1);return}}for(var s=0;s<this.displayAdBreaks.length;++s){var c=this.displayAdBreaks[s];if(c===n){this.displayAdBreaks.splice(s,1);return}}},e.removeKeysFromTrackingSchedule=function(n){for(var a=Dt(n),o;!(o=a()).done;){var s=o.value;this.currentAdvert.removeFromTrackingSchedule(s)}},e.setAnalyticsUrl=function(n){this.analyticsUrl=n},e.setCurrentAdBreak=function(n){this.currentAdBreak=n},e.setCurrentAdvert=function(n){this.currentAdvert=n},e.setIdentifier=function(n){this.identifier=n},e.setLastAnalyticUpdate=function(n){this.lastAnalyticUpdate=n},e.setPlaybackPolicyHandler=function(n){if(n){if(!(0,Le.isValidCallbackImplementation)(n,Eh.PlaybackPolicyHandler))throw new Error("setPlaybackPolicyHandler: invalid playback handler");this.policyHandler=n}else this.policyHandler=this.defaultPolicyHandler;(0,Le.raiseCallback)(this.policyHandler,this.policyHandler.setPlaybackMode,this.getPlaybackMode())},e.setPlaybackUrl=function(n){this.playbackUrl=n},e.setPlayhead=function(n){this.playhead=n},e.setReportsManager=function(n){this.reportsManager=n},e.setResultCode=function(n){this.resultCode=n},e.setState=function(n){this.sessionState=n},e.shutdown=function(){N.YoLog.d(N.DebugFlags.DEBUG_LIFECYCLE,"Session shutdown"),this.setState(mt.SHUTDOWN),this.onPlaybackStop(),N.YoLog.trace("sessionEnd")},e.signalActionTrackingEvent=function(n){var a=this.currentAdvert;if(a&&a.isActive()&&!a.isFiller()&&!(0,sa.isNullOrEmpty)(n)){N.YoLog.trace("actionEvent "+n);var o=a.getTrackingReports(n),s=new tt.ReportingParams(this.getPlayhead(),a.getStart(),a.getLinearCreative().getAssetUri(),a.getMacroSubstitutions());o.length>0&&this.reportsManager.fireBeacons(o,s),n!=="closeLinear"&&this.reportsManager.raiseTrackingCallback(n,this)}},e.signalNonLinearTrackingEvent=function(n){var a=this.currentAdvert;if(a&&a.isActive()&&!a.isFiller()&&!(0,sa.isNullOrEmpty)(n)){N.YoLog.trace("nonlinearTrackingEvent "+n);var o=a.getTrackingReportLinear(n);if(o){var s=new tt.ReportingParams(this.getPlayhead(),a.getStart(),a.getLinearCreative().getAssetUri(),a.getMacroSubstitutions());this.reportsManager.fireBeacon(o,s)}this.reportsManager.raiseTrackingCallback(n,this)}},e.signalTimelineTrackingEvents=function(n){var a=this.currentAdvert;if(a&&a.isActive()&&!a.isFiller()){for(var o=new tt.ReportingParams(this.getPlayhead(),a.getStart(),a.getLinearCreative().getAssetUri(),a.getMacroSubstitutions()),s=[],c=Dt(a.getTrackingSchedule()),d;!(d=c()).done;){var p=d.value,f=p[0],w=p[1];if(n+ki.Constant.EVENT_CUEPOINT_TOL>=f){N.YoLog.d(N.DebugFlags.DEBUG_REPORTS,"Tracking schedule entry retrieved: "+w),s.push(f);var B=a.getTrackingReportLinear(w);B&&this.reportsManager.fireBeacon(B,o);var _=w.indexOf("progress")!==-1?"progress":w;N.YoLog.trace("timelineEvent "+_),this.reportsManager.raiseTrackingCallback(_,this)}}this.removeKeysFromTrackingSchedule(s)}},e.signalTrackingEvent=function(n,a){var o=this.currentAdvert;if(o&&o.isActive()&&!o.isFiller()&&!(0,sa.isNullOrEmpty)(n)){if(N.YoLog.trace("trackingEvent"+n),a){var s=new tt.ReportingParams(this.getPlayhead(),o.getStart(),o.getLinearCreative().getAssetUri(),o.getMacroSubstitutions());this.reportsManager.fireBeacon(a,s)}this.reportsManager.raiseTrackingCallback(n,this)}},e.suppressAnalytics=function(n){if(this.reportsManager.suppressReports(n),!n&&this.currentAdBreak){var a=this.currentAdBreak.getTrackingReport("breakStart",!0);this.getReportsManager().fireBeacon(a,new tt.ReportingParams(this.getPlayhead()))}},e.willSeekTo=function(n){return this.policyHandler?(0,Le.raiseCallback)(this.policyHandler,this.policyHandler.willSeekTo,n,this.linearAdBreaks,this.getPlayhead()):n},i}(fh.AnalyticBroker);z.Session=Dh;var Ss=function(){function t(e){this.requestTimeout=e&&e.requestTimeout?e.requestTimeout:ki.Constant.REQUEST_TIMEOUT,this.resourceTimeout=e&&e.resourceTimeout?e.resourceTimeout:ki.Constant.REQUEST_TIMEOUT,this.userAgent=e?e.userAgent:"",this.prefetchResources=e?e.prefetchResources:!1,this.fireHistoricalBeacons=e?e.fireHistoricalBeacons:!0,this.eventCategories=e?e.eventCategories:0,this.allowCorsForAnalytics=e?e.allowCorsForAnalytics:!1,this.setCustomHttpHeaders(e?e.customHttpHeaders:new Map),this.useHttps=e?e.useHttps:!1,this.consecutiveBreakTolerance=e?e.consecutiveBreakTolerance:0,this.token=e?e.token:Math.floor(Math.random()*1e8)}var i=t.prototype;return i.excludeFromSuppression=function(r){this.eventCategories=r},i.getCustomHttpHeaders=function(){return this.customHttpHeaders},i.getExcludedCategories=function(){return this.eventCategories},i.getFireHistoricalBeacons=function(){return this.fireHistoricalBeacons},i.getPrefetchResources=function(){return this.prefetchResources},i.getRequestTimeout=function(){return this.requestTimeout},i.getResourceTimeout=function(){return this.resourceTimeout},i.getUserAgent=function(){return this.userAgent},i.getToken=function(){return this.token},i.getAllowCorsForAnalytics=function(){return this.allowCorsForAnalytics},i.getApplyEncryptedTracking=function(){return this.useHttps},i.getConsecutiveBreakTolerance=function(){return this.consecutiveBreakTolerance},i.setAllowCorsForAnalytics=function(r){this.allowCorsForAnalytics=r},i.setApplyEncryptedTracking=function(r){this.useHttps=r},i.setConsecutiveBreakTolerance=function(r){this.consecutiveBreakTolerance=r},i.setCustomHttpHeaders=function(r){if(r)for(var n=Dt(r),a;!(a=n()).done;){var o=a.value,s=o[0];s.toUpperCase()==="USER-AGENT"&&(N.YoLog.w("SessionProperties: 'User-Agent' ignored"),r.delete(s))}else r=new Map;this.customHttpHeaders=r},i.setFireHistoricalBeacons=function(r){this.fireHistoricalBeacons=r},i.setPrefetchResources=function(r){this.prefetchResources=r},i.setRequestTimeout=function(r){this.requestTimeout=r},i.setResourceTimeout=function(r){this.resourceTimeout=r},i.setToken=function(r){this.token=r},i.setUserAgent=function(r){this.userAgent=r},i.toString=function(){return`Session Properties:
  allowCorsForAnalytics: `+this.allowCorsForAnalytics+`
  applyEncryptedTracking: `+this.useHttps+`
  consecutiveBreakTolerance: `+this.consecutiveBreakTolerance+`
  customHttpHeaders: `+(0,Kt.mapToString)(this.customHttpHeaders)+`
  eventCategories: `+this.eventCategories+`
  fireHistoricalBeacons: `+this.fireHistoricalBeacons+`
  prefetchResources: `+this.prefetchResources+`
  requestTimeout: `+this.requestTimeout+`
  resourceTimeout: `+this.resourceTimeout+`
  userAgent: `+this.userAgent+`
  token: `+this.token},t}();z.SessionProperties=Ss});var et=D(Xt=>{"use strict";Xt.__esModule=!0;Xt.createHeaders=Mh;Xt.fetchWithTimeout=Bh;Xt.getAbsolute=Nh;Xt.getUrl=Oh;var Rh=X(),zt=J(),ha=Ve();function Nh(t,i){var e=new URL(i),r=new URL(e,t);return r.toString()}function Oh(t){if((0,Rh.isNullOrEmpty)(t))return null;var i=null;try{i=new URL(t)}catch(e){return null}if(!i)return null;try{decodeURI(i.pathname)}catch(e){return null}return i}function Mh(t){var i=new Headers;return i.append("User-Agent",t),i}function Bh(t,i,e){var r=null,n=new Promise(function(a){r=setTimeout(a,e,{timeout:!0,error:"timeout",statusText:"Connection timeout",status:ha.CONNECTION_TIMEOUT})});return Promise.race([fetch(t,i),n]).then(function(a){return a.timeout?zt.YoLog.d(zt.DebugFlags.DEBUG_HTTP_REQUESTS,"Request for "+t+" timed out"):!a.ok&&a.status&&zt.YoLog.d(zt.DebugFlags.DEBUG_HTTP_REQUESTS,"Request for "+t+" failed. Status: "+a.status+". Message: "+a.statusText),a}).catch(function(a){zt.YoLog.d(zt.DebugFlags.DEBUG_HTTP_REQUESTS,"Request for "+t+" failed. Exception: "+a);var o=ha.CONNECTION_ERROR;return(a.code==="ERR_INVALID_URL"||a.cause&&a.cause.code==="ERR_INVALID_URL")&&(o=ha.MALFORMED_URL),{error:a,statusText:a.message,status:o}}).finally(function(){clearTimeout(r)})}});var Ct=D(Ii=>{"use strict";Ii.__esModule=!0;Ii.HttpConnection=void 0;var bs=et(),Uh=Ne(),$t=J(),Fh=Ve();function fa(){"use strict";fa=function(){return t};var t={},i=Object.prototype,e=i.hasOwnProperty,r=Object.defineProperty||function(m,h,g){m[h]=g.value},n=typeof Symbol=="function"?Symbol:{},a=n.iterator||"@@iterator",o=n.asyncIterator||"@@asyncIterator",s=n.toStringTag||"@@toStringTag";function c(m,h,g){return Object.defineProperty(m,h,{value:g,enumerable:!0,configurable:!0,writable:!0}),m[h]}try{c({},"")}catch(m){c=function(g,S,A){return g[S]=A}}function d(m,h,g,S){var A=h&&h.prototype instanceof w?h:w,b=Object.create(A.prototype),U=new Qe(S||[]);return r(b,"_invoke",{value:cr(m,g,U)}),b}function p(m,h,g){try{return{type:"normal",arg:m.call(h,g)}}catch(S){return{type:"throw",arg:S}}}t.wrap=d;var f={};function w(){}function B(){}function _(){}var G={};c(G,a,function(){return this});var Z=Object.getPrototypeOf,ee=Z&&Z(Z(De([])));ee&&ee!==i&&e.call(ee,a)&&(G=ee);var se=_.prototype=w.prototype=Object.create(G);function te(m){["next","throw","return"].forEach(function(h){c(m,h,function(g){return this._invoke(h,g)})})}function me(m,h){function g(A,b,U,Y){var V=p(m[A],m,b);if(V.type!=="throw"){var ce=V.arg,ue=ce.value;return ue&&typeof ue=="object"&&e.call(ue,"__await")?h.resolve(ue.__await).then(function(fe){g("next",fe,U,Y)},function(fe){g("throw",fe,U,Y)}):h.resolve(ue).then(function(fe){ce.value=fe,U(ce)},function(fe){return g("throw",fe,U,Y)})}Y(V.arg)}var S;r(this,"_invoke",{value:function(b,U){function Y(){return new h(function(V,ce){g(b,U,V,ce)})}return S=S?S.then(Y,Y):Y()}})}function cr(m,h,g){var S="suspendedStart";return function(A,b){if(S==="executing")throw new Error("Generator is already running");if(S==="completed"){if(A==="throw")throw b;return Q()}for(g.method=A,g.arg=b;;){var U=g.delegate;if(U){var Y=Se(U,g);if(Y){if(Y===f)continue;return Y}}if(g.method==="next")g.sent=g._sent=g.arg;else if(g.method==="throw"){if(S==="suspendedStart")throw S="completed",g.arg;g.dispatchException(g.arg)}else g.method==="return"&&g.abrupt("return",g.arg);S="executing";var V=p(m,h,g);if(V.type==="normal"){if(S=g.done?"completed":"suspendedYield",V.arg===f)continue;return{value:V.arg,done:g.done}}V.type==="throw"&&(S="completed",g.method="throw",g.arg=V.arg)}}}function Se(m,h){var g=h.method,S=m.iterator[g];if(S===void 0)return h.delegate=null,g==="throw"&&m.iterator.return&&(h.method="return",h.arg=void 0,Se(m,h),h.method==="throw")||g!=="return"&&(h.method="throw",h.arg=new TypeError("The iterator does not provide a '"+g+"' method")),f;var A=p(S,m.iterator,h.arg);if(A.type==="throw")return h.method="throw",h.arg=A.arg,h.delegate=null,f;var b=A.arg;return b?b.done?(h[m.resultName]=b.value,h.next=m.nextLoc,h.method!=="return"&&(h.method="next",h.arg=void 0),h.delegate=null,f):b:(h.method="throw",h.arg=new TypeError("iterator result is not an object"),h.delegate=null,f)}function ur(m){var h={tryLoc:m[0]};1 in m&&(h.catchLoc=m[1]),2 in m&&(h.finallyLoc=m[2],h.afterLoc=m[3]),this.tryEntries.push(h)}function y(m){var h=m.completion||{};h.type="normal",delete h.arg,m.completion=h}function Qe(m){this.tryEntries=[{tryLoc:"root"}],m.forEach(ur,this),this.reset(!0)}function De(m){if(m){var h=m[a];if(h)return h.call(m);if(typeof m.next=="function")return m;if(!isNaN(m.length)){var g=-1,S=function A(){for(;++g<m.length;)if(e.call(m,g))return A.value=m[g],A.done=!1,A;return A.value=void 0,A.done=!0,A};return S.next=S}}return{next:Q}}function Q(){return{value:void 0,done:!0}}return B.prototype=_,r(se,"constructor",{value:_,configurable:!0}),r(_,"constructor",{value:B,configurable:!0}),B.displayName=c(_,s,"GeneratorFunction"),t.isGeneratorFunction=function(m){var h=typeof m=="function"&&m.constructor;return!!h&&(h===B||(h.displayName||h.name)==="GeneratorFunction")},t.mark=function(m){return Object.setPrototypeOf?Object.setPrototypeOf(m,_):(m.__proto__=_,c(m,s,"GeneratorFunction")),m.prototype=Object.create(se),m},t.awrap=function(m){return{__await:m}},te(me.prototype),c(me.prototype,o,function(){return this}),t.AsyncIterator=me,t.async=function(m,h,g,S,A){A===void 0&&(A=Promise);var b=new me(d(m,h,g,S),A);return t.isGeneratorFunction(h)?b:b.next().then(function(U){return U.done?U.value:b.next()})},te(se),c(se,s,"Generator"),c(se,a,function(){return this}),c(se,"toString",function(){return"[object Generator]"}),t.keys=function(m){var h=Object(m),g=[];for(var S in h)g.push(S);return g.reverse(),function A(){for(;g.length;){var b=g.pop();if(b in h)return A.value=b,A.done=!1,A}return A.done=!0,A}},t.values=De,Qe.prototype={constructor:Qe,reset:function(h){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(y),!h)for(var g in this)g.charAt(0)==="t"&&e.call(this,g)&&!isNaN(+g.slice(1))&&(this[g]=void 0)},stop:function(){this.done=!0;var h=this.tryEntries[0].completion;if(h.type==="throw")throw h.arg;return this.rval},dispatchException:function(h){if(this.done)throw h;var g=this;function S(ce,ue){return U.type="throw",U.arg=h,g.next=ce,ue&&(g.method="next",g.arg=void 0),!!ue}for(var A=this.tryEntries.length-1;A>=0;--A){var b=this.tryEntries[A],U=b.completion;if(b.tryLoc==="root")return S("end");if(b.tryLoc<=this.prev){var Y=e.call(b,"catchLoc"),V=e.call(b,"finallyLoc");if(Y&&V){if(this.prev<b.catchLoc)return S(b.catchLoc,!0);if(this.prev<b.finallyLoc)return S(b.finallyLoc)}else if(Y){if(this.prev<b.catchLoc)return S(b.catchLoc,!0)}else{if(!V)throw new Error("try statement without catch or finally");if(this.prev<b.finallyLoc)return S(b.finallyLoc)}}}},abrupt:function(h,g){for(var S=this.tryEntries.length-1;S>=0;--S){var A=this.tryEntries[S];if(A.tryLoc<=this.prev&&e.call(A,"finallyLoc")&&this.prev<A.finallyLoc){var b=A;break}}b&&(h==="break"||h==="continue")&&b.tryLoc<=g&&g<=b.finallyLoc&&(b=null);var U=b?b.completion:{};return U.type=h,U.arg=g,b?(this.method="next",this.next=b.finallyLoc,f):this.complete(U)},complete:function(h,g){if(h.type==="throw")throw h.arg;return h.type==="break"||h.type==="continue"?this.next=h.arg:h.type==="return"?(this.rval=this.arg=h.arg,this.method="return",this.next="end"):h.type==="normal"&&g&&(this.next=g),f},finish:function(h){for(var g=this.tryEntries.length-1;g>=0;--g){var S=this.tryEntries[g];if(S.finallyLoc===h)return this.complete(S.completion,S.afterLoc),y(S),f}},catch:function(h){for(var g=this.tryEntries.length-1;g>=0;--g){var S=this.tryEntries[g];if(S.tryLoc===h){var A=S.completion;if(A.type==="throw"){var b=A.arg;y(S)}return b}}throw new Error("illegal catch attempt")},delegateYield:function(h,g,S){return this.delegate={iterator:De(h),resultName:g,nextLoc:S},this.method==="next"&&(this.arg=void 0),f}},t}function ks(t,i,e,r,n,a,o){try{var s=t[a](o),c=s.value}catch(d){e(d);return}s.done?i(c):Promise.resolve(c).then(r,n)}function Vh(t){return function(){var i=this,e=arguments;return new Promise(function(r,n){var a=t.apply(i,e);function o(c){ks(a,r,n,o,s,"next",c)}function s(c){ks(a,r,n,o,s,"throw",c)}o(void 0)})}}function Is(t,i){var e=typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e)return(e=e.call(t)).next.bind(e);if(Array.isArray(t)||(e=xh(t))||i&&t&&typeof t.length=="number"){e&&(t=e);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xh(t,i){if(t){if(typeof t=="string")return Ps(t,i);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Ps(t,i)}}function Ps(t,i){(i==null||i>t.length)&&(i=t.length);for(var e=0,r=new Array(i);e<i;e++)r[e]=t[e];return r}var Yh=function(){function t(e,r,n){this.url=e,this.opts=r,this.requestTimeout=n||Uh.Constant.REQUEST_TIMEOUT}t.get=function(r,n,a,o,s){return t.handleGet(r,n,a,o,s)},t.handleGet=function(r,n,a,o,s){if($t.YoLog.d($t.DebugFlags.DEBUG_HTTP_REQUESTS,"Requesting "+r),s instanceof Map){var c=(0,bs.getUrl)(r);if(c){for(var d=Is(s),p;!(p=d()).done;){var f=p.value,w=f[0],B=f[1];c.searchParams.set(w,B)}r=c.toString()}}if(o){for(var _=new Headers,G=Is(o),Z;!(Z=G()).done;){var ee=Z.value,se=ee[0],te=ee[1];_.set(se,te)}n.headers=_}var me=new t(r,n,a);return me.executeGet()};var i=t.prototype;return i.executeGet=function(){var e=Vh(fa().mark(function n(){var a,o;return fa().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return a={},c.next=3,(0,bs.fetchWithTimeout)(this.url,this.opts,this.requestTimeout);case 3:if(o=c.sent,a.ok=o.ok,a.headers=o.headers,a.status=o.status,a.statusText=o.statusText,a.timeout=o.timeout,a.url=o.url,a.error=o.error,a.type=o.type,a.timeout&&$t.YoLog.w("Request to "+a.url+" timed out"),a.error&&$t.YoLog.w("Request to "+a.url+" failed: "+a.error),!o.ok){c.next=28;break}return c.prev=15,c.next=18,o.text();case 18:a.body=c.sent,c.next=28;break;case 21:return c.prev=21,c.t0=c.catch(15),a.ok=!1,a.status=Fh.CONNECTION_ERROR,a.statusText=c.t0.message,a.error=c.t0,c.abrupt("return",a);case 28:return a.status&&$t.YoLog.d($t.DebugFlags.DEBUG_HTTP_REQUESTS,"HTTP response: "+a.status+" ("+this.url+")"),c.abrupt("return",a);case 30:case"end":return c.stop()}},n,this,[[15,21]])}));function r(){return e.apply(this,arguments)}return r}(),t}();Ii.HttpConnection=Yh});var rt=D(Qt=>{"use strict";Qt.__esModule=!0;Qt.ResourceType=Qt.Resource=void 0;var Hh=X(),qh=ut(),Gh=J(),jh=Ct();function Wh(t,i){t.prototype=Object.create(i.prototype),t.prototype.constructor=t,pa(t,i)}function pa(t,i){return pa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},pa(t,i)}var xe={STATIC:0,HTML:1,IFRAME:2,UNKNOWN:3};Qt.ResourceType=xe;var Kh=function(t){Wh(i,t);function i(r,n,a,o){var s;switch(s=t.call(this)||this,r){case xe.STATIC:s.stringData=n,s.creativeType=a,s.encoded=!1,s.type=r;break;case xe.IFRAME:s.stringData=n,s.creativeType=null,s.type=r,s.encoded=!1;break;case xe.HTML:s.stringData=n,s.creativeType=null,s.type=r,s.encoded=o;break}return s.byteData=null,s}var e=i.prototype;return e.getByteData=function(){return this.byteData},e.getCreativeType=function(){return this.creativeType},e.getResourceType=function(){return this.type},e.getStringData=function(){return this.stringData},e.isEncoded=function(){return this.encoded},e.isValid=function(){switch(this.type){case xe.STATIC:if(!this.creativeType||this.creativeType==="")return!1;break;case xe.HTML:if(!this.stringData||this.stringData==="")return!1;break;case xe.IFRAME:try{new URL(this.stringData)}catch(n){return!1}break;default:return!1}return!0},e.prefetch=function(n){var a=this;this.byteData||this.type===xe.HTML||this.type===xe.UNKNOWN||jh.HttpConnection.get(this.stringData,{},n).then(function(o){o.ok?a.byteData=o.body:Gh.YoLog.e("Resource prefetch request failed: "+a.stringData+", status: "+o.status+", error:"+o.statusText)})},e.toString=function(){var n="";switch(this.type){case xe.STATIC:n+=`
Static resource (`,n+=this.creativeType,n+="): ",n+=this.stringData;break;case xe.HTML:n+=`
HTML resource (`,n+=this.encoded?"encoded): ":"unencoded): ",n+=(0,Hh.formatHtml)(this.stringData);break;case xe.IFRAME:n+=`
iFrame resource: `,n+=this.stringData;break}return n},i}(qh.XmlValidation);Qt.Resource=Kh});var va=D(Pi=>{"use strict";Pi.__esModule=!0;Pi.CompanionAds=void 0;var zh=X(),Xh=rt();function ga(t,i){var e=typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e)return(e=e.call(t)).next.bind(e);if(Array.isArray(t)||(e=$h(t))||i&&t&&typeof t.length=="number"){e&&(t=e);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $h(t,i){if(t){if(typeof t=="string")return _s(t,i);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return _s(t,i)}}function _s(t,i){(i==null||i>t.length)&&(i=t.length);for(var e=0,r=new Array(i);e<i;e++)r[e]=t[e];return r}var Qh=function(){function t(e,r){this.required=e,this.companions=r||[]}var i=t.prototype;return i.containsCreative=function(r){return this.companions.indexOf(r)!==-1},i.getCompanions=function(){return Object.assign([],this.companions)},i.getCompanionsByType=function(r){for(var n=[],a=ga(this.companions),o;!(o=a()).done;){var s=o.value;(s.getResource(r)||r===Xh.ResourceType.UNKNOWN&&s.getResources().size===0)&&n.push(s)}return n},i.getRequired=function(){return this.required},i.prefetchResources=function(r){for(var n=ga(this.companions),a;!(a=n()).done;){var o=a.value;o.prefetchResources(r)}},i.toString=function(){var r="";if(this.companions.length>0){r=`
--- Companion Ads required:`,r+=this.required;for(var n=ga(this.companions),a;!(a=n()).done;){var o=a.value;r+=(0,zh.toIndentedString)(o)}}return r},t}();Pi.CompanionAds=Qh});var dt=D(_i=>{"use strict";_i.__esModule=!0;_i.VASTProperty=void 0;var Jh=X();function Zh(t,i){var e=typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e)return(e=e.call(t)).next.bind(e);if(Array.isArray(t)||(e=ef(t))||i&&t&&typeof t.length=="number"){e&&(t=e);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ef(t,i){if(t){if(typeof t=="string")return Ls(t,i);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Ls(t,i)}}function Ls(t,i){(i==null||i>t.length)&&(i=t.length);for(var e=0,r=new Array(i);e<i;e++)r[e]=t[e];return r}var tf=function(){function t(e,r,n,a){this.name=e,this.value=r||"",this.attributes=new Map,n&&a&&this.addAttribute(n,a)}var i=t.prototype;return i.addAttribute=function(r,n){this.attributes.set(r,n)},i.getName=function(){return this.name},i.getValue=function(){return this.value},i.getAttributes=function(){return this.attributes},i.setValue=function(r){this.value=r},i.toString=function(){var r="";if(r+="Property Name: ",r+=this.name,(0,Jh.isNullOrEmpty)(this.value)||(r+=", Value: ",r+=this.value),this.attributes.size>0){r+=", Attributes:{";for(var n=Zh(this.attributes),a;!(a=n()).done;){var o=a.value,s=o[0],c=o[1];r+=s+":"+c+" "}r+="}"}return r},t}();_i.VASTProperty=tf});var Di=D(Ci=>{"use strict";Ci.__esModule=!0;Ci.CompanionCreative=void 0;var rf=Lr(),nf=jt(),ya=Wt(),af=J(),Li=X(),CE=rt(),DE=dt();function wi(t,i){var e=typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e)return(e=e.call(t)).next.bind(e);if(Array.isArray(t)||(e=of(t))||i&&t&&typeof t.length=="number"){e&&(t=e);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function of(t,i){if(t){if(typeof t=="string")return ws(t,i);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return ws(t,i)}}function ws(t,i){(i==null||i>t.length)&&(i=t.length);for(var e=0,r=new Array(i);e<i;e++)r[e]=t[e];return r}function sf(t,i){t.prototype=Object.create(i.prototype),t.prototype.constructor=t,ma(t,i)}function ma(t,i){return ma=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},ma(t,i)}var lf=function(t){sf(i,t);function i(r,n,a,o,s){var c;c=t.call(this,r)||this,c.resources=new Map,c.visible=!1,c.properties=r.properties?r.properties:[],c.altText=r.altText,c.trackingMap=o||new Map,c.videoClicks=n||new nf.VideoClicks,c.broker=s,c.companionExtensions=r.companionExtensions;for(var d=wi(a),p;!(p=d()).done;){var f=p.value;c.resources.set(f.getResourceType(),f)}return c}var e=i.prototype;return e.getAltText=function(){return this.altText},e.getClickThroughUrl=function(){return this.videoClicks.getClickThroughUrl()},e.getClickTrackingUrls=function(){return this.videoClicks.getClickTrackingUrls()},e.getProperties=function(){return Object.assign([],this.properties)},e.getProperty=function(n){for(var a=wi(this.properties),o;!(o=a()).done;){var s=o.value;if(s.getName()===n)return s}return null},e.getResource=function(n){return this.resources.has(n)?this.resources.get(n):null},e.getResources=function(){return this.resources},e.getTrackingMap=function(){return this.trackingMap},e.isValid=function(){return(0,ya.isValidSize)(this.properties)&&this.resources.size>0||this.trackingMap.size>0},e.isVisible=function(){return this.visible},e.onClickThrough=function(){if(!this.isVisible()){af.YoLog.w("Companion is not visible");return}var n=this.videoClicks.getClickTrackingUrls(),a=(0,ya.getClickTrackingReport)(n,"CompanionClickTracking");a&&this.broker.fireTrackingReportForCreative(a,this)},e.onTrackingEvent=function(n){},e.prefetchResources=function(n){(0,ya.prefetch)(this.resources,n)},e.setVisible=function(n){if(this.visible!==n&&(this.visible=n,n)){var a="creativeView",o=this.trackingMap.get(a);o&&this.broker.fireTrackingReportForCreative(o,this)}},e.toString=function(){for(var n=`
--- Companion ---
`,a=wi(this.properties),o;!(o=a()).done;){var s=o.value;n+=`
`+(0,Li.toIndentedString)(s)}n+=(0,Li.toIndentedString)(`
Alt Text: `+this.altText),n+=(0,Li.toIndentedString)(this.videoClicks);for(var c=wi(this.resources),d;!(d=c()).done;){var p=d.value,f=p[0],w=p[1];n+=(0,Li.toIndentedString)(f+":"+w)}return n+=t.prototype.toString.call(this),n},i}(rf.Creative);Ci.CompanionCreative=lf});var Ea=D(Ri=>{"use strict";Ri.__esModule=!0;Ri.NonLinearAds=void 0;var Cs=X();function Jt(t,i){var e=typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e)return(e=e.call(t)).next.bind(e);if(Array.isArray(t)||(e=cf(t))||i&&t&&typeof t.length=="number"){e&&(t=e);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cf(t,i){if(t){if(typeof t=="string")return Ds(t,i);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Ds(t,i)}}function Ds(t,i){(i==null||i>t.length)&&(i=t.length);for(var e=0,r=new Array(i);e<i;e++)r[e]=t[e];return r}var uf=function(){function t(e,r){this.trackingMap=e||new Map,this.nonLinearCreatives=r||[]}var i=t.prototype;return i.allNonLinearsAreInactive=function(){for(var r=Jt(this.nonLinearCreatives),n;!(n=r()).done;){var a=n.value;if(a.isVisible())return!1}return!0},i.containsCreative=function(r){return this.nonLinearCreatives.indexOf(r)!==-1},i.getNonLinearCreatives=function(){return Object.assign([],this.nonLinearCreatives)},i.getNonLinearCreativesByType=function(r){for(var n=[],a=Jt(this.nonLinearCreatives),o;!(o=a()).done;){var s=o.value;s.getResource(r)&&n.push(s)}return n},i.getTrackingMap=function(){return this.trackingMap},i.getTrackingReport=function(r){if(!this.allNonLinearsAreInactive())return this.trackingMap.get(r)},i.postParse=function(){for(var r=Jt(this.nonLinearCreatives),n;!(n=r()).done;){var a=n.value;a.setTrackingReports(this.trackingMap)}},i.prefetchResources=function(r){for(var n=Jt(this.nonLinearCreatives),a;!(a=n()).done;){var o=a.value;o.prefetchResources(r)}},i.toString=function(){if(this.nonLinearCreatives.length>0){var r=`
--- NonLinear Ads:`;if(this.trackingMap.size>0){r+=`
  ** Tracking events - `;for(var n=Jt(this.trackingMap),a;!(a=n()).done;){var o=a.value,s=o[0],c=o[1];r+=(0,Cs.toIndentedString)(`
 `+s+":"+c)}}for(var d=Jt(this.nonLinearCreatives),p;!(p=d()).done;){var f=p.value;r+=(0,Cs.toIndentedString)(f)}return r}return""},t}();Ri.NonLinearAds=uf});var Ta=D(Zt=>{"use strict";Zt.__esModule=!0;Zt.ViewableEvent=Zt.AdvertEventHandler=void 0;var df=ut();function hf(t,i){t.prototype=Object.create(i.prototype),t.prototype.constructor=t,Aa(t,i)}function Aa(t,i){return Aa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},Aa(t,i)}var ff=Object.freeze({VIEWABLE:0,NOT_VIEWABLE:1,VIEW_UNDETERMINED:2});Zt.ViewableEvent=ff;var pf=function(t){hf(i,t);function i(){return t.apply(this,arguments)||this}var e=i.prototype;return e.onViewableEvent=function(n){throw new Error("Function must be overridden")},e.onErrorEvent=function(n){throw new Error("Function must be overridden")},e.onImpressionEvent=function(){throw new Error("Function must be overridden")},i}(df.XmlValidation);Zt.AdvertEventHandler=pf});var Rr=D(Ni=>{"use strict";Ni.__esModule=!0;Ni.Event=void 0;var gf=function(){function t(e,r){this.payload=e,this.source=r||null}var i=t.prototype;return i.getPayload=function(){return this.payload},i.getSource=function(){return this.source},t}();Ni.Event=gf});var ba=D(Oi=>{"use strict";Oi.__esModule=!0;Oi.VerificationEventHandler=void 0;var vf=ut();function yf(t,i){t.prototype=Object.create(i.prototype),t.prototype.constructor=t,Sa(t,i)}function Sa(t,i){return Sa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},Sa(t,i)}var mf=function(t){yf(i,t);function i(){return t.apply(this,arguments)||this}var e=i.prototype;return e.onVerificationEvent=function(n,a){throw new Error("Function must be overridden")},i}(vf.XmlValidation);Oi.VerificationEventHandler=mf});var Bi=D(Mi=>{"use strict";Mi.__esModule=!0;Mi.AdVerification=void 0;var Ef=Rr(),ka=J(),Af=X(),Tf=ba(),UE=rt();function Ia(t,i){var e=typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e)return(e=e.call(t)).next.bind(e);if(Array.isArray(t)||(e=Sf(t))||i&&t&&typeof t.length=="number"){e&&(t=e);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Sf(t,i){if(t){if(typeof t=="string")return Rs(t,i);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Rs(t,i)}}function Rs(t,i){(i==null||i>t.length)&&(i=t.length);for(var e=0,r=new Array(i);e<i;e++)r[e]=t[e];return r}function bf(t,i){t.prototype=Object.create(i.prototype),t.prototype.constructor=t,Pa(t,i)}function Pa(t,i){return Pa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},Pa(t,i)}var kf=function(t){bf(i,t);function i(r){var n;return n=t.call(this)||this,n.vendor=r.verificationVendor,n.resources=r.verificationResources,n.verificationEvents=r.verificationEvents,n.parameters=r.verificationParameters,n.listeners=[],n.broker=null,n}var e=i.prototype;return e.getAdVerificationEvents=function(){return this.verificationEvents},e.getParameters=function(){return this.parameters},e.getResources=function(){return Object.assign([],this.resources)},e.getVendor=function(){return this.vendor},e.isValid=function(){return!!(this.vendor&&this.resources&&this.resources.length>0)},e.onVerificationEvent=function(n,a){if(this.listeners.length===0){ka.YoLog.w("No event listeners - can't signal VerificationEvent");return}var o=Number.isInteger(a);a&&!o&&ka.YoLog.w("onVerificationEvent: reason should be an integer.");var s=this.verificationEvents.get(n);if(s){if(o&&a)for(var c=Ia(this.listeners),d;!(d=c()).done;){var p=d.value;p(new Ef.Event(a))}this.broker.fireTrackingReport(s)}},e.postParse=function(n,a){this.broker=n,a?this.listeners.push(a):ka.YoLog.e("postParse: callback was null")},e.toString=function(){var n="";if(this.verificationEvents.size>0){n+=`
 - Verification events:`;for(var a=Ia(this.verificationEvents),o;!(o=a()).done;){var s=o.value,c=s[0],d=s[1];n+=`
 `+c+"="+d}}var p=`
--- Ad Verification:
 - Vendor:`;p+=this.vendor,p+=`
 - Resources:`;for(var f=Ia(this.resources),w;!(w=f()).done;){var B=w.value;p+=`
`+(0,Af.toIndentedString)(B)}return p+=n,p+=`
 - VerificationParameters:`,p+=this.parameters,p},i}(Tf.VerificationEventHandler);Mi.AdVerification=kf});var Fi=D(Ui=>{"use strict";Ui.__esModule=!0;Ui.AdvertWrapper=void 0;var If=ut();function Pf(t,i){t.prototype=Object.create(i.prototype),t.prototype.constructor=t,_a(t,i)}function _a(t,i){return _a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},_a(t,i)}var _f=function(t){Pf(i,t);function i(r,n,a){var o;return o=t.call(this)||this,o.identifier=r,o.creativeIdentifier=n,o.adSystem=a,o.child=null,o}var e=i.prototype;return e.getAdSystem=function(){return this.adSystem},e.getCreativeIdentifier=function(){return this.creativeIdentifier},e.getIdentifier=function(){return this.identifier},e.getLineage=function(){return this.child},e.isValid=function(){var n=this;do{if(!n.identifier||n.identifier==="")return!1;n=n.getLineage()}while(n);return!0},e.setChild=function(n){this.child=n},i}(If.XmlValidation);Ui.AdvertWrapper=_f});var xi=D(Vi=>{"use strict";Vi.__esModule=!0;Vi.IconClickFallbackImage=void 0;var Lf=Wt(),wf=ut(),Cf=X(),xE=rt(),YE=dt();function Df(t,i){var e=typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e)return(e=e.call(t)).next.bind(e);if(Array.isArray(t)||(e=Rf(t))||i&&t&&typeof t.length=="number"){e&&(t=e);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rf(t,i){if(t){if(typeof t=="string")return Ns(t,i);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Ns(t,i)}}function Ns(t,i){(i==null||i>t.length)&&(i=t.length);for(var e=0,r=new Array(i);e<i;e++)r[e]=t[e];return r}function Nf(t,i){t.prototype=Object.create(i.prototype),t.prototype.constructor=t,La(t,i)}function La(t,i){return La=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},La(t,i)}var Of=function(t){Nf(i,t);function i(r,n,a){var o;return o=t.call(this)||this,o.properties=r||[],o.altText=n,o.resource=a,o}var e=i.prototype;return e.getAltText=function(){return this.altText},e.getProperties=function(){return Object.assign([],this.properties)},e.getProperty=function(n){for(var a=Df(this.properties),o;!(o=a()).done;){var s=o.value;if(s.getName()===n)return s}return null},e.getResource=function(){return this.resource},e.isValid=function(){return!!((0,Lf.isValidSize)(this.properties)&&(!(0,Cf.isNullOrEmpty)(this.altText)||this.resource))},i}(wf.XmlValidation);Vi.IconClickFallbackImage=Of});var qi=D(Hi=>{"use strict";Hi.__esModule=!0;Hi.IndustryIcon=void 0;var Mf=jt(),Yi=X(),Bf=Ir(),Uf=Ze(),qE=xi(),GE=rt(),jE=dt(),Ff=Wt();function er(t,i){var e=typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e)return(e=e.call(t)).next.bind(e);if(Array.isArray(t)||(e=Vf(t))||i&&t&&typeof t.length=="number"){e&&(t=e);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vf(t,i){if(t){if(typeof t=="string")return Os(t,i);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Os(t,i)}}function Os(t,i){(i==null||i>t.length)&&(i=t.length);for(var e=0,r=new Array(i);e<i;e++)r[e]=t[e];return r}function xf(t,i){t.prototype=Object.create(i.prototype),t.prototype.constructor=t,wa(t,i)}function wa(t,i){return wa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},wa(t,i)}var Yf=function(t){xf(i,t);function i(r,n,a,o,s){var c;c=t.call(this)||this,c.resources=new Map,c.visible=!1,c.properties=r||[],c.videoClicks=a||new Mf.VideoClicks,c.clickFallbackImages=o||[],c.broker=s;for(var d=er(n),p;!(p=d()).done;){var f=p.value;c.resources.set(f.getResourceType(),f)}return c}var e=i.prototype;return e.getClickFallbackImages=function(){return Object.assign([],this.clickFallbackImages)},e.getClickThroughUrl=function(){return this.videoClicks.getClickThroughUrl()},e.getClickTrackingUrls=function(){return this.videoClicks.getClickTrackingUrls()},e.isVisible=function(){return this.visible},e.getViewTrackingUrls=function(){return this.videoClicks.getCustomClicks()},e.getProperties=function(){return Object.assign([],this.properties)},e.getProperty=function(n){for(var a=er(this.properties),o;!(o=a()).done;){var s=o.value;if(s.getName()===n)return s}},e.getResource=function(n){return this.resources.get(n)},e.getResources=function(){return this.resources},e.isValid=function(){for(var n=null,a=null,o=null,s=null,c=null,d=er(this.properties),p;!(p=d()).done;){var f=p.value,w=f.getValue();(0,Yi.isNullOrEmpty)(w)||(f.getName()==="program"&&(n=f),f.getName()==="width"&&(a=f),f.getName()==="height"&&(o=f),f.getName()==="xPosition"&&(s=f),f.getName()==="yPosition"&&(c=f))}return a!==null&&o!==null&&n!==null&&s!==null&&c!==null&&this.resources.size>0},e.onClickThrough=function(){if(this.isVisible()){var n=this.videoClicks.getClickTrackingUrls();if(n.length>0){var a=(0,Ff.getClickTrackingReport)(n,"IconClickTracking");a&&this.broker.fireTrackingReportForIcon(a,this)}}},e.onTrackingEvent=function(n){},e.setVisible=function(n){if(this.visible!==n&&(this.visible=n,this.visible&&this.videoClicks.getCustomClicks().length>0)){var a=new Uf.TrackingReport("IconViewTracking",this.videoClicks.getCustomClicks());a&&this.broker.fireTrackingReportForIcon(a,this)}},e.toString=function(){var n="";n+=this.videoClicks.toString(),this.properties.length>0&&(n+=`
Icon Properties: `);for(var a=er(this.properties),o;!(o=a()).done;){var s=o.value;n+=`
`+(0,Yi.toIndentedString)(s)}this.resources.length>0&&(n+=`
Icon Resource(s): `);for(var c=er(this.resources),d;!(d=c()).done;){var p=d.value,f=p[0],w=p[1];n+=(0,Yi.toIndentedString)(f+":"+w)}this.clickFallbackImages.length>0&&(n+=`
Icon Click Fallback Images: `);for(var B=er(this.clickFallbackImages),_;!(_=B()).done;){var G=_.value;n+=`
`+(0,Yi.toIndentedString)(G)}return n},i}(Bf.CreativeEventHandler);Hi.IndustryIcon=Yf});var Or=D(ji=>{"use strict";ji.__esModule=!0;ji.NonLinearCreative=void 0;var Hf=Lr(),qf=jt(),Ca=Wt(),Da=X(),Nr=J(),Ra=Ze(),KE=dt(),zE=rt();function Gi(t,i){var e=typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e)return(e=e.call(t)).next.bind(e);if(Array.isArray(t)||(e=Gf(t))||i&&t&&typeof t.length=="number"){e&&(t=e);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gf(t,i){if(t){if(typeof t=="string")return Ms(t,i);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Ms(t,i)}}function Ms(t,i){(i==null||i>t.length)&&(i=t.length);for(var e=0,r=new Array(i);e<i;e++)r[e]=t[e];return r}function jf(t,i){t.prototype=Object.create(i.prototype),t.prototype.constructor=t,Na(t,i)}function Na(t,i){return Na=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},Na(t,i)}var Wf=function(t){jf(i,t);function i(r,n,a,o){var s;if(s=t.call(this,r)||this,s.resources=new Map,s.visible=!1,s.videoClicks=n||new qf.VideoClicks("",null,null),s.properties=r.properties?r.properties:[],s.broker=o,s.trackingMap=new Map,a)for(var c=Gi(a),d;!(d=c()).done;){var p=d.value;s.resources.set(p.getResourceType(),p)}return s}var e=i.prototype;return e.getApiFramework=function(){var n=this.getProperty("apiFramework");return n?n.getValue():null},e.getClickThroughUrl=function(){return this.videoClicks.getClickThroughUrl()},e.getClickTrackingUrls=function(){return this.videoClicks.getClickTrackingUrls()},e.getProperties=function(){return Object.assign([],this.properties)},e.getProperty=function(n){for(var a=Gi(this.properties),o;!(o=a()).done;){var s=o.value;if(s.getName()===n)return s}return null},e.getResource=function(n){return this.resources.get(n)},e.getResources=function(){return this.resources},e.getTrackingReports=function(){return this.trackingMap},e.isValid=function(){return(0,Ca.isValidSize)(this.properties)&&this.resources.size>0},e.isVisible=function(){return this.visible},e.onClickThrough=function(){if(!this.visible){Nr.YoLog.w("Nonlinear creative is not visible");return}var n=this.videoClicks.getClickTrackingUrls();if(n.length>0){var a=(0,Ca.getClickTrackingReport)(n,"NonLinearClickTracking");a&&this.broker.fireTrackingReportForCreative(a,this)}},e.onTrackingEvent=function(n){if(!this.visible){Nr.YoLog.w("Nonlinear creative is not visible");return}if(Ra.TrackingReport.isValidVisibleEvent(n)){Nr.YoLog.w("Use method setVisible() to signal event: "+n);return}if(Ra.TrackingReport.isValidPlayerOperationEvent(n)&&!this.isNonLinear){Nr.YoLog.w("Use PlaybackEventHandler functions to signal event: "+n);return}if(!Ra.TrackingReport.isValidNonLinearEvent(n)){Nr.YoLog.w("Invalid tracking event: "+n);return}var a=this.trackingMap.get(n);a&&this.broker.fireTrackingReportForCreative(a,this),n==="acceptInvitation"&&this.broker.raiseTrackingCallbackForCreative(n,this)},e.prefetchResources=function(n){(0,Ca.prefetch)(this.resources,n)},e.setTrackingReports=function(n){this.trackingMap=n},e.setVisible=function(n){if(this.visible!==n){this.visible=n;var a=null;n?a=this.trackingMap.get("creativeView"):a=this.trackingMap.get("close"),a&&this.broker.fireTrackingReportForCreative(a,this)}},e.toString=function(){var n=`
--- NonLinear Creative:`;n+=(0,Da.toIndentedString)(this.videoClicks),this.properties.length>0&&(n+=`
 - NonLinear Properties: `);for(var a=Gi(this.properties),o;!(o=a()).done;){var s=o.value;n+=`
`+(0,Da.toIndentedString)(s)}this.resources.size>0&&(n+=`
 - NonLinear Resource(s): `);for(var c=Gi(this.resources),d;!(d=c()).done;){var p=d.value,f=p[0],w=p[1];n+=(0,Da.toIndentedString)(f+":"+w)}return n+=t.prototype.toString.call(this),n},i}(Hf.Creative);ji.NonLinearCreative=Wf});var zi=D(Ki=>{"use strict";Ki.__esModule=!0;Ki.InteractiveCreative=void 0;var Oa=X(),Kf=Ze(),zf=Ir(),$E=Or(),QE=dt(),Bs=J(),Xf=et();function Wi(t,i){var e=typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e)return(e=e.call(t)).next.bind(e);if(Array.isArray(t)||(e=$f(t))||i&&t&&typeof t.length=="number"){e&&(t=e);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $f(t,i){if(t){if(typeof t=="string")return Us(t,i);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Us(t,i)}}function Us(t,i){(i==null||i>t.length)&&(i=t.length);for(var e=0,r=new Array(i);e<i;e++)r[e]=t[e];return r}function Qf(t,i){t.prototype=Object.create(i.prototype),t.prototype.constructor=t,Ma(t,i)}function Ma(t,i){return Ma=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},Ma(t,i)}var Jf=function(t){Qf(i,t);function i(r,n,a,o){var s;return s=t.call(this)||this,s.source=r,s.properties=n||[],s.broker=a,s.adParameters=null,s.advertDuration=0,s.tracking=null,s.offset=0,s.visible=!1,s.nonLinearCreatives=[],s.isSIMID()&&(s.tracking=o),s}var e=i.prototype;return e.getAdParameters=function(){return this.adParameters},e.getAdvertDuration=function(){return this.advertDuration},e.getNonLinearCreatives=function(){return this.nonLinearCreatives},e.getProperties=function(){return Object.assign([],this.properties)},e.getProperty=function(n){for(var a=Wi(this.properties),o;!(o=a()).done;){var s=o.value;if(s.getName()===n)return s}return null},e.getSource=function(){return this.source},e.getTracking=function(){return this.tracking},e.initialise=function(n,a,o){this.adParameters=n,this.advertDuration=a,this.nonLinearCreatives=[];var s=this.getProperty("apiFramework");if(s)for(var c=s.getValue(),d=Wi(o),p;!(p=d()).done;){var f=p.value,w=f.getProperty("apiFramework");w&&w.getValue()===c&&this.nonLinearCreatives.push(f)}},e.isSIMID=function(){for(var n=Wi(this.properties),a;!(a=n()).done;){var o=a.value;if(o.getName()==="apiFramework"&&o.getValue()==="SIMID")return!0}return!1},e.isValid=function(){return!(0,Oa.isNullOrEmpty)(this.source)},e.isVisible=function(){return this.visible},e.onClickThrough=function(){},e.onTrackingEvent=function(n){if(!this.isVisible()){Bs.YoLog.w("Warning: InteractiveCreative is not visible");return}if(!(0,Xf.getUrl)(n)){Bs.YoLog.w("Invalid custom tracker URL");return}this.isSIMID()&&this.broker.fireTrackingReport(new Kf.TrackingReport("custom",[n]))},e.setTracking=function(n){this.tracking=n},e.setVisible=function(n){this.visible!==n&&(this.visible=n,this.visible&&this.isSIMID()&&this.tracking&&this.broker.fireTrackingReport(this.tracking))},e.toString=function(){var n="InteractiveCreative source: "+this.source;if(this.properties.length>0){n+=`
Properties:`;for(var a=Wi(this.properties),o;!(o=a()).done;){var s=o.value;n+=(0,Oa.toIndentedString)(s)}}return this.tracking&&(n+=`
Tracking event:`,n+=(0,Oa.toIndentedString)(`
 `+this.tracking)),n},i}(zf.CreativeEventHandler);Ki.InteractiveCreative=Jf});var Gt=D($i=>{"use strict";$i.__esModule=!0;$i.Advert=void 0;var Zf=va(),ep=Di(),Ba=J(),tp=Lt(),rp=Ea(),Oe=X(),Xi=Ta(),ZE=Bi(),e0=Fi(),t0=qi(),r0=zi(),ip=Cr(),np=Or(),i0=rt(),n0=dt(),a0=_r(),ap=Ze();function ht(t,i){var e=typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e)return(e=e.call(t)).next.bind(e);if(Array.isArray(t)||(e=op(t))||i&&t&&typeof t.length=="number"){e&&(t=e);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function op(t,i){if(t){if(typeof t=="string")return Fs(t,i);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Fs(t,i)}}function Fs(t,i){(i==null||i>t.length)&&(i=t.length);for(var e=0,r=new Array(i);e<i;e++)r[e]=t[e];return r}function sp(t,i){t.prototype=Object.create(i.prototype),t.prototype.constructor=t,Ua(t,i)}function Ua(t,i){return Ua=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},Ua(t,i)}var Mr=function(t){sp(i,t),i.buildMapString=function(n){var a="";if(n.size>0)for(var o=ht(n),s;!(s=o()).done;){var c=s.value,d=c[0],p=c[1];a+=`
 `+d+"="+p}};function i(r){var n;if(n=t.call(this)||this,n.startMillis=0,n.identifier="",n.mediaIdentifier="",n.active=!1,r.id){var a=r.id.split("_YO_");a.length===2&&(n.identifier=a[0],n.mediaIdentifier=a[1])}return n.properties=r.properties?r.properties:[],n.linearCreative=r.linearCreative,n.nonLinearAds=r.nonLinearAds?r.nonLinearAds:new rp.NonLinearAds,n.companionAds=r.companionAds?r.companionAds:new Zf.CompanionAds,n.impressions=r.impressions,n.errors=r.errors,n.viewableImpressions=r.viewableImpressions?r.viewableImpressions:new Map,n.adVerifications=r.adVerifications?r.adVerifications:[],n.sequence=r.sequence,n.adType=r.adType,n.nonLinear=r.nonLinear,n.filler=r.filler,n.trackingSchedule=new Map,!r.topLevelWrapper||!r.topLevelWrapper.isValid()?n.wrapper=null:n.wrapper=r.topLevelWrapper,n.extensions=r.extensions,n.broker=null,n.macroSubstitutions=new Map,n.earlyReturn=!1,n}var e=i.prototype;return e.addMacroSubstitution=function(n,a){this.macroSubstitutions.set(n,a)},e.addTrackingScheduleEntry=function(n,a){for(var o=a*this.linearCreative.getDuration();this.trackingSchedule.has(o);)++o;this.trackingSchedule.set(o,n)},e.adjustForEarlyReturn=function(n){var a=n-this.startMillis;this.setDuration(a);for(var o=this.getTrackingSchedule(),s=ht(o.keys()),c;!(c=s()).done;){var d=c.value;d>a&&this.removeFromTrackingSchedule(d)}this.earlyReturn=!0},e.clearTrackingSchedule=function(){this.trackingSchedule.clear()},e.containsCreative=function(n){return n instanceof ip.LinearCreative?n===this.linearCreative:n instanceof np.NonLinearCreative?this.nonLinearAds.containsCreative(n):n instanceof ep.CompanionCreative?this.companionAds.containsCreative(n):!1},e.containsIcon=function(n){for(var a=ht(this.linearCreative.getIndustryIcons()),o;!(o=a()).done;){var s=o.value;if(s===n)return!0}return!1},e.getAdVerifications=function(){return Object.assign([],this.adVerifications)},e.getAdType=function(){return this.adType},e.getCompanionAds=function(){return this.companionAds},e.getCompanionAdsByType=function(n){return this.companionAds.getCompanionsByType(n)},e.getCompanionRequired=function(){return this.companionAds.getRequired()},e.getDuration=function(){return this.nonLinear?0:this.linearCreative.getDuration()},e.getEnd=function(){return this.startMillis+this.linearCreative.getDuration()},e.getExtensions=function(){return this.extensions},e.getIdentifier=function(){return this.identifier},e.getImpressions=function(n){if(!this.impressions)return null;var a=new ap.TrackingReport(this.impressions.trackingEvent,this.impressions.trackingUrls);return n&&(this.impressions=null),a},e.getIndustryIcons=function(){return this.linearCreative.getIndustryIcons()},e.getInteractiveCreative=function(){return this.linearCreative.getInteractiveCreative()},e.isTruncated=function(){return this.earlyReturn},e.getLineage=function(){return this.wrapper},e.getLinearCreative=function(){return this.linearCreative},e.getMacroSubstitutions=function(){return this.macroSubstitutions},e.getMediaIdentifier=function(){return this.mediaIdentifier},e.getNonLinearAds=function(){return this.nonLinearAds},e.getNonLinearCreativesByType=function(n){return this.nonLinearAds.getNonLinearCreativesByType(n)},e.getProperties=function(){return Object.assign([],this.properties)},e.getProperty=function(n){for(var a=ht(this.properties),o;!(o=a()).done;){var s=o.value;if(s.getName()===n)return s}return null},e.getProportion=function(n){var a=0,o=n.split("-");if(o.length!==2)Ba.YoLog.w("Badly formed progress event in VAST/VMAP: "+n),a=-1;else if(o[1].indexOf("%")!==-1){var s=parseFloat(o[1].substring(0,o[1].length-1));a=s?s/100:-1,a<0&&Ba.YoLog.w("Badly formed percentage string in VAST/VMAP: "+o[1])}else a=parseFloat((0,tp.timeStringToMillis)(o[1],-1)/this.linearCreative.getDuration());return a},e.getRemainingTime=function(n){var a=this.startMillis+this.linearCreative.getDuration(),o=Math.min(a-n,this.linearCreative.getDuration());return Math.max(0,o)},e.getSequence=function(){return this.sequence},e.getSkipOffset=function(){return this.linearCreative.getSkipOffset()},e.getStart=function(){return this.startMillis},e.getTrackingReports=function(n){var a=[],o=this.linearCreative.getTrackingReport(n);return o&&a.push(o),o=this.nonLinearAds.getTrackingReport(n),o&&a.push(o),a},e.getTrackingReportLinear=function(n){if(this.linearCreative)return this.linearCreative.getTrackingReport(n)},e.getTrackingReportNonLinear=function(n){if(this.nonLinearAds)return this.nonLinearAds.getTrackingReport(n)},e.getTrackingSchedule=function(){return this.trackingSchedule},e.getViewableImpressions=function(){return this.viewableImpressions},e.isActive=function(){return this.active},e.isFiller=function(){return this.filler},e.isNonLinear=function(){return this.nonLinear},e.isValid=function(){return this.nonLinear?!this.linearCreative:!(0,Oe.isNullOrEmpty)(this.mediaIdentifier)&&this.linearCreative!==null},e.onErrorEvent=function(n){this.errors&&(n&&this.addMacroSubstitution("ERRORCODE",n.toString()),this.broker.fireTrackingReport(this.errors))},e.onImpressionEvent=function(){if(!this.nonLinear){Ba.YoLog.w("Warning: Advert is not nonlinear - can't signal ImpressionEvent");return}var n=this.getImpressions(!1);n&&this.broker.fireTrackingReport(n)},e.onViewableEvent=function(n){var a=i.viewableEventMap.get(n),o=this.viewableImpressions.get(a);o&&this.broker.fireTrackingReport(o)},e.postParse=function(n){var a=this;if(this.broker=n,!this.nonLinear){this.addTrackingScheduleEntry("loaded",0),this.addTrackingScheduleEntry("start",0),this.addTrackingScheduleEntry("firstQuartile",.25),this.addTrackingScheduleEntry("midpoint",.5),this.addTrackingScheduleEntry("thirdQuartile",.75),this.addTrackingScheduleEntry("complete",1);for(var o=ht(this.linearCreative.getTrackingMap()),s;!(s=o()).done;){var c=s.value,d=c[0],p=c[1];if(d.indexOf("progress")!==-1){var f=this.getProportion(d,p);f>=0&&this.addTrackingScheduleEntry(d,f)}}this.trackingSchedule=new Map(Array.from(this.trackingSchedule).sort(function(G,Z){return G[0]-Z[0]}))}for(var w=ht(this.adVerifications),B;!(B=w()).done;){var _=B.value;_.postParse(this.broker,function(G){a.addMacroSubstitution("REASON",G.getPayload())})}this.nonLinearAds.postParse(),this.linearCreative&&this.linearCreative.initialiseInteractiveCreative(this.nonLinearAds.getNonLinearCreatives()),this.prefetchResources(n.getSessionProperties()),this.active=!0},e.prefetchResources=function(n){n.getPrefetchResources()&&(this.nonLinearAds.prefetchResources(n.getResourceTimeout()),this.companionAds.prefetchResources(n.getResourceTimeout()))},e.removeFromTrackingSchedule=function(n){this.trackingSchedule.delete(n)},e.removeMacroSubstitution=function(n){this.macroSubstitutions.delete(n)},e.removeTrackingSchedule=function(){this.trackingSchedule.clear()},e.setDuration=function(n){this.linearCreative&&this.linearCreative.setDuration(n)},e.setInactive=function(){this.active=!1},e.setStart=function(n){this.startMillis=n},e.toString=function(){if(this.isFiller())return`
--- Advert ---
 - Filler duration: `+this.getDuration();var n=`
* Impression(s):`;if(this.impressions)for(var a=ht(this.impressions.getTrackingUrls()),o;!(o=a()).done;){var s=o.value;n+=s}else n+="NONE";var c=`
* Viewable Impression(s):`;c+=i.buildMapString(this.viewableImpressions);var d=`
 * Ad Verification(s):`;d+=(0,Oe.toIndentedString)(this.adVerifications);var p=`
 Error(s):`;if(this.errors)for(var f=ht(this.errors.getTrackingUrls()),w;!(w=f()).done;){var B=w.value;p+=(0,Oe.toIndentedString)(`
 - `+B)}else p+="NONE";var _=`
--- Advert ---
 ID:`;_+=this.mediaIdentifier,_+="(",_+=this.identifier,_+=")",_+=" duration:",_+=this.getDuration(),_+=" sequence:",_+=this.sequence,_+=" adtype:",_+=this.adType;for(var G=ht(this.properties),Z;!(Z=G()).done;){var ee=Z.value;_+=`
`+(0,Oe.toIndentedString)(ee)}return this.extensions&&(_+=`
 * Extensions:`,_+=`
`+(0,Oe.toIndentedString)(this.getExtensions())),this.wrapper&&(_+=`
 * Lineage -
`,_+=(0,Oe.toIndentedString)(this.wrapper)),_+=(0,Oe.toIndentedString)(n),_+=(0,Oe.toIndentedString)(c),_+=(0,Oe.toIndentedString)(d),_+=(0,Oe.toIndentedString)(p),this.nonLinear||(_+=(0,Oe.toIndentedString)(this.linearCreative)),_+=(0,Oe.toIndentedString)(this.nonLinearAds),_+=(0,Oe.toIndentedString)(this.companionAds),_},i}(Xi.AdvertEventHandler);$i.Advert=Mr;Mr.viewableEventMap=new Map;Mr.viewableEventMap.set(Xi.ViewableEvent.VIEWABLE,"Viewable");Mr.viewableEventMap.set(Xi.ViewableEvent.NOT_VIEWABLE,"NotViewable");Mr.viewableEventMap.set(Xi.ViewableEvent.VIEW_UNDETERMINED,"ViewUndetermined")});var kr=D(Rt=>{"use strict";Rt.__esModule=!0;Rt.BreakType=Rt.AdBreak=void 0;Rt.normalisePosition=Hs;var Vs=J(),lp=Vn(),s0=Gt(),l0=_r(),xs=X();function Et(t,i){var e=typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e)return(e=e.call(t)).next.bind(e);if(Array.isArray(t)||(e=cp(t))||i&&t&&typeof t.length=="number"){e&&(t=e);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cp(t,i){if(t){if(typeof t=="string")return Ys(t,i);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Ys(t,i)}}function Ys(t,i){(i==null||i>t.length)&&(i=t.length);for(var e=0,r=new Array(i);e<i;e++)r[e]=t[e];return r}function up(t,i){t.prototype=Object.create(i.prototype),t.prototype.constructor=t,Fa(t,i)}function Fa(t,i){return Fa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},Fa(t,i)}var it=Object.freeze({LINEAR:0,NONLINEAR:1,DISPLAY:2});Rt.BreakType=it;function Hs(t,i,e){var r=t?t.toLowerCase():"";return r==="preroll"||r==="midroll"||r==="postroll"?r:i===0?"preroll":e===it.LINEAR?"midroll":"unknown"}var dp=function(t){up(i,t);function i(r,n,a,o,s,c,d,p){var f;return f=t.call(this)||this,f.startMillis=r,f.duration=n,f.trackingMap=o||new Map,f.breakType=i.getBreakTypeFromString(s),f.position=Hs(a,r,f.breakType),f.identifier=c,f.extensions=d,f.broker=null,f.adverts=[],f.adTagUri=p||null,f.breakType!==it.LINEAR&&f.startMillis===-1&&(f.startMillis=0),f}i.getBreakTypeFromString=function(n){return(0,xs.equalsIgnoreCase)(n,"nonlinear")?it.NONLINEAR:(0,xs.equalsIgnoreCase)(n,"display")?it.DISPLAY:it.LINEAR};var e=i.prototype;return e.adjustForEarlyReturn=function(n){var a=this.getAdvertFromPlayhead(n);if(a){var o=a.getStart()===n;return o||a.adjustForEarlyReturn(n),this.removeAdvertsFrom(a,o),this.setDuration(n-this.startMillis),!0}return!1},e.getAdvertForCreative=function(n){for(var a=Et(this.adverts),o;!(o=a()).done;){var s=o.value;if(s.containsCreative(n))return s}return null},e.getAdvertFromPlayhead=function(n){for(var a=Et(this.adverts),o;!(o=a()).done;){var s=o.value;if(s.getStart()<=n&&n<s.getEnd())return s}return null},e.getAdvertFromIdentifier=function(n){for(var a=Et(this.adverts),o;!(o=a()).done;){var s=o.value;if(s.getMediaIdentifier()===n)return s}return null},e.getAdverts=function(){return Object.assign([],this.adverts)},e.getAdTagUri=function(){return this.adTagUri},e.getBreakTypeAsString=function(){switch(this.breakType){case it.NONLINEAR:return"nonlinear";case it.DISPLAY:return"display";default:return"linear"}},e.getType=function(){return this.breakType},e.getDuration=function(){return this.duration},e.getExtensions=function(){return this.extensions},e.getIdentifier=function(){return this.identifier},e.isPlaceholder=function(){return this.adTagUri!==null},e.getPosition=function(){return this.position},e.getRemainingTime=function(n){var a=0;if(this.adverts.length>0){var o=this.adverts[0],s=o.getStart()+this.getDuration();a=Math.min(s-n,this.getDuration())}return Math.max(0,a)},e.getStart=function(){return this.startMillis},e.getTrackingMap=function(){return this.trackingMap},e.getTrackingReport=function(n,a){var o=this.trackingMap.get(n);return o&&a&&this.trackingMap.delete(n),o},e.isActive=function(){if(!this.adverts)return!1;for(var n=Et(this.adverts),a;!(a=n()).done;){var o=a.value;if(o.isActive())return!0}return!1},e.isNonLinear=function(){return this.breakType!==it.LINEAR},e.isValid=function(){return this.breakType===it.LINEAR&&this.startMillis===-1?(Vs.YoLog.e("Linear AdBreak is invalid - start position is unknown"),!1):this.adverts.length>0||this.trackingMap.size>0||this.isPlaceholder()},e.onNonLinearTrackingEvent=function(n){if(!this.isNonLinear()){Vs.YoLog.w("Warning: AdBreak is not nonlinear - can't signal NonLinearTrackingEvent");return}var a=this.getTrackingReport(n,!1);a&&this.broker.fireTrackingReport(a)},e.postParse=function(n){this.broker=n;for(var a=this.startMillis,o=Et(this.adverts),s;!(s=o()).done;){var c=s.value;c.setStart(a),a+=c.getDuration(),c.postParse(n)}},e.removeAdvertsFrom=function(n,a){for(var o=0;o<this.adverts.length;++o){var s=this.adverts[o];if(s===n){var c=a===!0?o:o+1;this.adverts.splice(c,this.adverts.length-c);return}}},e.setAdverts=function(n){Array.prototype.push.apply(this.adverts,n);for(var a=this.startMillis,o=Et(this.adverts),s;!(s=o()).done;){var c=s.value;c.setStart(a),a+=c.getDuration()}},e.setAdvertsInactivePriorTo=function(n){for(var a=Et(this.adverts),o;!(o=a()).done;){var s=o.value;if(s.getEnd()<n)s.setInactive();else return!1}return!0},e.setDuration=function(n){this.duration=n},e.setInactive=function(){if(!this.isNonLinear()){for(var n=Et(this.adverts),a;!(a=n()).done;){var o=a.value;o.setInactive()}this.trackingMap.clear()}},e.toString=function(){return`
--- AdBreak ---
 breakType:`+this.getBreakTypeAsString()+" start:"+this.startMillis+" milliseconds, duration:"+this.duration+", position:"+this.position+`
Number of adverts:`+this.adverts.length},i}(lp.AdBreakEventHandler);Rt.AdBreak=dp});var Ya=D(Zi=>{"use strict";Zi.__esModule=!0;Zi.SessionSeekable=void 0;var Va=ui(),qs=Ve(),js=Ne(),j=J();function Qi(t,i){var e=typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e)return(e=e.call(t)).next.bind(e);if(Array.isArray(t)||(e=hp(t))||i&&t&&typeof t.length=="number"){e&&(t=e);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hp(t,i){if(t){if(typeof t=="string")return Gs(t,i);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Gs(t,i)}}function Gs(t,i){(i==null||i>t.length)&&(i=t.length);for(var e=0,r=new Array(i);e<i;e++)r[e]=t[e];return r}function fp(t,i){t.prototype=Object.create(i.prototype),t.prototype.constructor=t,xa(t,i)}function xa(t,i){return xa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},xa(t,i)}var Ji=2*js.Constant.MAX_CADENCE,pp=function(t){fp(i,t);function i(r){var n;return n=t.call(this,r)||this,n.didSeek=!1,n.duration=0,n}var e=i.prototype;return e.getDuration=function(){return this.duration},e.initialiseFromAnalyticData=function(n,a){this.setPlaybackUrl(a+n.getHostNode()+n.getHostSuffix()),this.setDuration(n.getStreamDuration()),this.setIdentifier(n.getSessionIdentifier()),Array.prototype.push.apply(this.linearAdBreaks,n.getLinearAdBreaks()),Array.prototype.push.apply(this.nonLinearAdBreaks,n.getNonLinearAdBreaks()),Array.prototype.push.apply(this.displayAdBreaks,n.getDisplayAdBreaks())},e.mergePlaceholderBreaks=function(n){for(var a=!0,o=0;o<this.linearAdBreaks.length;++o){var s=this.linearAdBreaks[o];if(s.isPlaceholder())for(var c=Qi(n.getLinearAdBreaks()),d;!(d=c()).done;){var p=d.value;s.getIdentifier()===p.getIdentifier()&&s.getStart()===p.getStart()&&(p.postParse(this),this.linearAdBreaks[o]=p)}this.linearAdBreaks[o].isPlaceholder()&&(j.YoLog.e("Placeholder AdBreak with id "+s.getIdentifier()+" not found"),a=!1)}return a},e.onAdvertBreakStart=function(n){if(!this.getCurrentAdBreak()&&(this.clearTrackingErrors(),this.setCurrentAdBreak(n),j.YoLog.trace("adbreakStart"),this.getReportsManager().raiseAdBreakCallback("start",this.getCurrentAdBreak(),this),n&&!this.reportsManager.shouldSuppress("breakStart"))){var a=n.getTrackingReport("breakStart",!0);this.getReportsManager().fireBeacon(a,new Va.ReportingParams(this.getPlayhead()))}},e.onAdvertBreakEnd=function(){var n=this.getCurrentAdBreak();if(n&&!this.reportsManager.shouldSuppress("breakEnd")){var a=n.getTrackingReport("breakEnd",!0);this.getReportsManager().fireBeacon(a,new Va.ReportingParams(this.getPlayhead()))}j.YoLog.trace("adbreakEnd"),this.getReportsManager().raiseAdBreakCallback("end",null,this),this.trackingErrors.length>0&&this.getReportsManager().raiseSessionErrorCallback(qs.SessionErrorCode.TRACKING_ERROR,this),this.setCurrentAdBreak(null)},e.onAdvertEnd=function(){var n=this.getCurrentAdvert();n&&n.isActive()&&this.signalTimelineTrackingEvents(n.getStart()+n.getDuration()),n&&n.setInactive(),j.YoLog.trace("advertEnd"),this.getReportsManager().raiseAdvertCallback("end",null,this),this.setCurrentAdvert(null)},e.onAdvertStart=function(n){this.getCurrentAdvert()||(this.setCurrentAdvert(n),t.prototype.onAdvertStart.call(this,n),this.getReportsManager().reportsSuppressed()&&n.removeTrackingSchedule(),j.YoLog.trace("advertStart"),this.getReportsManager().raiseAdvertCallback("start",n,this),n&&n.isActive()&&(this.fireImpressionReport(),this.signalTimelineTrackingEvents(js.Constant.ADVERT_START_TIMESLOT)))},e.handlePostSeek=function(n){var a=this.getLastPlayed();j.YoLog.d(j.DebugFlags.DEBUG_STATE_MACHINE,"handlePostSeek: "+a+" -> "+n);var o=n-a;o>=0&&o<=Ji?j.YoLog.d(j.DebugFlags.DEBUG_STATE_MACHINE,"handlePostSeek: ignoring interval "+o+"ms"):this.getCurrentAdBreak()?this.handlePostSeekForAdBreak(a,n):this.handlePostSeekForContent(n)},e.handlePostSeekForContent=function(n){var a=this.adBreakForPlayhead(n);if(a){j.YoLog.d(j.DebugFlags.DEBUG_STATE_MACHINE,"handlePostSeek: CONTENT -> BREAK");var o=a.getAdvertFromPlayhead(n);o&&n-o.getStart()>Ji&&o.setInactive()}else j.YoLog.d(j.DebugFlags.DEBUG_STATE_MACHINE,"handlePostSeek: within content")},e.handlePostSeekForAdBreak=function(n,a){var o=this.adBreakForPlayhead(a);if(o)if(o!==this.getCurrentAdBreak()){j.YoLog.d(j.DebugFlags.DEBUG_STATE_MACHINE,"handlePostSeek: BREAK -> BREAK");var c=this.getCurrentAdBreak().getAdvertFromPlayhead(n);c&&c.setInactive();var d=o.getAdvertFromPlayhead(a);d&&a-d.getStart()>Ji&&d.setInactive()}else this.handlePostSeekForAdvertToAdvert(a);else{j.YoLog.d(j.DebugFlags.DEBUG_STATE_MACHINE,"handlePostSeek: BREAK -> CONTENT");var s=this.getCurrentAdBreak().getAdvertFromPlayhead(n);s&&s.setInactive()}},e.handlePostSeekForAdvertToAdvert=function(n){var a=this.getCurrentAdBreak().getAdvertFromPlayhead(n);a&&(this.getCurrentAdvert().setInactive(),a!==this.getCurrentAdvert()?(j.YoLog.d(j.DebugFlags.DEBUG_STATE_MACHINE,"handlePostSeek: ADVERT -> ADVERT"),n-a.getStart()>Ji&&a.setInactive()):j.YoLog.d(j.DebugFlags.DEBUG_STATE_MACHINE,"handlePostSeek: with advert"))},e.handleHeartbeat=function(n){j.YoLog.d(j.DebugFlags.DEBUG_STATE_MACHINE,"handleHeartbeat (playhead: "+n+")"),this.didSeek&&(this.handlePostSeek(n),this.didSeek=!1);var a=this.getLastPlayed();this.setPlayhead(n),this.getCurrentAdBreak()?this.handleHeartbeatForAdbreak(n):this.handleHeartbeatForContent(a,n)},e.handleHeartbeatForContent=function(n,a){var o=this.missedOpportunityBreak(n,a);if(o){var s=new Va.ReportingParams(this.getPlayhead());this.getReportsManager().fireBeacon(o.getTrackingReport("breakStart",!0),s),this.getReportsManager().fireBeacon(o.getTrackingReport("breakEnd",!0),s),this.linearAdBreaks.indexOf(o)!==-1&&this.linearAdBreaks.splice(this.linearAdBreaks.indexOf(o),1)}var c=this.adBreakForPlayhead(a);if(c){j.YoLog.d(j.DebugFlags.DEBUG_STATE_MACHINE,"CONTENT -> BREAK (playhead: "+a+")"),this.onAdvertBreakStart(c);var d=c.getAdvertFromPlayhead(a);d&&this.onAdvertStart(d)}},e.handleHeartbeatForAdbreak=function(n){var a=this.adBreakForPlayhead(n);if(!a)j.YoLog.d(j.DebugFlags.DEBUG_STATE_MACHINE,"BREAK -> CONTENT"),this.onAdvertEnd(),this.onAdvertBreakEnd();else if(a!==this.getCurrentAdBreak()){j.YoLog.d(j.DebugFlags.DEBUG_STATE_MACHINE,"BREAK -> BREAK"),this.onAdvertEnd(),this.onAdvertBreakEnd(),this.onAdvertBreakStart(a);var o=a.getAdvertFromPlayhead(n);o&&this.onAdvertStart(o)}else this.handleHeartbeatForAdvertToAdvert(n)},e.handleHeartbeatForAdvertToAdvert=function(n){var a=this.getCurrentAdBreak().getAdvertFromPlayhead(n);if(a)if(a!==this.getCurrentAdvert())j.YoLog.d(j.DebugFlags.DEBUG_STATE_MACHINE,"ADVERT -> ADVERT"),this.onAdvertEnd(),this.onAdvertStart(a);else{var o=Math.max(n-this.getCurrentAdvert().getStart(),0);this.signalTimelineTrackingEvents(o)}},e.adBreakForPlayhead=function(n){for(var a=Qi(this.linearAdBreaks),o;!(o=a()).done;){var s=o.value;if(s.getStart()<=n&&n<s.getStart()+s.getDuration())return s}return null},e.missedOpportunityBreak=function(n,a){for(var o=Qi(this.linearAdBreaks),s;!(s=o()).done;){var c=s.value;if(c.getDuration()===0){var d=c.getStart();if(n<=d&&a>=d)return c}}return null},e.onPlaybackStart=function(n){t.prototype.onPlaybackStart.call(this,n),this.handleHeartbeat(n)},e.setAdBreaksInactivePriorTo=function(n){for(var a=Qi(this.linearAdBreaks),o;!(o=a()).done;){var s=o.value;if(!s.setAdvertsInactivePriorTo(n))break}},i}(qs.Session);Zi.SessionSeekable=pp});var Ha=D(en=>{"use strict";en.__esModule=!0;en.PlaylistPayload=void 0;var Br=Ne(),gp=function(){function t(e,r){this.sessionIdentifier=e.get(Br.Payload.IDENTIFIER),this.location=e.get(Br.Payload.LOCATION),this.analyticUrl=e.get(Br.Payload.ANALYTICURL),this.pauseUrl=e.get(Br.Payload.PAUSEURL),this.availabilityStartTime=e.get(Br.Payload.AVAILABILITYSTART)||null,this.interSegmentTimeout=r}var i=t.prototype;return i.getAnalyticUrl=function(){return this.analyticUrl},i.getIntersegmentTimeout=function(){return this.interSegmentTimeout},i.getPlaybackUrl=function(){return this.location},i.getPauseUrl=function(){return this.pauseUrl},i.getSessionIdentifier=function(){return this.sessionIdentifier},i.getAvailabilityStartTime=function(){return this.availabilityStartTime},t}();en.PlaylistPayload=gp});var zs=D(tn=>{"use strict";tn.byteLength=yp;tn.toByteArray=Ep;tn.fromByteArray=Sp;var nt=[],Ye=[],vp=typeof Uint8Array!="undefined"?Uint8Array:Array,qa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(Nt=0,Ws=qa.length;Nt<Ws;++Nt)nt[Nt]=qa[Nt],Ye[qa.charCodeAt(Nt)]=Nt;var Nt,Ws;Ye[45]=62;Ye[95]=63;function Ks(t){var i=t.length;if(i%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var e=t.indexOf("=");e===-1&&(e=i);var r=e===i?0:4-e%4;return[e,r]}function yp(t){var i=Ks(t),e=i[0],r=i[1];return(e+r)*3/4-r}function mp(t,i,e){return(i+e)*3/4-e}function Ep(t){var i,e=Ks(t),r=e[0],n=e[1],a=new vp(mp(t,r,n)),o=0,s=n>0?r-4:r,c;for(c=0;c<s;c+=4)i=Ye[t.charCodeAt(c)]<<18|Ye[t.charCodeAt(c+1)]<<12|Ye[t.charCodeAt(c+2)]<<6|Ye[t.charCodeAt(c+3)],a[o++]=i>>16&255,a[o++]=i>>8&255,a[o++]=i&255;return n===2&&(i=Ye[t.charCodeAt(c)]<<2|Ye[t.charCodeAt(c+1)]>>4,a[o++]=i&255),n===1&&(i=Ye[t.charCodeAt(c)]<<10|Ye[t.charCodeAt(c+1)]<<4|Ye[t.charCodeAt(c+2)]>>2,a[o++]=i>>8&255,a[o++]=i&255),a}function Ap(t){return nt[t>>18&63]+nt[t>>12&63]+nt[t>>6&63]+nt[t&63]}function Tp(t,i,e){for(var r,n=[],a=i;a<e;a+=3)r=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(t[a+2]&255),n.push(Ap(r));return n.join("")}function Sp(t){for(var i,e=t.length,r=e%3,n=[],a=16383,o=0,s=e-r;o<s;o+=a)n.push(Tp(t,o,o+a>s?s:o+a));return r===1?(i=t[e-1],n.push(nt[i>>2]+nt[i<<4&63]+"==")):r===2&&(i=(t[e-2]<<8)+t[e-1],n.push(nt[i>>10]+nt[i>>4&63]+nt[i<<2&63]+"=")),n.join("")}});var Xs=D(Ga=>{Ga.read=function(t,i,e,r,n){var a,o,s=n*8-r-1,c=(1<<s)-1,d=c>>1,p=-7,f=e?n-1:0,w=e?-1:1,B=t[i+f];for(f+=w,a=B&(1<<-p)-1,B>>=-p,p+=s;p>0;a=a*256+t[i+f],f+=w,p-=8);for(o=a&(1<<-p)-1,a>>=-p,p+=r;p>0;o=o*256+t[i+f],f+=w,p-=8);if(a===0)a=1-d;else{if(a===c)return o?NaN:(B?-1:1)*(1/0);o=o+Math.pow(2,r),a=a-d}return(B?-1:1)*o*Math.pow(2,a-r)};Ga.write=function(t,i,e,r,n,a){var o,s,c,d=a*8-n-1,p=(1<<d)-1,f=p>>1,w=n===23?Math.pow(2,-24)-Math.pow(2,-77):0,B=r?0:a-1,_=r?1:-1,G=i<0||i===0&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(s=isNaN(i)?1:0,o=p):(o=Math.floor(Math.log(i)/Math.LN2),i*(c=Math.pow(2,-o))<1&&(o--,c*=2),o+f>=1?i+=w/c:i+=w*Math.pow(2,1-f),i*c>=2&&(o++,c/=2),o+f>=p?(s=0,o=p):o+f>=1?(s=(i*c-1)*Math.pow(2,n),o=o+f):(s=i*Math.pow(2,f-1)*Math.pow(2,n),o=0));n>=8;t[e+B]=s&255,B+=_,s/=256,n-=8);for(o=o<<n|s,d+=n;d>0;t[e+B]=o&255,B+=_,o/=256,d-=8);t[e+B-_]|=G*128}});var hl=D(nr=>{"use strict";var ja=zs(),rr=Xs(),$s=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;nr.Buffer=E;nr.SlowBuffer=Lp;nr.INSPECT_MAX_BYTES=50;var rn=2147483647;nr.kMaxLength=rn;E.TYPED_ARRAY_SUPPORT=bp();!E.TYPED_ARRAY_SUPPORT&&typeof console!="undefined"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function bp(){try{let t=new Uint8Array(1),i={foo:function(){return 42}};return Object.setPrototypeOf(i,Uint8Array.prototype),Object.setPrototypeOf(t,i),t.foo()===42}catch(t){return!1}}Object.defineProperty(E.prototype,"parent",{enumerable:!0,get:function(){if(E.isBuffer(this))return this.buffer}});Object.defineProperty(E.prototype,"offset",{enumerable:!0,get:function(){if(E.isBuffer(this))return this.byteOffset}});function ft(t){if(t>rn)throw new RangeError('The value "'+t+'" is invalid for option "size"');let i=new Uint8Array(t);return Object.setPrototypeOf(i,E.prototype),i}function E(t,i,e){if(typeof t=="number"){if(typeof i=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return Xa(t)}return el(t,i,e)}E.poolSize=8192;function el(t,i,e){if(typeof t=="string")return Ip(t,i);if(ArrayBuffer.isView(t))return Pp(t);if(t==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(at(t,ArrayBuffer)||t&&at(t.buffer,ArrayBuffer)||typeof SharedArrayBuffer!="undefined"&&(at(t,SharedArrayBuffer)||t&&at(t.buffer,SharedArrayBuffer)))return Ka(t,i,e);if(typeof t=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let r=t.valueOf&&t.valueOf();if(r!=null&&r!==t)return E.from(r,i,e);let n=_p(t);if(n)return n;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof t[Symbol.toPrimitive]=="function")return E.from(t[Symbol.toPrimitive]("string"),i,e);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}E.from=function(t,i,e){return el(t,i,e)};Object.setPrototypeOf(E.prototype,Uint8Array.prototype);Object.setPrototypeOf(E,Uint8Array);function tl(t){if(typeof t!="number")throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function kp(t,i,e){return tl(t),t<=0?ft(t):i!==void 0?typeof e=="string"?ft(t).fill(i,e):ft(t).fill(i):ft(t)}E.alloc=function(t,i,e){return kp(t,i,e)};function Xa(t){return tl(t),ft(t<0?0:$a(t)|0)}E.allocUnsafe=function(t){return Xa(t)};E.allocUnsafeSlow=function(t){return Xa(t)};function Ip(t,i){if((typeof i!="string"||i==="")&&(i="utf8"),!E.isEncoding(i))throw new TypeError("Unknown encoding: "+i);let e=rl(t,i)|0,r=ft(e),n=r.write(t,i);return n!==e&&(r=r.slice(0,n)),r}function Wa(t){let i=t.length<0?0:$a(t.length)|0,e=ft(i);for(let r=0;r<i;r+=1)e[r]=t[r]&255;return e}function Pp(t){if(at(t,Uint8Array)){let i=new Uint8Array(t);return Ka(i.buffer,i.byteOffset,i.byteLength)}return Wa(t)}function Ka(t,i,e){if(i<0||t.byteLength<i)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<i+(e||0))throw new RangeError('"length" is outside of buffer bounds');let r;return i===void 0&&e===void 0?r=new Uint8Array(t):e===void 0?r=new Uint8Array(t,i):r=new Uint8Array(t,i,e),Object.setPrototypeOf(r,E.prototype),r}function _p(t){if(E.isBuffer(t)){let i=$a(t.length)|0,e=ft(i);return e.length===0||t.copy(e,0,0,i),e}if(t.length!==void 0)return typeof t.length!="number"||Ja(t.length)?ft(0):Wa(t);if(t.type==="Buffer"&&Array.isArray(t.data))return Wa(t.data)}function $a(t){if(t>=rn)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+rn.toString(16)+" bytes");return t|0}function Lp(t){return+t!=t&&(t=0),E.alloc(+t)}E.isBuffer=function(i){return i!=null&&i._isBuffer===!0&&i!==E.prototype};E.compare=function(i,e){if(at(i,Uint8Array)&&(i=E.from(i,i.offset,i.byteLength)),at(e,Uint8Array)&&(e=E.from(e,e.offset,e.byteLength)),!E.isBuffer(i)||!E.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(i===e)return 0;let r=i.length,n=e.length;for(let a=0,o=Math.min(r,n);a<o;++a)if(i[a]!==e[a]){r=i[a],n=e[a];break}return r<n?-1:n<r?1:0};E.isEncoding=function(i){switch(String(i).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};E.concat=function(i,e){if(!Array.isArray(i))throw new TypeError('"list" argument must be an Array of Buffers');if(i.length===0)return E.alloc(0);let r;if(e===void 0)for(e=0,r=0;r<i.length;++r)e+=i[r].length;let n=E.allocUnsafe(e),a=0;for(r=0;r<i.length;++r){let o=i[r];if(at(o,Uint8Array))a+o.length>n.length?(E.isBuffer(o)||(o=E.from(o)),o.copy(n,a)):Uint8Array.prototype.set.call(n,o,a);else if(E.isBuffer(o))o.copy(n,a);else throw new TypeError('"list" argument must be an Array of Buffers');a+=o.length}return n};function rl(t,i){if(E.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||at(t,ArrayBuffer))return t.byteLength;if(typeof t!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);let e=t.length,r=arguments.length>2&&arguments[2]===!0;if(!r&&e===0)return 0;let n=!1;for(;;)switch(i){case"ascii":case"latin1":case"binary":return e;case"utf8":case"utf-8":return za(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return e*2;case"hex":return e>>>1;case"base64":return dl(t).length;default:if(n)return r?-1:za(t).length;i=(""+i).toLowerCase(),n=!0}}E.byteLength=rl;function wp(t,i,e){let r=!1;if((i===void 0||i<0)&&(i=0),i>this.length||((e===void 0||e>this.length)&&(e=this.length),e<=0)||(e>>>=0,i>>>=0,e<=i))return"";for(t||(t="utf8");;)switch(t){case"hex":return Vp(this,i,e);case"utf8":case"utf-8":return nl(this,i,e);case"ascii":return Up(this,i,e);case"latin1":case"binary":return Fp(this,i,e);case"base64":return Mp(this,i,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return xp(this,i,e);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}E.prototype._isBuffer=!0;function Ot(t,i,e){let r=t[i];t[i]=t[e],t[e]=r}E.prototype.swap16=function(){let i=this.length;if(i%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<i;e+=2)Ot(this,e,e+1);return this};E.prototype.swap32=function(){let i=this.length;if(i%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<i;e+=4)Ot(this,e,e+3),Ot(this,e+1,e+2);return this};E.prototype.swap64=function(){let i=this.length;if(i%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<i;e+=8)Ot(this,e,e+7),Ot(this,e+1,e+6),Ot(this,e+2,e+5),Ot(this,e+3,e+4);return this};E.prototype.toString=function(){let i=this.length;return i===0?"":arguments.length===0?nl(this,0,i):wp.apply(this,arguments)};E.prototype.toLocaleString=E.prototype.toString;E.prototype.equals=function(i){if(!E.isBuffer(i))throw new TypeError("Argument must be a Buffer");return this===i?!0:E.compare(this,i)===0};E.prototype.inspect=function(){let i="",e=nr.INSPECT_MAX_BYTES;return i=this.toString("hex",0,e).replace(/(.{2})/g,"$1 ").trim(),this.length>e&&(i+=" ... "),"<Buffer "+i+">"};$s&&(E.prototype[$s]=E.prototype.inspect);E.prototype.compare=function(i,e,r,n,a){if(at(i,Uint8Array)&&(i=E.from(i,i.offset,i.byteLength)),!E.isBuffer(i))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof i);if(e===void 0&&(e=0),r===void 0&&(r=i?i.length:0),n===void 0&&(n=0),a===void 0&&(a=this.length),e<0||r>i.length||n<0||a>this.length)throw new RangeError("out of range index");if(n>=a&&e>=r)return 0;if(n>=a)return-1;if(e>=r)return 1;if(e>>>=0,r>>>=0,n>>>=0,a>>>=0,this===i)return 0;let o=a-n,s=r-e,c=Math.min(o,s),d=this.slice(n,a),p=i.slice(e,r);for(let f=0;f<c;++f)if(d[f]!==p[f]){o=d[f],s=p[f];break}return o<s?-1:s<o?1:0};function il(t,i,e,r,n){if(t.length===0)return-1;if(typeof e=="string"?(r=e,e=0):e>2147483647?e=2147483647:e<-2147483648&&(e=-2147483648),e=+e,Ja(e)&&(e=n?0:t.length-1),e<0&&(e=t.length+e),e>=t.length){if(n)return-1;e=t.length-1}else if(e<0)if(n)e=0;else return-1;if(typeof i=="string"&&(i=E.from(i,r)),E.isBuffer(i))return i.length===0?-1:Qs(t,i,e,r,n);if(typeof i=="number")return i=i&255,typeof Uint8Array.prototype.indexOf=="function"?n?Uint8Array.prototype.indexOf.call(t,i,e):Uint8Array.prototype.lastIndexOf.call(t,i,e):Qs(t,[i],e,r,n);throw new TypeError("val must be string, number or Buffer")}function Qs(t,i,e,r,n){let a=1,o=t.length,s=i.length;if(r!==void 0&&(r=String(r).toLowerCase(),r==="ucs2"||r==="ucs-2"||r==="utf16le"||r==="utf-16le")){if(t.length<2||i.length<2)return-1;a=2,o/=2,s/=2,e/=2}function c(p,f){return a===1?p[f]:p.readUInt16BE(f*a)}let d;if(n){let p=-1;for(d=e;d<o;d++)if(c(t,d)===c(i,p===-1?0:d-p)){if(p===-1&&(p=d),d-p+1===s)return p*a}else p!==-1&&(d-=d-p),p=-1}else for(e+s>o&&(e=o-s),d=e;d>=0;d--){let p=!0;for(let f=0;f<s;f++)if(c(t,d+f)!==c(i,f)){p=!1;break}if(p)return d}return-1}E.prototype.includes=function(i,e,r){return this.indexOf(i,e,r)!==-1};E.prototype.indexOf=function(i,e,r){return il(this,i,e,r,!0)};E.prototype.lastIndexOf=function(i,e,r){return il(this,i,e,r,!1)};function Cp(t,i,e,r){e=Number(e)||0;let n=t.length-e;r?(r=Number(r),r>n&&(r=n)):r=n;let a=i.length;r>a/2&&(r=a/2);let o;for(o=0;o<r;++o){let s=parseInt(i.substr(o*2,2),16);if(Ja(s))return o;t[e+o]=s}return o}function Dp(t,i,e,r){return nn(za(i,t.length-e),t,e,r)}function Rp(t,i,e,r){return nn(Gp(i),t,e,r)}function Np(t,i,e,r){return nn(dl(i),t,e,r)}function Op(t,i,e,r){return nn(jp(i,t.length-e),t,e,r)}E.prototype.write=function(i,e,r,n){if(e===void 0)n="utf8",r=this.length,e=0;else if(r===void 0&&typeof e=="string")n=e,r=this.length,e=0;else if(isFinite(e))e=e>>>0,isFinite(r)?(r=r>>>0,n===void 0&&(n="utf8")):(n=r,r=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let a=this.length-e;if((r===void 0||r>a)&&(r=a),i.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let o=!1;for(;;)switch(n){case"hex":return Cp(this,i,e,r);case"utf8":case"utf-8":return Dp(this,i,e,r);case"ascii":case"latin1":case"binary":return Rp(this,i,e,r);case"base64":return Np(this,i,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Op(this,i,e,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}};E.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Mp(t,i,e){return i===0&&e===t.length?ja.fromByteArray(t):ja.fromByteArray(t.slice(i,e))}function nl(t,i,e){e=Math.min(t.length,e);let r=[],n=i;for(;n<e;){let a=t[n],o=null,s=a>239?4:a>223?3:a>191?2:1;if(n+s<=e){let c,d,p,f;switch(s){case 1:a<128&&(o=a);break;case 2:c=t[n+1],(c&192)===128&&(f=(a&31)<<6|c&63,f>127&&(o=f));break;case 3:c=t[n+1],d=t[n+2],(c&192)===128&&(d&192)===128&&(f=(a&15)<<12|(c&63)<<6|d&63,f>2047&&(f<55296||f>57343)&&(o=f));break;case 4:c=t[n+1],d=t[n+2],p=t[n+3],(c&192)===128&&(d&192)===128&&(p&192)===128&&(f=(a&15)<<18|(c&63)<<12|(d&63)<<6|p&63,f>65535&&f<1114112&&(o=f))}}o===null?(o=65533,s=1):o>65535&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|o&1023),r.push(o),n+=s}return Bp(r)}var Js=4096;function Bp(t){let i=t.length;if(i<=Js)return String.fromCharCode.apply(String,t);let e="",r=0;for(;r<i;)e+=String.fromCharCode.apply(String,t.slice(r,r+=Js));return e}function Up(t,i,e){let r="";e=Math.min(t.length,e);for(let n=i;n<e;++n)r+=String.fromCharCode(t[n]&127);return r}function Fp(t,i,e){let r="";e=Math.min(t.length,e);for(let n=i;n<e;++n)r+=String.fromCharCode(t[n]);return r}function Vp(t,i,e){let r=t.length;(!i||i<0)&&(i=0),(!e||e<0||e>r)&&(e=r);let n="";for(let a=i;a<e;++a)n+=Wp[t[a]];return n}function xp(t,i,e){let r=t.slice(i,e),n="";for(let a=0;a<r.length-1;a+=2)n+=String.fromCharCode(r[a]+r[a+1]*256);return n}E.prototype.slice=function(i,e){let r=this.length;i=~~i,e=e===void 0?r:~~e,i<0?(i+=r,i<0&&(i=0)):i>r&&(i=r),e<0?(e+=r,e<0&&(e=0)):e>r&&(e=r),e<i&&(e=i);let n=this.subarray(i,e);return Object.setPrototypeOf(n,E.prototype),n};function ge(t,i,e){if(t%1!==0||t<0)throw new RangeError("offset is not uint");if(t+i>e)throw new RangeError("Trying to access beyond buffer length")}E.prototype.readUintLE=E.prototype.readUIntLE=function(i,e,r){i=i>>>0,e=e>>>0,r||ge(i,e,this.length);let n=this[i],a=1,o=0;for(;++o<e&&(a*=256);)n+=this[i+o]*a;return n};E.prototype.readUintBE=E.prototype.readUIntBE=function(i,e,r){i=i>>>0,e=e>>>0,r||ge(i,e,this.length);let n=this[i+--e],a=1;for(;e>0&&(a*=256);)n+=this[i+--e]*a;return n};E.prototype.readUint8=E.prototype.readUInt8=function(i,e){return i=i>>>0,e||ge(i,1,this.length),this[i]};E.prototype.readUint16LE=E.prototype.readUInt16LE=function(i,e){return i=i>>>0,e||ge(i,2,this.length),this[i]|this[i+1]<<8};E.prototype.readUint16BE=E.prototype.readUInt16BE=function(i,e){return i=i>>>0,e||ge(i,2,this.length),this[i]<<8|this[i+1]};E.prototype.readUint32LE=E.prototype.readUInt32LE=function(i,e){return i=i>>>0,e||ge(i,4,this.length),(this[i]|this[i+1]<<8|this[i+2]<<16)+this[i+3]*16777216};E.prototype.readUint32BE=E.prototype.readUInt32BE=function(i,e){return i=i>>>0,e||ge(i,4,this.length),this[i]*16777216+(this[i+1]<<16|this[i+2]<<8|this[i+3])};E.prototype.readBigUInt64LE=At(function(i){i=i>>>0,ir(i,"offset");let e=this[i],r=this[i+7];(e===void 0||r===void 0)&&Ur(i,this.length-8);let n=e+this[++i]*2**8+this[++i]*2**16+this[++i]*2**24,a=this[++i]+this[++i]*2**8+this[++i]*2**16+r*2**24;return BigInt(n)+(BigInt(a)<<BigInt(32))});E.prototype.readBigUInt64BE=At(function(i){i=i>>>0,ir(i,"offset");let e=this[i],r=this[i+7];(e===void 0||r===void 0)&&Ur(i,this.length-8);let n=e*2**24+this[++i]*2**16+this[++i]*2**8+this[++i],a=this[++i]*2**24+this[++i]*2**16+this[++i]*2**8+r;return(BigInt(n)<<BigInt(32))+BigInt(a)});E.prototype.readIntLE=function(i,e,r){i=i>>>0,e=e>>>0,r||ge(i,e,this.length);let n=this[i],a=1,o=0;for(;++o<e&&(a*=256);)n+=this[i+o]*a;return a*=128,n>=a&&(n-=Math.pow(2,8*e)),n};E.prototype.readIntBE=function(i,e,r){i=i>>>0,e=e>>>0,r||ge(i,e,this.length);let n=e,a=1,o=this[i+--n];for(;n>0&&(a*=256);)o+=this[i+--n]*a;return a*=128,o>=a&&(o-=Math.pow(2,8*e)),o};E.prototype.readInt8=function(i,e){return i=i>>>0,e||ge(i,1,this.length),this[i]&128?(255-this[i]+1)*-1:this[i]};E.prototype.readInt16LE=function(i,e){i=i>>>0,e||ge(i,2,this.length);let r=this[i]|this[i+1]<<8;return r&32768?r|4294901760:r};E.prototype.readInt16BE=function(i,e){i=i>>>0,e||ge(i,2,this.length);let r=this[i+1]|this[i]<<8;return r&32768?r|4294901760:r};E.prototype.readInt32LE=function(i,e){return i=i>>>0,e||ge(i,4,this.length),this[i]|this[i+1]<<8|this[i+2]<<16|this[i+3]<<24};E.prototype.readInt32BE=function(i,e){return i=i>>>0,e||ge(i,4,this.length),this[i]<<24|this[i+1]<<16|this[i+2]<<8|this[i+3]};E.prototype.readBigInt64LE=At(function(i){i=i>>>0,ir(i,"offset");let e=this[i],r=this[i+7];(e===void 0||r===void 0)&&Ur(i,this.length-8);let n=this[i+4]+this[i+5]*2**8+this[i+6]*2**16+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(e+this[++i]*2**8+this[++i]*2**16+this[++i]*2**24)});E.prototype.readBigInt64BE=At(function(i){i=i>>>0,ir(i,"offset");let e=this[i],r=this[i+7];(e===void 0||r===void 0)&&Ur(i,this.length-8);let n=(e<<24)+this[++i]*2**16+this[++i]*2**8+this[++i];return(BigInt(n)<<BigInt(32))+BigInt(this[++i]*2**24+this[++i]*2**16+this[++i]*2**8+r)});E.prototype.readFloatLE=function(i,e){return i=i>>>0,e||ge(i,4,this.length),rr.read(this,i,!0,23,4)};E.prototype.readFloatBE=function(i,e){return i=i>>>0,e||ge(i,4,this.length),rr.read(this,i,!1,23,4)};E.prototype.readDoubleLE=function(i,e){return i=i>>>0,e||ge(i,8,this.length),rr.read(this,i,!0,52,8)};E.prototype.readDoubleBE=function(i,e){return i=i>>>0,e||ge(i,8,this.length),rr.read(this,i,!1,52,8)};function we(t,i,e,r,n,a){if(!E.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(i>n||i<a)throw new RangeError('"value" argument is out of bounds');if(e+r>t.length)throw new RangeError("Index out of range")}E.prototype.writeUintLE=E.prototype.writeUIntLE=function(i,e,r,n){if(i=+i,e=e>>>0,r=r>>>0,!n){let s=Math.pow(2,8*r)-1;we(this,i,e,r,s,0)}let a=1,o=0;for(this[e]=i&255;++o<r&&(a*=256);)this[e+o]=i/a&255;return e+r};E.prototype.writeUintBE=E.prototype.writeUIntBE=function(i,e,r,n){if(i=+i,e=e>>>0,r=r>>>0,!n){let s=Math.pow(2,8*r)-1;we(this,i,e,r,s,0)}let a=r-1,o=1;for(this[e+a]=i&255;--a>=0&&(o*=256);)this[e+a]=i/o&255;return e+r};E.prototype.writeUint8=E.prototype.writeUInt8=function(i,e,r){return i=+i,e=e>>>0,r||we(this,i,e,1,255,0),this[e]=i&255,e+1};E.prototype.writeUint16LE=E.prototype.writeUInt16LE=function(i,e,r){return i=+i,e=e>>>0,r||we(this,i,e,2,65535,0),this[e]=i&255,this[e+1]=i>>>8,e+2};E.prototype.writeUint16BE=E.prototype.writeUInt16BE=function(i,e,r){return i=+i,e=e>>>0,r||we(this,i,e,2,65535,0),this[e]=i>>>8,this[e+1]=i&255,e+2};E.prototype.writeUint32LE=E.prototype.writeUInt32LE=function(i,e,r){return i=+i,e=e>>>0,r||we(this,i,e,4,4294967295,0),this[e+3]=i>>>24,this[e+2]=i>>>16,this[e+1]=i>>>8,this[e]=i&255,e+4};E.prototype.writeUint32BE=E.prototype.writeUInt32BE=function(i,e,r){return i=+i,e=e>>>0,r||we(this,i,e,4,4294967295,0),this[e]=i>>>24,this[e+1]=i>>>16,this[e+2]=i>>>8,this[e+3]=i&255,e+4};function al(t,i,e,r,n){ul(i,r,n,t,e,7);let a=Number(i&BigInt(4294967295));t[e++]=a,a=a>>8,t[e++]=a,a=a>>8,t[e++]=a,a=a>>8,t[e++]=a;let o=Number(i>>BigInt(32)&BigInt(4294967295));return t[e++]=o,o=o>>8,t[e++]=o,o=o>>8,t[e++]=o,o=o>>8,t[e++]=o,e}function ol(t,i,e,r,n){ul(i,r,n,t,e,7);let a=Number(i&BigInt(4294967295));t[e+7]=a,a=a>>8,t[e+6]=a,a=a>>8,t[e+5]=a,a=a>>8,t[e+4]=a;let o=Number(i>>BigInt(32)&BigInt(4294967295));return t[e+3]=o,o=o>>8,t[e+2]=o,o=o>>8,t[e+1]=o,o=o>>8,t[e]=o,e+8}E.prototype.writeBigUInt64LE=At(function(i,e=0){return al(this,i,e,BigInt(0),BigInt("0xffffffffffffffff"))});E.prototype.writeBigUInt64BE=At(function(i,e=0){return ol(this,i,e,BigInt(0),BigInt("0xffffffffffffffff"))});E.prototype.writeIntLE=function(i,e,r,n){if(i=+i,e=e>>>0,!n){let c=Math.pow(2,8*r-1);we(this,i,e,r,c-1,-c)}let a=0,o=1,s=0;for(this[e]=i&255;++a<r&&(o*=256);)i<0&&s===0&&this[e+a-1]!==0&&(s=1),this[e+a]=(i/o>>0)-s&255;return e+r};E.prototype.writeIntBE=function(i,e,r,n){if(i=+i,e=e>>>0,!n){let c=Math.pow(2,8*r-1);we(this,i,e,r,c-1,-c)}let a=r-1,o=1,s=0;for(this[e+a]=i&255;--a>=0&&(o*=256);)i<0&&s===0&&this[e+a+1]!==0&&(s=1),this[e+a]=(i/o>>0)-s&255;return e+r};E.prototype.writeInt8=function(i,e,r){return i=+i,e=e>>>0,r||we(this,i,e,1,127,-128),i<0&&(i=255+i+1),this[e]=i&255,e+1};E.prototype.writeInt16LE=function(i,e,r){return i=+i,e=e>>>0,r||we(this,i,e,2,32767,-32768),this[e]=i&255,this[e+1]=i>>>8,e+2};E.prototype.writeInt16BE=function(i,e,r){return i=+i,e=e>>>0,r||we(this,i,e,2,32767,-32768),this[e]=i>>>8,this[e+1]=i&255,e+2};E.prototype.writeInt32LE=function(i,e,r){return i=+i,e=e>>>0,r||we(this,i,e,4,2147483647,-2147483648),this[e]=i&255,this[e+1]=i>>>8,this[e+2]=i>>>16,this[e+3]=i>>>24,e+4};E.prototype.writeInt32BE=function(i,e,r){return i=+i,e=e>>>0,r||we(this,i,e,4,2147483647,-2147483648),i<0&&(i=4294967295+i+1),this[e]=i>>>24,this[e+1]=i>>>16,this[e+2]=i>>>8,this[e+3]=i&255,e+4};E.prototype.writeBigInt64LE=At(function(i,e=0){return al(this,i,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});E.prototype.writeBigInt64BE=At(function(i,e=0){return ol(this,i,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function sl(t,i,e,r,n,a){if(e+r>t.length)throw new RangeError("Index out of range");if(e<0)throw new RangeError("Index out of range")}function ll(t,i,e,r,n){return i=+i,e=e>>>0,n||sl(t,i,e,4,34028234663852886e22,-34028234663852886e22),rr.write(t,i,e,r,23,4),e+4}E.prototype.writeFloatLE=function(i,e,r){return ll(this,i,e,!0,r)};E.prototype.writeFloatBE=function(i,e,r){return ll(this,i,e,!1,r)};function cl(t,i,e,r,n){return i=+i,e=e>>>0,n||sl(t,i,e,8,17976931348623157e292,-17976931348623157e292),rr.write(t,i,e,r,52,8),e+8}E.prototype.writeDoubleLE=function(i,e,r){return cl(this,i,e,!0,r)};E.prototype.writeDoubleBE=function(i,e,r){return cl(this,i,e,!1,r)};E.prototype.copy=function(i,e,r,n){if(!E.isBuffer(i))throw new TypeError("argument should be a Buffer");if(r||(r=0),!n&&n!==0&&(n=this.length),e>=i.length&&(e=i.length),e||(e=0),n>0&&n<r&&(n=r),n===r||i.length===0||this.length===0)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),i.length-e<n-r&&(n=i.length-e+r);let a=n-r;return this===i&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(e,r,n):Uint8Array.prototype.set.call(i,this.subarray(r,n),e),a};E.prototype.fill=function(i,e,r,n){if(typeof i=="string"){if(typeof e=="string"?(n=e,e=0,r=this.length):typeof r=="string"&&(n=r,r=this.length),n!==void 0&&typeof n!="string")throw new TypeError("encoding must be a string");if(typeof n=="string"&&!E.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(i.length===1){let o=i.charCodeAt(0);(n==="utf8"&&o<128||n==="latin1")&&(i=o)}}else typeof i=="number"?i=i&255:typeof i=="boolean"&&(i=Number(i));if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;e=e>>>0,r=r===void 0?this.length:r>>>0,i||(i=0);let a;if(typeof i=="number")for(a=e;a<r;++a)this[a]=i;else{let o=E.isBuffer(i)?i:E.from(i,n),s=o.length;if(s===0)throw new TypeError('The value "'+i+'" is invalid for argument "value"');for(a=0;a<r-e;++a)this[a+e]=o[a%s]}return this};var tr={};function Qa(t,i,e){tr[t]=class extends e{constructor(){super(),Object.defineProperty(this,"message",{value:i.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(n){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:n,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}Qa("ERR_BUFFER_OUT_OF_BOUNDS",function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError);Qa("ERR_INVALID_ARG_TYPE",function(t,i){return`The "${t}" argument must be of type number. Received type ${typeof i}`},TypeError);Qa("ERR_OUT_OF_RANGE",function(t,i,e){let r=`The value of "${t}" is out of range.`,n=e;return Number.isInteger(e)&&Math.abs(e)>2**32?n=Zs(String(e)):typeof e=="bigint"&&(n=String(e),(e>BigInt(2)**BigInt(32)||e<-(BigInt(2)**BigInt(32)))&&(n=Zs(n)),n+="n"),r+=` It must be ${i}. Received ${n}`,r},RangeError);function Zs(t){let i="",e=t.length,r=t[0]==="-"?1:0;for(;e>=r+4;e-=3)i=`_${t.slice(e-3,e)}${i}`;return`${t.slice(0,e)}${i}`}function Yp(t,i,e){ir(i,"offset"),(t[i]===void 0||t[i+e]===void 0)&&Ur(i,t.length-(e+1))}function ul(t,i,e,r,n,a){if(t>e||t<i){let o=typeof i=="bigint"?"n":"",s;throw a>3?i===0||i===BigInt(0)?s=`>= 0${o} and < 2${o} ** ${(a+1)*8}${o}`:s=`>= -(2${o} ** ${(a+1)*8-1}${o}) and < 2 ** ${(a+1)*8-1}${o}`:s=`>= ${i}${o} and <= ${e}${o}`,new tr.ERR_OUT_OF_RANGE("value",s,t)}Yp(r,n,a)}function ir(t,i){if(typeof t!="number")throw new tr.ERR_INVALID_ARG_TYPE(i,"number",t)}function Ur(t,i,e){throw Math.floor(t)!==t?(ir(t,e),new tr.ERR_OUT_OF_RANGE(e||"offset","an integer",t)):i<0?new tr.ERR_BUFFER_OUT_OF_BOUNDS:new tr.ERR_OUT_OF_RANGE(e||"offset",`>= ${e?1:0} and <= ${i}`,t)}var Hp=/[^+/0-9A-Za-z-_]/g;function qp(t){if(t=t.split("=")[0],t=t.trim().replace(Hp,""),t.length<2)return"";for(;t.length%4!==0;)t=t+"=";return t}function za(t,i){i=i||1/0;let e,r=t.length,n=null,a=[];for(let o=0;o<r;++o){if(e=t.charCodeAt(o),e>55295&&e<57344){if(!n){if(e>56319){(i-=3)>-1&&a.push(239,191,189);continue}else if(o+1===r){(i-=3)>-1&&a.push(239,191,189);continue}n=e;continue}if(e<56320){(i-=3)>-1&&a.push(239,191,189),n=e;continue}e=(n-55296<<10|e-56320)+65536}else n&&(i-=3)>-1&&a.push(239,191,189);if(n=null,e<128){if((i-=1)<0)break;a.push(e)}else if(e<2048){if((i-=2)<0)break;a.push(e>>6|192,e&63|128)}else if(e<65536){if((i-=3)<0)break;a.push(e>>12|224,e>>6&63|128,e&63|128)}else if(e<1114112){if((i-=4)<0)break;a.push(e>>18|240,e>>12&63|128,e>>6&63|128,e&63|128)}else throw new Error("Invalid code point")}return a}function Gp(t){let i=[];for(let e=0;e<t.length;++e)i.push(t.charCodeAt(e)&255);return i}function jp(t,i){let e,r,n,a=[];for(let o=0;o<t.length&&!((i-=2)<0);++o)e=t.charCodeAt(o),r=e>>8,n=e%256,a.push(n),a.push(r);return a}function dl(t){return ja.toByteArray(qp(t))}function nn(t,i,e,r){let n;for(n=0;n<r&&!(n+e>=i.length||n>=t.length);++n)i[n+e]=t[n];return n}function at(t,i){return t instanceof i||t!=null&&t.constructor!=null&&t.constructor.name!=null&&t.constructor.name===i.name}function Ja(t){return t!==t}var Wp=function(){let t="0123456789abcdef",i=new Array(256);for(let e=0;e<16;++e){let r=e*16;for(let n=0;n<16;++n)i[r+n]=t[e]+t[n]}return i}();function At(t){return typeof BigInt=="undefined"?Kp:t}function Kp(){throw new Error("BigInt not supported")}});var gl=D((Za,pl)=>{var an=hl(),ot=an.Buffer;function fl(t,i){for(var e in t)i[e]=t[e]}ot.from&&ot.alloc&&ot.allocUnsafe&&ot.allocUnsafeSlow?pl.exports=an:(fl(an,Za),Za.Buffer=Mt);function Mt(t,i,e){return ot(t,i,e)}Mt.prototype=Object.create(ot.prototype);fl(ot,Mt);Mt.from=function(t,i,e){if(typeof t=="number")throw new TypeError("Argument must not be a number");return ot(t,i,e)};Mt.alloc=function(t,i,e){if(typeof t!="number")throw new TypeError("Argument must be a number");var r=ot(t);return i!==void 0?typeof e=="string"?r.fill(i,e):r.fill(i):r.fill(0),r};Mt.allocUnsafe=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return ot(t)};Mt.allocUnsafeSlow=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return an.SlowBuffer(t)}});var ml=D(yl=>{"use strict";var to=gl().Buffer,vl=to.isEncoding||function(t){switch(t=""+t,t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function zp(t){if(!t)return"utf8";for(var i;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(i)return;t=(""+t).toLowerCase(),i=!0}}function Xp(t){var i=zp(t);if(typeof i!="string"&&(to.isEncoding===vl||!vl(t)))throw new Error("Unknown encoding: "+t);return i||t}yl.StringDecoder=Fr;function Fr(t){this.encoding=Xp(t);var i;switch(this.encoding){case"utf16le":this.text=tg,this.end=rg,i=4;break;case"utf8":this.fillLast=Jp,i=4;break;case"base64":this.text=ig,this.end=ng,i=3;break;default:this.write=ag,this.end=og;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=to.allocUnsafe(i)}Fr.prototype.write=function(t){if(t.length===0)return"";var i,e;if(this.lastNeed){if(i=this.fillLast(t),i===void 0)return"";e=this.lastNeed,this.lastNeed=0}else e=0;return e<t.length?i?i+this.text(t,e):this.text(t,e):i||""};Fr.prototype.end=eg;Fr.prototype.text=Zp;Fr.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length};function eo(t){return t<=127?0:t>>5===6?2:t>>4===14?3:t>>3===30?4:t>>6===2?-1:-2}function $p(t,i,e){var r=i.length-1;if(r<e)return 0;var n=eo(i[r]);return n>=0?(n>0&&(t.lastNeed=n-1),n):--r<e||n===-2?0:(n=eo(i[r]),n>=0?(n>0&&(t.lastNeed=n-2),n):--r<e||n===-2?0:(n=eo(i[r]),n>=0?(n>0&&(n===2?n=0:t.lastNeed=n-3),n):0))}function Qp(t,i,e){if((i[0]&192)!==128)return t.lastNeed=0,"\uFFFD";if(t.lastNeed>1&&i.length>1){if((i[1]&192)!==128)return t.lastNeed=1,"\uFFFD";if(t.lastNeed>2&&i.length>2&&(i[2]&192)!==128)return t.lastNeed=2,"\uFFFD"}}function Jp(t){var i=this.lastTotal-this.lastNeed,e=Qp(this,t,i);if(e!==void 0)return e;if(this.lastNeed<=t.length)return t.copy(this.lastChar,i,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,i,0,t.length),this.lastNeed-=t.length}function Zp(t,i){var e=$p(this,t,i);if(!this.lastNeed)return t.toString("utf8",i);this.lastTotal=e;var r=t.length-(e-this.lastNeed);return t.copy(this.lastChar,0,r),t.toString("utf8",i,r)}function eg(t){var i=t&&t.length?this.write(t):"";return this.lastNeed?i+"\uFFFD":i}function tg(t,i){if((t.length-i)%2===0){var e=t.toString("utf16le",i);if(e){var r=e.charCodeAt(e.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],e.slice(0,-1)}return e}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",i,t.length-1)}function rg(t){var i=t&&t.length?this.write(t):"";if(this.lastNeed){var e=this.lastTotal-this.lastNeed;return i+this.lastChar.toString("utf16le",0,e)}return i}function ig(t,i){var e=(t.length-i)%3;return e===0?t.toString("base64",i):(this.lastNeed=3-e,this.lastTotal=3,e===1?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",i,t.length-e))}function ng(t){var i=t&&t.length?this.write(t):"";return this.lastNeed?i+this.lastChar.toString("base64",0,3-this.lastNeed):i}function ag(t){return t.toString(this.encoding)}function og(t){return t&&t.length?this.write(t):""}});var ro=D(on=>{(function(t){t.parser=function(u,l){return new e(u,l)},t.SAXParser=e,t.SAXStream=d,t.createStream=c,t.MAX_BUFFER_LENGTH=64*1024;var i=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];t.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function e(u,l){if(!(this instanceof e))return new e(u,l);var T=this;n(T),T.q=T.c="",T.bufferCheckPosition=t.MAX_BUFFER_LENGTH,T.opt=l||{},T.opt.lowercase=T.opt.lowercase||T.opt.lowercasetags,T.looseCase=T.opt.lowercase?"toLowerCase":"toUpperCase",T.tags=[],T.closed=T.closedRoot=T.sawRoot=!1,T.tag=T.error=null,T.strict=!!u,T.noscript=!!(u||T.opt.noscript),T.state=y.BEGIN,T.strictEntities=T.opt.strictEntities,T.ENTITIES=T.strictEntities?Object.create(t.XML_ENTITIES):Object.create(t.ENTITIES),T.attribList=[],T.opt.xmlns&&(T.ns=Object.create(_)),T.trackPosition=T.opt.position!==!1,T.trackPosition&&(T.position=T.line=T.column=0),De(T,"onready")}Object.create||(Object.create=function(u){function l(){}l.prototype=u;var T=new l;return T}),Object.keys||(Object.keys=function(u){var l=[];for(var T in u)u.hasOwnProperty(T)&&l.push(T);return l});function r(u){for(var l=Math.max(t.MAX_BUFFER_LENGTH,10),T=0,v=0,W=i.length;v<W;v++){var de=u[i[v]].length;if(de>l)switch(i[v]){case"textNode":m(u);break;case"cdata":Q(u,"oncdata",u.cdata),u.cdata="";break;case"script":Q(u,"onscript",u.script),u.script="";break;default:g(u,"Max buffer length exceeded: "+i[v])}T=Math.max(T,de)}var pe=t.MAX_BUFFER_LENGTH-T;u.bufferCheckPosition=pe+u.position}function n(u){for(var l=0,T=i.length;l<T;l++)u[i[l]]=""}function a(u){m(u),u.cdata!==""&&(Q(u,"oncdata",u.cdata),u.cdata=""),u.script!==""&&(Q(u,"onscript",u.script),u.script="")}e.prototype={end:function(){S(this)},write:Tc,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){a(this)}};var o;try{o=Lc("stream").Stream}catch(u){o=function(){}}var s=t.EVENTS.filter(function(u){return u!=="error"&&u!=="end"});function c(u,l){return new d(u,l)}function d(u,l){if(!(this instanceof d))return new d(u,l);o.apply(this),this._parser=new e(u,l),this.writable=!0,this.readable=!0;var T=this;this._parser.onend=function(){T.emit("end")},this._parser.onerror=function(v){T.emit("error",v),T._parser.error=null},this._decoder=null,s.forEach(function(v){Object.defineProperty(T,"on"+v,{get:function(){return T._parser["on"+v]},set:function(W){if(!W)return T.removeAllListeners(v),T._parser["on"+v]=W,W;T.on(v,W)},enumerable:!0,configurable:!1})})}d.prototype=Object.create(o.prototype,{constructor:{value:d}}),d.prototype.write=function(u){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(u)){if(!this._decoder){var l=ml().StringDecoder;this._decoder=new l("utf8")}u=this._decoder.write(u)}return this._parser.write(u.toString()),this.emit("data",u),!0},d.prototype.end=function(u){return u&&u.length&&this.write(u),this._parser.end(),!0},d.prototype.on=function(u,l){var T=this;return!T._parser["on"+u]&&s.indexOf(u)!==-1&&(T._parser["on"+u]=function(){var v=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);v.splice(0,0,u),T.emit.apply(T,v)}),o.prototype.on.call(T,u,l)};var p="[CDATA[",f="DOCTYPE",w="http://www.w3.org/XML/1998/namespace",B="http://www.w3.org/2000/xmlns/",_={xml:w,xmlns:B},G=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,Z=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,ee=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,se=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function te(u){return u===" "||u===`
`||u==="\r"||u==="	"}function me(u){return u==='"'||u==="'"}function cr(u){return u===">"||te(u)}function Se(u,l){return u.test(l)}function ur(u,l){return!Se(u,l)}var y=0;t.STATE={BEGIN:y++,BEGIN_WHITESPACE:y++,TEXT:y++,TEXT_ENTITY:y++,OPEN_WAKA:y++,SGML_DECL:y++,SGML_DECL_QUOTED:y++,DOCTYPE:y++,DOCTYPE_QUOTED:y++,DOCTYPE_DTD:y++,DOCTYPE_DTD_QUOTED:y++,COMMENT_STARTING:y++,COMMENT:y++,COMMENT_ENDING:y++,COMMENT_ENDED:y++,CDATA:y++,CDATA_ENDING:y++,CDATA_ENDING_2:y++,PROC_INST:y++,PROC_INST_BODY:y++,PROC_INST_ENDING:y++,OPEN_TAG:y++,OPEN_TAG_SLASH:y++,ATTRIB:y++,ATTRIB_NAME:y++,ATTRIB_NAME_SAW_WHITE:y++,ATTRIB_VALUE:y++,ATTRIB_VALUE_QUOTED:y++,ATTRIB_VALUE_CLOSED:y++,ATTRIB_VALUE_UNQUOTED:y++,ATTRIB_VALUE_ENTITY_Q:y++,ATTRIB_VALUE_ENTITY_U:y++,CLOSE_TAG:y++,CLOSE_TAG_SAW_WHITE:y++,SCRIPT:y++,SCRIPT_ENDING:y++},t.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},t.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(t.ENTITIES).forEach(function(u){var l=t.ENTITIES[u],T=typeof l=="number"?String.fromCharCode(l):l;t.ENTITIES[u]=T});for(var Qe in t.STATE)t.STATE[t.STATE[Qe]]=Qe;y=t.STATE;function De(u,l,T){u[l]&&u[l](T)}function Q(u,l,T){u.textNode&&m(u),De(u,l,T)}function m(u){u.textNode=h(u.opt,u.textNode),u.textNode&&De(u,"ontext",u.textNode),u.textNode=""}function h(u,l){return u.trim&&(l=l.trim()),u.normalize&&(l=l.replace(/\s+/g," ")),l}function g(u,l){return m(u),u.trackPosition&&(l+=`
Line: `+u.line+`
Column: `+u.column+`
Char: `+u.c),l=new Error(l),u.error=l,De(u,"onerror",l),u}function S(u){return u.sawRoot&&!u.closedRoot&&A(u,"Unclosed root tag"),u.state!==y.BEGIN&&u.state!==y.BEGIN_WHITESPACE&&u.state!==y.TEXT&&g(u,"Unexpected end"),m(u),u.c="",u.closed=!0,De(u,"onend"),e.call(u,u.strict,u.opt),u}function A(u,l){if(typeof u!="object"||!(u instanceof e))throw new Error("bad call to strictFail");u.strict&&g(u,l)}function b(u){u.strict||(u.tagName=u.tagName[u.looseCase]());var l=u.tags[u.tags.length-1]||u,T=u.tag={name:u.tagName,attributes:{}};u.opt.xmlns&&(T.ns=l.ns),u.attribList.length=0,Q(u,"onopentagstart",T)}function U(u,l){var T=u.indexOf(":"),v=T<0?["",u]:u.split(":"),W=v[0],de=v[1];return l&&u==="xmlns"&&(W="xmlns",de=""),{prefix:W,local:de}}function Y(u){if(u.strict||(u.attribName=u.attribName[u.looseCase]()),u.attribList.indexOf(u.attribName)!==-1||u.tag.attributes.hasOwnProperty(u.attribName)){u.attribName=u.attribValue="";return}if(u.opt.xmlns){var l=U(u.attribName,!0),T=l.prefix,v=l.local;if(T==="xmlns")if(v==="xml"&&u.attribValue!==w)A(u,"xml: prefix must be bound to "+w+`
Actual: `+u.attribValue);else if(v==="xmlns"&&u.attribValue!==B)A(u,"xmlns: prefix must be bound to "+B+`
Actual: `+u.attribValue);else{var W=u.tag,de=u.tags[u.tags.length-1]||u;W.ns===de.ns&&(W.ns=Object.create(de.ns)),W.ns[v]=u.attribValue}u.attribList.push([u.attribName,u.attribValue])}else u.tag.attributes[u.attribName]=u.attribValue,Q(u,"onattribute",{name:u.attribName,value:u.attribValue});u.attribName=u.attribValue=""}function V(u,l){if(u.opt.xmlns){var T=u.tag,v=U(u.tagName);T.prefix=v.prefix,T.local=v.local,T.uri=T.ns[v.prefix]||"",T.prefix&&!T.uri&&(A(u,"Unbound namespace prefix: "+JSON.stringify(u.tagName)),T.uri=v.prefix);var W=u.tags[u.tags.length-1]||u;T.ns&&W.ns!==T.ns&&Object.keys(T.ns).forEach(function(bo){Q(u,"onopennamespace",{prefix:bo,uri:T.ns[bo]})});for(var de=0,pe=u.attribList.length;de<pe;de++){var ke=u.attribList[de],Je=ke[0],Ft=ke[1],ve=U(Je,!0),lt=ve.prefix,Sc=ve.local,So=lt===""?"":T.ns[lt]||"",kn={name:Je,value:Ft,prefix:lt,local:Sc,uri:So};lt&&lt!=="xmlns"&&!So&&(A(u,"Unbound namespace prefix: "+JSON.stringify(lt)),kn.uri=lt),u.tag.attributes[Je]=kn,Q(u,"onattribute",kn)}u.attribList.length=0}u.tag.isSelfClosing=!!l,u.sawRoot=!0,u.tags.push(u.tag),Q(u,"onopentag",u.tag),l||(!u.noscript&&u.tagName.toLowerCase()==="script"?u.state=y.SCRIPT:u.state=y.TEXT,u.tag=null,u.tagName=""),u.attribName=u.attribValue="",u.attribList.length=0}function ce(u){if(!u.tagName){A(u,"Weird empty close tag."),u.textNode+="</>",u.state=y.TEXT;return}if(u.script){if(u.tagName!=="script"){u.script+="</"+u.tagName+">",u.tagName="",u.state=y.SCRIPT;return}Q(u,"onscript",u.script),u.script=""}var l=u.tags.length,T=u.tagName;u.strict||(T=T[u.looseCase]());for(var v=T;l--;){var W=u.tags[l];if(W.name!==v)A(u,"Unexpected close tag");else break}if(l<0){A(u,"Unmatched closing tag: "+u.tagName),u.textNode+="</"+u.tagName+">",u.state=y.TEXT;return}u.tagName=T;for(var de=u.tags.length;de-- >l;){var pe=u.tag=u.tags.pop();u.tagName=u.tag.name,Q(u,"onclosetag",u.tagName);var ke={};for(var Je in pe.ns)ke[Je]=pe.ns[Je];var Ft=u.tags[u.tags.length-1]||u;u.opt.xmlns&&pe.ns!==Ft.ns&&Object.keys(pe.ns).forEach(function(ve){var lt=pe.ns[ve];Q(u,"onclosenamespace",{prefix:ve,uri:lt})})}l===0&&(u.closedRoot=!0),u.tagName=u.attribValue=u.attribName="",u.attribList.length=0,u.state=y.TEXT}function ue(u){var l=u.entity,T=l.toLowerCase(),v,W="";return u.ENTITIES[l]?u.ENTITIES[l]:u.ENTITIES[T]?u.ENTITIES[T]:(l=T,l.charAt(0)==="#"&&(l.charAt(1)==="x"?(l=l.slice(2),v=parseInt(l,16),W=v.toString(16)):(l=l.slice(1),v=parseInt(l,10),W=v.toString(10))),l=l.replace(/^0+/,""),isNaN(v)||W.toLowerCase()!==l?(A(u,"Invalid character entity"),"&"+u.entity+";"):String.fromCodePoint(v))}function fe(u,l){l==="<"?(u.state=y.OPEN_WAKA,u.startTagPosition=u.position):te(l)||(A(u,"Non-whitespace before first tag."),u.textNode=l,u.state=y.TEXT)}function To(u,l){var T="";return l<u.length&&(T=u.charAt(l)),T}function Tc(u){var l=this;if(this.error)throw this.error;if(l.closed)return g(l,"Cannot write after close. Assign an onready handler.");if(u===null)return S(l);typeof u=="object"&&(u=u.toString());for(var T=0,v="";v=To(u,T++),l.c=v,!!v;)switch(l.trackPosition&&(l.position++,v===`
`?(l.line++,l.column=0):l.column++),l.state){case y.BEGIN:if(l.state=y.BEGIN_WHITESPACE,v==="\uFEFF")continue;fe(l,v);continue;case y.BEGIN_WHITESPACE:fe(l,v);continue;case y.TEXT:if(l.sawRoot&&!l.closedRoot){for(var W=T-1;v&&v!=="<"&&v!=="&";)v=To(u,T++),v&&l.trackPosition&&(l.position++,v===`
`?(l.line++,l.column=0):l.column++);l.textNode+=u.substring(W,T-1)}v==="<"&&!(l.sawRoot&&l.closedRoot&&!l.strict)?(l.state=y.OPEN_WAKA,l.startTagPosition=l.position):(!te(v)&&(!l.sawRoot||l.closedRoot)&&A(l,"Text data outside of root node."),v==="&"?l.state=y.TEXT_ENTITY:l.textNode+=v);continue;case y.SCRIPT:v==="<"?l.state=y.SCRIPT_ENDING:l.script+=v;continue;case y.SCRIPT_ENDING:v==="/"?l.state=y.CLOSE_TAG:(l.script+="<"+v,l.state=y.SCRIPT);continue;case y.OPEN_WAKA:if(v==="!")l.state=y.SGML_DECL,l.sgmlDecl="";else if(!te(v))if(Se(G,v))l.state=y.OPEN_TAG,l.tagName=v;else if(v==="/")l.state=y.CLOSE_TAG,l.tagName="";else if(v==="?")l.state=y.PROC_INST,l.procInstName=l.procInstBody="";else{if(A(l,"Unencoded <"),l.startTagPosition+1<l.position){var de=l.position-l.startTagPosition;v=new Array(de).join(" ")+v}l.textNode+="<"+v,l.state=y.TEXT}continue;case y.SGML_DECL:(l.sgmlDecl+v).toUpperCase()===p?(Q(l,"onopencdata"),l.state=y.CDATA,l.sgmlDecl="",l.cdata=""):l.sgmlDecl+v==="--"?(l.state=y.COMMENT,l.comment="",l.sgmlDecl=""):(l.sgmlDecl+v).toUpperCase()===f?(l.state=y.DOCTYPE,(l.doctype||l.sawRoot)&&A(l,"Inappropriately located doctype declaration"),l.doctype="",l.sgmlDecl=""):v===">"?(Q(l,"onsgmldeclaration",l.sgmlDecl),l.sgmlDecl="",l.state=y.TEXT):(me(v)&&(l.state=y.SGML_DECL_QUOTED),l.sgmlDecl+=v);continue;case y.SGML_DECL_QUOTED:v===l.q&&(l.state=y.SGML_DECL,l.q=""),l.sgmlDecl+=v;continue;case y.DOCTYPE:v===">"?(l.state=y.TEXT,Q(l,"ondoctype",l.doctype),l.doctype=!0):(l.doctype+=v,v==="["?l.state=y.DOCTYPE_DTD:me(v)&&(l.state=y.DOCTYPE_QUOTED,l.q=v));continue;case y.DOCTYPE_QUOTED:l.doctype+=v,v===l.q&&(l.q="",l.state=y.DOCTYPE);continue;case y.DOCTYPE_DTD:l.doctype+=v,v==="]"?l.state=y.DOCTYPE:me(v)&&(l.state=y.DOCTYPE_DTD_QUOTED,l.q=v);continue;case y.DOCTYPE_DTD_QUOTED:l.doctype+=v,v===l.q&&(l.state=y.DOCTYPE_DTD,l.q="");continue;case y.COMMENT:v==="-"?l.state=y.COMMENT_ENDING:l.comment+=v;continue;case y.COMMENT_ENDING:v==="-"?(l.state=y.COMMENT_ENDED,l.comment=h(l.opt,l.comment),l.comment&&Q(l,"oncomment",l.comment),l.comment=""):(l.comment+="-"+v,l.state=y.COMMENT);continue;case y.COMMENT_ENDED:v!==">"?(A(l,"Malformed comment"),l.comment+="--"+v,l.state=y.COMMENT):l.state=y.TEXT;continue;case y.CDATA:v==="]"?l.state=y.CDATA_ENDING:l.cdata+=v;continue;case y.CDATA_ENDING:v==="]"?l.state=y.CDATA_ENDING_2:(l.cdata+="]"+v,l.state=y.CDATA);continue;case y.CDATA_ENDING_2:v===">"?(l.cdata&&Q(l,"oncdata",l.cdata),Q(l,"onclosecdata"),l.cdata="",l.state=y.TEXT):v==="]"?l.cdata+="]":(l.cdata+="]]"+v,l.state=y.CDATA);continue;case y.PROC_INST:v==="?"?l.state=y.PROC_INST_ENDING:te(v)?l.state=y.PROC_INST_BODY:l.procInstName+=v;continue;case y.PROC_INST_BODY:if(!l.procInstBody&&te(v))continue;v==="?"?l.state=y.PROC_INST_ENDING:l.procInstBody+=v;continue;case y.PROC_INST_ENDING:v===">"?(Q(l,"onprocessinginstruction",{name:l.procInstName,body:l.procInstBody}),l.procInstName=l.procInstBody="",l.state=y.TEXT):(l.procInstBody+="?"+v,l.state=y.PROC_INST_BODY);continue;case y.OPEN_TAG:Se(Z,v)?l.tagName+=v:(b(l),v===">"?V(l):v==="/"?l.state=y.OPEN_TAG_SLASH:(te(v)||A(l,"Invalid character in tag name"),l.state=y.ATTRIB));continue;case y.OPEN_TAG_SLASH:v===">"?(V(l,!0),ce(l)):(A(l,"Forward-slash in opening tag not followed by >"),l.state=y.ATTRIB);continue;case y.ATTRIB:if(te(v))continue;v===">"?V(l):v==="/"?l.state=y.OPEN_TAG_SLASH:Se(G,v)?(l.attribName=v,l.attribValue="",l.state=y.ATTRIB_NAME):A(l,"Invalid attribute name");continue;case y.ATTRIB_NAME:v==="="?l.state=y.ATTRIB_VALUE:v===">"?(A(l,"Attribute without value"),l.attribValue=l.attribName,Y(l),V(l)):te(v)?l.state=y.ATTRIB_NAME_SAW_WHITE:Se(Z,v)?l.attribName+=v:A(l,"Invalid attribute name");continue;case y.ATTRIB_NAME_SAW_WHITE:if(v==="=")l.state=y.ATTRIB_VALUE;else{if(te(v))continue;A(l,"Attribute without value"),l.tag.attributes[l.attribName]="",l.attribValue="",Q(l,"onattribute",{name:l.attribName,value:""}),l.attribName="",v===">"?V(l):Se(G,v)?(l.attribName=v,l.state=y.ATTRIB_NAME):(A(l,"Invalid attribute name"),l.state=y.ATTRIB)}continue;case y.ATTRIB_VALUE:if(te(v))continue;me(v)?(l.q=v,l.state=y.ATTRIB_VALUE_QUOTED):(A(l,"Unquoted attribute value"),l.state=y.ATTRIB_VALUE_UNQUOTED,l.attribValue=v);continue;case y.ATTRIB_VALUE_QUOTED:if(v!==l.q){v==="&"?l.state=y.ATTRIB_VALUE_ENTITY_Q:l.attribValue+=v;continue}Y(l),l.q="",l.state=y.ATTRIB_VALUE_CLOSED;continue;case y.ATTRIB_VALUE_CLOSED:te(v)?l.state=y.ATTRIB:v===">"?V(l):v==="/"?l.state=y.OPEN_TAG_SLASH:Se(G,v)?(A(l,"No whitespace between attributes"),l.attribName=v,l.attribValue="",l.state=y.ATTRIB_NAME):A(l,"Invalid attribute name");continue;case y.ATTRIB_VALUE_UNQUOTED:if(!cr(v)){v==="&"?l.state=y.ATTRIB_VALUE_ENTITY_U:l.attribValue+=v;continue}Y(l),v===">"?V(l):l.state=y.ATTRIB;continue;case y.CLOSE_TAG:if(l.tagName)v===">"?ce(l):Se(Z,v)?l.tagName+=v:l.script?(l.script+="</"+l.tagName,l.tagName="",l.state=y.SCRIPT):(te(v)||A(l,"Invalid tagname in closing tag"),l.state=y.CLOSE_TAG_SAW_WHITE);else{if(te(v))continue;ur(G,v)?l.script?(l.script+="</"+v,l.state=y.SCRIPT):A(l,"Invalid tagname in closing tag."):l.tagName=v}continue;case y.CLOSE_TAG_SAW_WHITE:if(te(v))continue;v===">"?ce(l):A(l,"Invalid characters in closing tag");continue;case y.TEXT_ENTITY:case y.ATTRIB_VALUE_ENTITY_Q:case y.ATTRIB_VALUE_ENTITY_U:var pe,ke;switch(l.state){case y.TEXT_ENTITY:pe=y.TEXT,ke="textNode";break;case y.ATTRIB_VALUE_ENTITY_Q:pe=y.ATTRIB_VALUE_QUOTED,ke="attribValue";break;case y.ATTRIB_VALUE_ENTITY_U:pe=y.ATTRIB_VALUE_UNQUOTED,ke="attribValue";break}v===";"?(l[ke]+=ue(l),l.entity="",l.state=pe):Se(l.entity.length?se:ee,v)?l.entity+=v:(A(l,"Invalid character in entity name"),l[ke]+="&"+l.entity+v,l.entity="",l.state=pe);continue;default:throw new Error(l,"Unknown state: "+l.state)}return l.position>=l.bufferCheckPosition&&r(l),l}String.fromCodePoint||function(){var u=String.fromCharCode,l=Math.floor,T=function(){var v=16384,W=[],de,pe,ke=-1,Je=arguments.length;if(!Je)return"";for(var Ft="";++ke<Je;){var ve=Number(arguments[ke]);if(!isFinite(ve)||ve<0||ve>1114111||l(ve)!==ve)throw RangeError("Invalid code point: "+ve);ve<=65535?W.push(ve):(ve-=65536,de=(ve>>10)+55296,pe=ve%1024+56320,W.push(de,pe)),(ke+1===Je||W.length>v)&&(Ft+=u.apply(null,W),W.length=0)}return Ft};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:T,configurable:!0,writable:!0}):String.fromCodePoint=T}()})(typeof on=="undefined"?on.sax={}:on)});var io=D(sn=>{"use strict";sn.__esModule=!0;sn.DashManifestParser=void 0;var El=J(),sg=Ha(),lg=cg(ro()),ze=Ne();function cg(t){return t&&t.__esModule?t:{default:t}}var ug="yo.js=([^&]+)",dg="/live/(\\d+)/.+?;jsessionid=([^?\\s]+)",hg=1600,fg="yo.js",pg=function(){function t(){this.data=new Map,this.s="",this.error=null,this.onError=this.onError.bind(this),this.onText=this.onText.bind(this),this.onOpenTag=this.onOpenTag.bind(this),this.onCloseTag=this.onCloseTag.bind(this),this.onCdata=this.onCdata.bind(this)}t.parse=function(r){if(!r||r.length===0)return El.YoLog.e("Yospace DASH manifest is empty"),null;var n=new t;return n.parse(r)};var i=t.prototype;return i.parse=function(r){var n=lg.default.parser(!0);return n.onerror=this.onError,n.ontext=this.onText,n.onopentag=this.onOpenTag,n.onclosetag=this.onCloseTag,n.oncdata=this.onCdata,n.write(r),this.error?null:new sg.PlaylistPayload(this.data,hg)},i.onCdata=function(r){this.s+=r},i.onError=function(){this.error=!0},i.onCloseTag=function(r){if(r.toUpperCase()==="LOCATION"){var n=this.s.trim();this.data.set(ze.Payload.LOCATION,n);var a=n.split(/\?/);try{var o=new URL(a[0]);this.data.set(ze.Payload.SCHEME,o.protocol.substring(0,o.protocol.length-1)),this.data.set(ze.Payload.HOSTNODE,o.hostname),this.data.set(ze.Payload.PORT,o.port),this.data.set(ze.Payload.QS,a.length===2?a[1]:null);var s=a[0].match(dg);if(s)this.data.set(ze.Payload.IDENTIFIER,s[2]);else if(n.indexOf(fg)!==-1){var c=n.match(ug);c&&this.data.set(ze.Payload.IDENTIFIER,c[1])}this.data.get(ze.Payload.IDENTIFIER)===void 0&&(this.error=!0)}catch(d){El.YoLog.e("Failed to parse Location element: "+d),this.error=!0}}},i.onOpenTag=function(r){this.s="",r.name.toUpperCase()==="MPD"&&(this.data.set(ze.Payload.ANALYTICURL,r.attributes.analytics),this.data.set(ze.Payload.PAUSEURL,r.attributes.livePause),this.data.set(ze.Payload.AVAILABILITYSTART,new Date(r.attributes.availabilityStartTime)))},i.onText=function(r){this.s=r},t}();sn.DashManifestParser=pg});var no=D(cn=>{"use strict";cn.__esModule=!0;cn.HlsManifestParser=void 0;var Al=X(),Vr=J(),ae=Ne(),gg=Ha(),Tl=et();function vg(t,i){var e=typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e)return(e=e.call(t)).next.bind(e);if(Array.isArray(t)||(e=yg(t))||i&&t&&typeof t.length=="number"){e&&(t=e);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yg(t,i){if(t){if(typeof t=="string")return Sl(t,i);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Sl(t,i)}}function Sl(t,i){(i==null||i>t.length)&&(i=t.length);for(var e=0,r=new Array(i);e<i;e++)r[e]=t[e];return r}var mg="#EXTM3U",Eg=/;jsessionid=([^?]+)/,Ag=/yo\.js=([^?]+)/,ln="FIRSTLEVELPLAYLIST",Tg="#EXT-X-YOSPACE-ANALYTICS-URL",Sg="#EXT-X-STREAM-INF",bg="#EXT-X-YOSPACE-PAUSE",kg="#EXT-X-YOSPACE-SDK-MASTER-URL",Ig=function(){function t(){this.data=new Map,this.nextLineStreamInf=!1}var i=t.prototype;return i.buildPlaybackUrl=function(){var r=this.data.get(ae.Payload.LOCATION);r&&!(0,Tl.getUrl)(r)&&(Vr.YoLog.w("Master URL invalid in HSL manifest: "+r),this.data.delete(ae.Payload.LOCATION));var n=!1,a=this.data.get(ae.Payload.LOCATION);if(a||(a=this.data.get(ln)),!a)return Vr.YoLog.e("No location or first level URL available"),!1;var o=(0,Tl.getUrl)(a),s=a.match(Ag),c=a.match(Eg);if(o&&(s?(n=!0,this.data.set(ae.Payload.IDENTIFIER,s[1])):c&&this.data.set(ae.Payload.IDENTIFIER,c[1])),!o||this.data.get(ae.Payload.IDENTIFIER)===void 0)return Vr.YoLog.e("Unable to build Location from components"),!1;var d=o.port;return this.data.set(ae.Payload.PORT,d===""?"":d),this.data.set(ae.Payload.SCHEME,o.protocol.substring(0,o.protocol.length-1)),this.data.set(ae.Payload.HOSTNODE,o.hostname),this.data.set(ae.Payload.QS,o.search?o.search.replace("?",""):""),this.updateLocationPath(o,n),!0},i.updateLocationPath=function(r,n){if(!this.data.get(ae.Payload.LOCATION)){var a=r.pathname,o=a.substring(0,a.lastIndexOf("/"))+".m3u8",s=this.data.get(ae.Payload.SCHEME);s+="://",s+=this.data.get(ae.Payload.HOSTNODE),s+=this.data.get(ae.Payload.PORT)!==""?":"+this.data.get(ae.Payload.PORT):"",s+=o,n||(s+=";jsessionid="+this.data.get(ae.Payload.IDENTIFIER)),(0,Al.isNullOrEmpty)(this.data.get(ae.Payload.QS))||(s+="?"+this.data.get(ae.Payload.QS)),this.data.set(ae.Payload.LOCATION,s)}},t.checkParameters=function(r){return(0,Al.isNullOrEmpty)(r)?(Vr.YoLog.e("Yospace HLS manifest is empty"),!1):r.indexOf("#EXT-X-STREAM-INF:")===-1?(Vr.YoLog.e("No stream info found in HLS manifest"),!1):!0},t.isHlsManifest=function(r){return r.length>=7&&r.toUpperCase().indexOf(mg)!==-1},i.parseManifestLines=function(r){for(var n=r.split(/\r?\n/),a=vg(n),o;!(o=a()).done;){var s=o.value;s.length!==0&&(s.startsWith("#")?this.processManifestDirective(s):this.nextLineStreamInf&&!this.data.has(ln)&&this.data.set(ln,s))}},i.processManifestDirective=function(r){var n=r.indexOf(":");if(n!==-1){var a=r.substring(n+1),o=r.substring(0,n);o.includes(Tg)?this.data.set(ae.Payload.ANALYTICURL,a.replace(/"/g,"")):o.includes(Sg)?this.data.has(ln)||(this.nextLineStreamInf=!0):o.includes(bg)?this.data.set(ae.Payload.PAUSEURL,a.replace(/"/g,"")):o.includes(kg)&&this.data.set(ae.Payload.LOCATION,a.replace(/"/g,""))}},t.parse=function(r){var n=new t;return t.checkParameters(r)?(n.parseManifestLines(r),n.buildPlaybackUrl(),new gg.PlaylistPayload(n.data,ae.Constant.INTERSEGMENT_TIMEOUT)):null},t}();cn.HlsManifestParser=Ig});var ao=D(un=>{"use strict";un.__esModule=!0;un.UrlPoller=void 0;var be=J(),Pg=Ne(),_g=Ct(),Lg=Ve();function xr(){"use strict";xr=function(){return t};var t={},i=Object.prototype,e=i.hasOwnProperty,r=Object.defineProperty||function(m,h,g){m[h]=g.value},n=typeof Symbol=="function"?Symbol:{},a=n.iterator||"@@iterator",o=n.asyncIterator||"@@asyncIterator",s=n.toStringTag||"@@toStringTag";function c(m,h,g){return Object.defineProperty(m,h,{value:g,enumerable:!0,configurable:!0,writable:!0}),m[h]}try{c({},"")}catch(m){c=function(g,S,A){return g[S]=A}}function d(m,h,g,S){var A=h&&h.prototype instanceof w?h:w,b=Object.create(A.prototype),U=new Qe(S||[]);return r(b,"_invoke",{value:cr(m,g,U)}),b}function p(m,h,g){try{return{type:"normal",arg:m.call(h,g)}}catch(S){return{type:"throw",arg:S}}}t.wrap=d;var f={};function w(){}function B(){}function _(){}var G={};c(G,a,function(){return this});var Z=Object.getPrototypeOf,ee=Z&&Z(Z(De([])));ee&&ee!==i&&e.call(ee,a)&&(G=ee);var se=_.prototype=w.prototype=Object.create(G);function te(m){["next","throw","return"].forEach(function(h){c(m,h,function(g){return this._invoke(h,g)})})}function me(m,h){function g(A,b,U,Y){var V=p(m[A],m,b);if(V.type!=="throw"){var ce=V.arg,ue=ce.value;return ue&&typeof ue=="object"&&e.call(ue,"__await")?h.resolve(ue.__await).then(function(fe){g("next",fe,U,Y)},function(fe){g("throw",fe,U,Y)}):h.resolve(ue).then(function(fe){ce.value=fe,U(ce)},function(fe){return g("throw",fe,U,Y)})}Y(V.arg)}var S;r(this,"_invoke",{value:function(b,U){function Y(){return new h(function(V,ce){g(b,U,V,ce)})}return S=S?S.then(Y,Y):Y()}})}function cr(m,h,g){var S="suspendedStart";return function(A,b){if(S==="executing")throw new Error("Generator is already running");if(S==="completed"){if(A==="throw")throw b;return Q()}for(g.method=A,g.arg=b;;){var U=g.delegate;if(U){var Y=Se(U,g);if(Y){if(Y===f)continue;return Y}}if(g.method==="next")g.sent=g._sent=g.arg;else if(g.method==="throw"){if(S==="suspendedStart")throw S="completed",g.arg;g.dispatchException(g.arg)}else g.method==="return"&&g.abrupt("return",g.arg);S="executing";var V=p(m,h,g);if(V.type==="normal"){if(S=g.done?"completed":"suspendedYield",V.arg===f)continue;return{value:V.arg,done:g.done}}V.type==="throw"&&(S="completed",g.method="throw",g.arg=V.arg)}}}function Se(m,h){var g=h.method,S=m.iterator[g];if(S===void 0)return h.delegate=null,g==="throw"&&m.iterator.return&&(h.method="return",h.arg=void 0,Se(m,h),h.method==="throw")||g!=="return"&&(h.method="throw",h.arg=new TypeError("The iterator does not provide a '"+g+"' method")),f;var A=p(S,m.iterator,h.arg);if(A.type==="throw")return h.method="throw",h.arg=A.arg,h.delegate=null,f;var b=A.arg;return b?b.done?(h[m.resultName]=b.value,h.next=m.nextLoc,h.method!=="return"&&(h.method="next",h.arg=void 0),h.delegate=null,f):b:(h.method="throw",h.arg=new TypeError("iterator result is not an object"),h.delegate=null,f)}function ur(m){var h={tryLoc:m[0]};1 in m&&(h.catchLoc=m[1]),2 in m&&(h.finallyLoc=m[2],h.afterLoc=m[3]),this.tryEntries.push(h)}function y(m){var h=m.completion||{};h.type="normal",delete h.arg,m.completion=h}function Qe(m){this.tryEntries=[{tryLoc:"root"}],m.forEach(ur,this),this.reset(!0)}function De(m){if(m){var h=m[a];if(h)return h.call(m);if(typeof m.next=="function")return m;if(!isNaN(m.length)){var g=-1,S=function A(){for(;++g<m.length;)if(e.call(m,g))return A.value=m[g],A.done=!1,A;return A.value=void 0,A.done=!0,A};return S.next=S}}return{next:Q}}function Q(){return{value:void 0,done:!0}}return B.prototype=_,r(se,"constructor",{value:_,configurable:!0}),r(_,"constructor",{value:B,configurable:!0}),B.displayName=c(_,s,"GeneratorFunction"),t.isGeneratorFunction=function(m){var h=typeof m=="function"&&m.constructor;return!!h&&(h===B||(h.displayName||h.name)==="GeneratorFunction")},t.mark=function(m){return Object.setPrototypeOf?Object.setPrototypeOf(m,_):(m.__proto__=_,c(m,s,"GeneratorFunction")),m.prototype=Object.create(se),m},t.awrap=function(m){return{__await:m}},te(me.prototype),c(me.prototype,o,function(){return this}),t.AsyncIterator=me,t.async=function(m,h,g,S,A){A===void 0&&(A=Promise);var b=new me(d(m,h,g,S),A);return t.isGeneratorFunction(h)?b:b.next().then(function(U){return U.done?U.value:b.next()})},te(se),c(se,s,"Generator"),c(se,a,function(){return this}),c(se,"toString",function(){return"[object Generator]"}),t.keys=function(m){var h=Object(m),g=[];for(var S in h)g.push(S);return g.reverse(),function A(){for(;g.length;){var b=g.pop();if(b in h)return A.value=b,A.done=!1,A}return A.done=!0,A}},t.values=De,Qe.prototype={constructor:Qe,reset:function(h){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(y),!h)for(var g in this)g.charAt(0)==="t"&&e.call(this,g)&&!isNaN(+g.slice(1))&&(this[g]=void 0)},stop:function(){this.done=!0;var h=this.tryEntries[0].completion;if(h.type==="throw")throw h.arg;return this.rval},dispatchException:function(h){if(this.done)throw h;var g=this;function S(ce,ue){return U.type="throw",U.arg=h,g.next=ce,ue&&(g.method="next",g.arg=void 0),!!ue}for(var A=this.tryEntries.length-1;A>=0;--A){var b=this.tryEntries[A],U=b.completion;if(b.tryLoc==="root")return S("end");if(b.tryLoc<=this.prev){var Y=e.call(b,"catchLoc"),V=e.call(b,"finallyLoc");if(Y&&V){if(this.prev<b.catchLoc)return S(b.catchLoc,!0);if(this.prev<b.finallyLoc)return S(b.finallyLoc)}else if(Y){if(this.prev<b.catchLoc)return S(b.catchLoc,!0)}else{if(!V)throw new Error("try statement without catch or finally");if(this.prev<b.finallyLoc)return S(b.finallyLoc)}}}},abrupt:function(h,g){for(var S=this.tryEntries.length-1;S>=0;--S){var A=this.tryEntries[S];if(A.tryLoc<=this.prev&&e.call(A,"finallyLoc")&&this.prev<A.finallyLoc){var b=A;break}}b&&(h==="break"||h==="continue")&&b.tryLoc<=g&&g<=b.finallyLoc&&(b=null);var U=b?b.completion:{};return U.type=h,U.arg=g,b?(this.method="next",this.next=b.finallyLoc,f):this.complete(U)},complete:function(h,g){if(h.type==="throw")throw h.arg;return h.type==="break"||h.type==="continue"?this.next=h.arg:h.type==="return"?(this.rval=this.arg=h.arg,this.method="return",this.next="end"):h.type==="normal"&&g&&(this.next=g),f},finish:function(h){for(var g=this.tryEntries.length-1;g>=0;--g){var S=this.tryEntries[g];if(S.finallyLoc===h)return this.complete(S.completion,S.afterLoc),y(S),f}},catch:function(h){for(var g=this.tryEntries.length-1;g>=0;--g){var S=this.tryEntries[g];if(S.tryLoc===h){var A=S.completion;if(A.type==="throw"){var b=A.arg;y(S)}return b}}throw new Error("illegal catch attempt")},delegateYield:function(h,g,S){return this.delegate={iterator:De(h),resultName:g,nextLoc:S},this.method==="next"&&(this.arg=void 0),f}},t}function bl(t,i,e,r,n,a,o){try{var s=t[a](o),c=s.value}catch(d){e(d);return}s.done?i(c):Promise.resolve(c).then(r,n)}function kl(t){return function(){var i=this,e=arguments;return new Promise(function(r,n){var a=t.apply(i,e);function o(c){bl(a,r,n,o,s,"next",c)}function s(c){bl(a,r,n,o,s,"throw",c)}o(void 0)})}}var wg=function(){function t(e,r,n,a){this.url=e,this.timeout=r,this.handler=n,this.frequency=a||Pg.Constant.DEFAULT_POLLING_DELAY,this.requestInProgress=!1,this.intervalID=null,this.lastPollTime=0,this.lastPollTimeMetric=0,this.queryParams=new Map,this.queryParams.set("ysdk",Lg.Session.version())}var i=t.prototype;return i.handleRequest=function(){var e=kl(xr().mark(function n(){var a,o,s;return xr().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return a={},d.next=3,_g.HttpConnection.get(this.url,a,this.timeout,null,this.queryParams);case 3:return o=d.sent,o.error&&be.YoLog.w("Poll failed: "+o.error),o.ok?(be.YoLog.trace("sdk poll"),s=this.getRetryFromResponse(o),s!==this.frequency&&(be.YoLog.d(be.DebugFlags.DEBUG_POLLING,"Poll interval changed to "+s+" millis"),this.frequency=s,this.isRunning()&&this._start(!1))):o.status===400||o.status===410?(this.stop(),o.status===410&&be.YoLog.d(be.DebugFlags.DEBUG_POLLING,"Stream is resolved.  Stopping "+(this.handler?"analytic":"pause")+" poller")):be.YoLog.w("Unexpected poll response "+o.status+", intervalID: "+this.frequency+" ms"),d.abrupt("return",o);case 7:case"end":return d.stop()}},n,this)}));function r(){return e.apply(this,arguments)}return r}(),i.getRetryFromResponse=function(r){var n=r.headers.get("Retry-After");return n=Number.parseFloat(n)*1e3,!Number.isNaN(n)&&n>0?n:this.frequency},i.getFrequency=function(){return this.frequency},i.isRunning=function(){return this.intervalID!==null},i.request=function(){be.YoLog.d(be.DebugFlags.DEBUG_POLLING,"Request poll"),this._poll(!0)},i._poll=function(){var e=kl(xr().mark(function n(a){var o,s;return xr().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(this.shouldPoll(a)){d.next=2;break}return d.abrupt("return");case 2:return this.requestInProgress=!0,o=Date.now(),(this.lastPollTime===0||!a)&&(this.lastPollTime=o),this.lastPollTimeMetric=o,d.next=8,this.handleRequest();case 8:s=d.sent,this.handler&&this.handler(s,this.frequency),this.requestInProgress=!1;case 11:case"end":return d.stop()}},n,this)}));function r(n){return e.apply(this,arguments)}return r}(),i.shouldPoll=function(r){if(this.requestInProgress)return be.YoLog.d(be.DebugFlags.DEBUG_POLLING,"Last poll still in flight. Ignoring."),!1;if(r)return!0;var n=Date.now()-this.lastPollTime;return n<this.frequency/2?(be.YoLog.d(be.DebugFlags.DEBUG_POLLING,"Last poll too recent ("+n/1e3+"s). Ignoring."),!1):!0},i.start=function(){this._start(!0)},i._start=function(r){var n=this;this.stop();var a=t.computeTimeToNextInterval(Date.now(),this.lastPollTime,this.frequency);this.intervalID=setTimeout(function(){n.intervalID=setInterval(function(){n._poll()},n.frequency),n._poll()},r?0:a)},t.computeTimeToNextInterval=function(r,n,a){var o=Math.floor(Math.abs(r-n)/a),s=n+a*(o+1);return s-r},i.stop=function(){clearInterval(this.intervalID),this.intervalID=null},i.shutdown=function(){this.stop(),this.handler=function(){},be.YoLog.d(be.DebugFlags.DEBUG_LIFECYCLE,"Poller shutdown")},t}();un.UrlPoller=wg});var Pl=D(dn=>{"use strict";dn.__esModule=!0;dn.AnalyticPayload=void 0;function oo(t,i){var e=typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e)return(e=e.call(t)).next.bind(e);if(Array.isArray(t)||(e=Cg(t))||i&&t&&typeof t.length=="number"){e&&(t=e);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Cg(t,i){if(t){if(typeof t=="string")return Il(t,i);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Il(t,i)}}function Il(t,i){(i==null||i>t.length)&&(i=t.length);for(var e=0,r=new Array(i);e<i;e++)r[e]=t[e];return r}var Dg=function(){function t(e,r){if(e){this.linearAdBreaks=e.linearAdBreaks?e.linearAdBreaks:[],this.nonLinearAdBreaks=e.nonLinearAdBreaks?e.nonLinearAdBreaks:[],this.displayAdBreaks=e.displayAdBreaks?e.displayAdBreaks:[];var n=e.getStreamData();this.processStreamData(n)}this.setHash(r)}var i=t.prototype;return i.getDisplayAdBreaks=function(){return this.displayAdBreaks},i.getEarlyReturn=function(){return this.earlyReturn},i.getLinearAdBreaks=function(){return this.linearAdBreaks},i.getHasPlaceholder=function(){return this.hasPlaceholder},i.getHostNode=function(){return this.hostNode},i.getHostSuffix=function(){return this.hostSuffix},i.getNonLinearAdBreaks=function(){return this.nonLinearAdBreaks},i.getPdtInitial=function(){return this.pdtInitial},i.getPdtStart=function(){return this.pdtStart},i.getPdtEnd=function(){return this.pdtEnd},i.getSessionIdentifier=function(){return this.sessionIdentifier},i.getStreamDuration=function(){return this.streamDuration},i.hasAdBreaks=function(){return this.linearAdBreaks.length>0||this.nonLinearAdBreaks.length>0||this.displayAdBreaks.length>0},i.isEqualTo=function(r){return this.hashCode===r.hashCode},i.processStreamData=function(r){this.sessionIdentifier=r.getSessionIdentifier(),this.streamDuration=r.getDuration(),this.hostNode=r.getHostNode(),this.hostSuffix=r.getHostSuffix(),this.pdtInitial=r.getPdtInitial(),this.pdtStart=r.getPdtStart(),this.pdtEnd=r.getPdtEnd(),this.earlyReturn=r.getEarlyReturn(),this.hasPlaceholder=r.getHasPlaceholder()},i.setHash=function(r){if(r){var n=0,a,o;for(a=0;a<r.length;a++)o=r.charCodeAt(a),n=(n<<5)-n+o,n=n&n;this.hashCode=n}},i.toString=function(){for(var r="Linear AdBreaks:",n=oo(this.linearAdBreaks),a;!(a=n()).done;){var o=a.value;r+=`
`+o}r+=`

NonLinear AdBreaks:`;for(var s=oo(this.nonLinearAdBreaks),c;!(c=s()).done;){var d=c.value;r+=`
`+d}r+=`

Display AdBreaks:`;for(var p=oo(this.displayAdBreaks),f;!(f=p()).done;){var w=f.value;r+=`
`+w}return r+=`

HostNode:`,r+=`
`+this.hostNode,r+=`

HostSuffix:`,r+=`
`+this.hostSuffix,r+=`

SessionIdentifier:`,r+=`
`+this.sessionIdentifier,r+=`

StreamDuration:`,r+=`
`+this.streamDuration,r+=`

pdtInitial:`,r+=`
`+this.pdtInitial,r+=`

pdtStart:`,r+=`
`+this.pdtStart,r+=`

pdtEnd:`,r+=`
`+this.pdtEnd,r+="mmearlyReturn:",r+=`
`+this.earlyReturn,r},t}();dn.AnalyticPayload=Dg});var hn=D(st=>{"use strict";st.__esModule=!0;st.StreamData=st.Parser=st.CreativeData=st.AdvertData=void 0;var Rg=jg(ro()),O=J(),Bt=Lt(),He=kr(),Ng=Gt(),Og=Fi(),Mg=Di(),Bg=xi(),Ug=qi(),Fg=zi(),Vg=Cr(),xg=Ea(),Yg=Or(),Ce=rt(),Ae=dt(),ar=jt(),or=_r(),Me=Ze(),Hg=Bi(),qg=va(),Te=X(),pt=et(),Gg=Pl(),sr=$n(),oe=oa();function jg(t){return t&&t.__esModule?t:{default:t}}function Tt(t,i){var e=typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e)return(e=e.call(t)).next.bind(e);if(Array.isArray(t)||(e=Wg(t))||i&&t&&typeof t.length=="number"){e&&(t=e);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wg(t,i){if(t){if(typeof t=="string")return _l(t,i);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return _l(t,i)}}function _l(t,i){(i==null||i>t.length)&&(i=t.length);for(var e=0,r=new Array(i);e<i;e++)r[e]=t[e];return r}var Xe={NONE:0,COMPANION:1,LINEAR:2,NONLINEAR:3},Kg="AdTitle",Ll="Ad",wl="AdServingId",zg="AltText",Xg="ClickThrough",$g="ClickTracking",Qg="CompanionClickThrough",Jg="CompanionClickTracking",Zg="CustomClick",Cl="Description",ev="Duration",tv="Error",rv="IconClickThrough",iv="IconClickTracking",nv="IconViewTracking",av="IFrameResource",ov="NonLinearClickThrough",sv="NonLinearClickTracking",lv="NotViewable",cv="VerificationParameters",uv="Viewable",dv="ViewUndetermined",Dl="vmap:AdBreak",hv="vmap:VMAP",fv="yospace:AdBreak",pv="yospace:Stream",Rl="vmap:Tracking",gv="VAST",vv="AdWrapper",so="Category",Nl="AdSystem",lo="Advertiser",co="Survey",uo="Pricing",ho="UniversalAdId",Ol="Extensions",Ml="Creative",Bl="Linear",Ul="Icon",Fl="IconClickFallbackImage",yv="Impression",fo="AdParameters",mv="MediaFile",Vl="InteractiveCreativeFile",xl="NonLinearAds",Yl="NonLinear",Hl="CompanionAds",ql="Companion",Gl="StaticResource",jl="HTMLResource",Wl="Tracking",Kl="Verification",po="JavaScriptResource",zl="ExecutableResource",Ev="Extension",Xl="CreativeExtensions",Av="CreativeExtension",Tv="vmap:AdTagURI",Sv=4.2,bv="yo.p.si=([^&]+)";function kv(t){if(O.YoLog.debugflags&O.DebugFlags.DEBUG_PARSING){O.YoLog.d(O.DebugFlags.DEBUG_PARSING,`
--------------- VMAP PARSING SUMMARY ---------------`),O.YoLog.d(O.DebugFlags.DEBUG_PARSING," * Number of ad breaks: "+t.linearAdBreaks.length),O.YoLog.d(O.DebugFlags.DEBUG_PARSING," * Number of nonlinear ad breaks: "+t.nonLinearAdBreaks.length),O.YoLog.d(O.DebugFlags.DEBUG_PARSING," * Number of display ad breaks: "+t.displayAdBreaks.length),O.YoLog.d(O.DebugFlags.DEBUG_PARSING," * Stream duration: "+t.streamData.duration+`ms
`);for(var i=Tt(t.linearAdBreaks),e;!(e=i()).done;){var r=e.value;O.YoLog.d(O.DebugFlags.DEBUG_PARSING,r.toString());for(var n=Tt(r.getAdverts()),a;!(a=n()).done;){var o=a.value;O.YoLog.d(O.DebugFlags.DEBUG_PARSING,o.toString())}}for(var s=Tt(t.nonLinearAdBreaks),c;!(c=s()).done;){var d=c.value;O.YoLog.d(O.DebugFlags.DEBUG_PARSING,d.toString());for(var p=Tt(d.getAdverts()),f;!(f=p()).done;){var w=f.value;O.YoLog.d(O.DebugFlags.DEBUG_PARSING,w.toString())}}for(var B=Tt(t.displayAdBreaks),_;!(_=B()).done;){var G=_.value;O.YoLog.d(O.DebugFlags.DEBUG_PARSING,G.toString());for(var Z=Tt(G.getAdverts()),ee;!(ee=Z()).done;){var se=ee.value;O.YoLog.d(O.DebugFlags.DEBUG_PARSING,se.toString())}}t.streamData.getEarlyReturn()&&O.YoLog.d(O.DebugFlags.DEBUG_PARSING,"Early return: "+t.streamData.getEarlyReturn()),O.YoLog.d(O.DebugFlags.DEBUG_PARSING,`--------------- END PARSING SUMMARY ----------------
`)}}var Iv=function(){function t(){this.clear()}var i=t.prototype;return i.clear=function(){this.adverts=[],this.timelineTrackingMap=new Map,this.trackingEvent=null,this.start=0,this.duration=0,this.position=null,this.breakType=null,this.identifier=null,this.earlyReturn=null,this.adTagUri=null,this.timeOffset=null,this.vastVersion=null},t}(),Ql=function(){function t(){this.clear()}var i=t.prototype;return i.clear=function(){this.id=null,this.sequence=null,this.adType=null,this.properties=[],this.linearCreative=null,this.companionAds=null,this.impressions=null,this.errors=null,this.viewableImpressions=new Map,this.adVerifications=[],this.filler=!1,this.nonLinear=!1,this.topLevelWrapper=null,this.extensions=null,this.processingCompanionCreative=!1,this.currentCreativeType=Xe.NONE,this.nonLinearAds=null,this.adSystemVersion=null,this.advertiserId=null,this.categoryAuthority=null,this.pricingModel=null,this.pricingCurrency=null,this.surveyType=null,this.verificationVendor=null,this.verificationEvents=new Map,this.verificationResources=[],this.verificationApiFramework=null,this.verificationBrowserOptional=null,this.verificationParameters=null,this.verificationResourceType=null,this.extensionStack=[]},t}();st.AdvertData=Ql;var Pv=function(){function t(){this.clear()}var i=t.prototype;return i.clear=function(){this.required=null,this.companions=[]},t}(),Jl=function(){function t(){this.clearAll()}var i=t.prototype;return i.clear=function(){this.clickThroughUrl="",this.clickThroughTrackings=[],this.clickThroughCustoms=[],this.nonLinearResources=[],this.duration=null,this.trackingMap=new Map,this.interactiveTracking=null,this.icons=[],this.currentAssetUri=null,this.skipOffset=null,this.adParameters=null,this.staticResourceCreativeType=null,this.trackingEvent=null,this.htmlResourceEncoded=!1,this.altText=null,this.companionExtensionStack=[],this.companionExtensions=null,this.icSource=null,this.properties=[]},i.clearAll=function(){this.advertId=null,this.id=null,this.sequence=null,this.universalAdIds=[],this.universalAdIdRegistry=null,this.extensions=null,this.extensionStack=[],this.clickThroughTrackings=[],this.clickThroughUrl="",this.adParameters=null,this.trackingEvent=null,this.duration=null,this.trackingMap=new Map,this.interactiveTracking=null,this.icons=[],this.currentAssetUri=null,this.skipOffset=null,this.clickThroughCustoms=[],this.nonLinearResources=[],this.staticResourceCreativeType=null,this.htmlResourceEncoded=null,this.altText=null,this.companionExtensions=null,this.companionExtensionStack=[],this.properties=[],this.icSource=null},t}();st.CreativeData=Jl;var _v=function(){function t(){this.clear()}var i=t.prototype;return i.clear=function(){this.resources=[],this.properties=[],this.clickThroughUrl=null,this.staticResourceCreativeType=null,this.clickTrackings=[],this.clickFallbackImages=[],this.viewTrackings=[],this.htmlResourceEncoded=!1},t}(),$l=function(){function t(){this.clear()}var i=t.prototype;return i.clear=function(){this.properties=[],this.resource=null,this.staticResourceCreativeType=null,this.altText=null},t}(),Lv=function(){function t(){this.clear()}var i=t.prototype;return i.clear=function(){this.nonLinearCreatives=[],this.trackingMap=new Map},t}(),Zl=function(){function t(){this.sessionIdentifier=null,this.duration=0,this.hostNode=null,this.hostSuffix=null,this.pdtInitial=null,this.pdtStart=null,this.pdtEnd=null,this.earlyReturn=null,this.hasPlaceholder=!1}var i=t.prototype;return i.getSessionIdentifier=function(){return this.sessionIdentifier},i.getDuration=function(){return this.duration},i.getHasPlaceholder=function(){return this.hasPlaceholder},i.getHostNode=function(){return this.hostNode},i.getHostSuffix=function(){return this.hostSuffix},i.getPdtInitial=function(){return this.pdtInitial},i.getPdtStart=function(){return this.pdtStart},i.getPdtEnd=function(){return this.pdtEnd},i.getEarlyReturn=function(){return this.earlyReturn},t}();st.StreamData=Zl;var wv=function(){function t(e){this.broker=e,this.skipNormalisation=!1,this.linearAdBreaks=[],this.nonLinearAdBreaks=[],this.displayAdBreaks=[],this.isVmap=!1,this.isValidVAST=!0,this.processingAdvertExtensions=!1,this.processingCreativeExtensions=!1,this.characters="",this.adBreakData=new Iv,this.advertData=new Ql,this.companionAdsData=new Pv,this.creativeData=new Jl,this.iconClickFallbackImageData=new $l,this.iconData=new _v,this.iconFallbackImageData=new $l,this.nonLinearAdsData=new Lv,this.streamData=new Zl,this.onCdata=this.onCdata.bind(this),this.onOpenTag=this.onOpenTag.bind(this),this.onCloseTag=this.onCloseTag.bind(this),this.onText=this.onText.bind(this)}var i=t.prototype;return i.addToCreativeExtensionStack=function(r){this.advertData.processingCompanionCreative?this.creativeData.companionExtensionStack.push(r):this.creativeData.extensionStack.push(r)},i.checkAdBreakForParsingErrors=function(r){if(r.getType()===He.BreakType.LINEAR){if(r.getStart()===-1){var n=new oe.ParsingError(this.adBreakData.identifier,oe.ParsingError.Message.INVALID_START_TIME,oe.ParsingError.Message.INVALID_START_TIME+": "+this.adBreakData.timeOffset);this.broker.addParsingError(n)}if(r.getAdverts().length===0&&r.getTrackingMap().size===0){var a=new oe.ParsingError(this.adBreakData.identifier,oe.ParsingError.Message.EMPTY_ADVERT_AND_TRACKING,"Empty ad break at offset: "+this.adBreakData.timeOffset);this.broker.addParsingError(a)}}},i.checkValidVersion=function(r){var n=parseFloat(r);return!Number.isNaN(n)&&n>=Sv},i.getStreamData=function(){return this.streamData},i.handleCreativeExtensionsForOnEndDefault=function(r){var n=this.advertData.processingCompanionCreative?this.creativeData.companionExtensionStack:this.creativeData.extensionStack,a=n.length;if(a===2)this.pop(!1,!0),this.processingCreativeExtensions=!1;else if(a>0){var o=n[a-1];r===o.getName()&&this.pop(!1,!0)}},i.handleStartAd=function(r){this.advertData.id=r.id;var n=parseInt(r.sequence);this.advertData.sequence=Number.isNaN(n)?0:n,Number.isNaN(n)||(this.advertData.sequence=n),this.advertData.adType=r.adType,He.AdBreak.getBreakTypeFromString(this.adBreakData.breakType)!==He.BreakType.LINEAR&&(this.advertData.nonLinear=!0)},i.handleStartAdWrapper=function(r){var n=r.id?r.id:"",a=r.creativeId?r.creativeId:"",o=r.AdSystem?r.AdSystem:"",s=new Og.AdvertWrapper(n,a,o);this.advertData.topLevelWrapper&&s.setChild(this.advertData.topLevelWrapper),this.advertData.topLevelWrapper=s},i.handleStartCreative=function(r){this.creativeData.advertId=r.adId,this.creativeData.id=r.id;var n=parseInt(r.sequence);this.creativeData.sequence=isNaN(n)?0:n},i.handleStartCreativeExtension=function(r,n){var a=r.type;a=a||"",a.indexOf("com.yospace")===-1&&a.indexOf("AdVerifications")===-1&&(this.processingCreativeExtensions=!0,this.addToCreativeExtensionStack(new or.XmlNode(n.name,(0,sr.objectToMap)(r))))},i.handleStartExtension=function(r,n){var a=r.type;a=a||"",a.indexOf("com.yospace")===-1&&a.indexOf("AdVerifications")===-1&&(this.processingAdvertExtensions=!0,this.advertData.extensionStack.push(new or.XmlNode(n.name,(0,sr.objectToMap)(r))))},i.handleStartExtensionElement=function(r,n){this.processingAdvertExtensions?this.advertData.extensionStack.push(new or.XmlNode(n.name,(0,sr.objectToMap)(r))):this.processingCreativeExtensions&&this.addToCreativeExtensionStack(new or.XmlNode(n.name,(0,sr.objectToMap)(r)))},i.handleStartHtmlResource=function(r){var n=r.xmlEncoded,a=n?n.toUpperCase()==="TRUE"||n==="1":!1;this.iconData.properties.length>0?this.iconData.htmlResourceEncoded=a:this.creativeData.htmlResourceEncoded=a},i.handleStartPricing=function(r){var n=r.model;n?this.advertData.pricingModel=n.toUpperCase():this.advertData.pricingModel="",this.advertData.pricingCurrency=r.currency},i.handleStartStaticResource=function(r){this.iconClickFallbackImageData.properties.length>0?this.iconClickFallbackImageData.staticResourceCreativeType=r.creativeType:this.iconData.properties.length>0?this.iconData.staticResourceCreativeType=r.creativeType:this.creativeData.staticResourceCreativeType=r.creativeType},i.handleStartTracking=function(r){if(this.creativeData.trackingEvent=r.event,this.creativeData.trackingEvent==="progress"){var n=r.offset;(0,Te.isNullOrEmpty)(n)||(this.creativeData.trackingEvent=this.creativeData.trackingEvent+"-"+n)}},i.handleEndAd=function(){var r=new Ng.Advert(this.advertData);if(r.isValid())this.adBreakData.adverts.push(r);else if(!this.advertData.nonLinear&&!this.advertData.linearCreative){var n=new oe.ParsingError(null,oe.ParsingError.Message.MISSING_CREATIVE,"No creative for advert: "+this.advertData.id);this.broker.addParsingError(n)}else if((0,Te.isNullOrEmpty)(r.mediaIdentifier)){var a=new oe.ParsingError(null,oe.ParsingError.Message.INVALID_MEDIAID,"Yospace media identifier could not be parsed (advert id: "+this.advertData.id+")");this.broker.addParsingError(a)}r.isValid()||O.YoLog.w("Invalid advert.  Discarding ("+this.advertData.id+")"),this.advertData.clear()},i.handleAdvertExtensionsForOnEndDefault=function(r){var n=this.advertData.extensionStack.length;if(n===2)this.pop(!0,!0),this.processingAdvertExtensions=!1;else if(n>0){var a=this.advertData.extensionStack[n-1];r===a.getName()&&this.pop(!0,!0)}},i.handleEndAdTitle=function(){var r=this.characters.trim();this.advertData.properties.push(new Ae.VASTProperty("AdTitle",r)),r==="filler"&&(this.advertData.filler=!0)},i.handleEndClickTracking=function(){var r=this.characters.trim();(0,pt.getUrl)(r)?this.creativeData.clickThroughTrackings.push(r):O.YoLog.w("Discarding click tracking URL:"+r)},i.handleEndCompanion=function(){var r=null;(0,Te.isNullOrEmpty)(this.creativeData.clickThroughUrl)||(r=new ar.VideoClicks(this.creativeData.clickThroughUrl,this.creativeData.clickThroughTrackings,null));var n=new Mg.CompanionCreative(this.creativeData,r,this.creativeData.nonLinearResources,this.creativeData.trackingMap,this.broker);n.isValid()?(n.setNonLinear(this.advertData.nonLinear),this.companionAdsData.companions.push(n)):O.YoLog.w("Discarding invalid Companion"),this.creativeData.clear()},i.handleEndCompanionClickTracking=function(){var r=this.characters.trim();(0,pt.getUrl)(r)?this.creativeData.clickThroughTrackings.push(r):O.YoLog.w("Discarding empty Companion click tracking URL")},i.handleEndCreative=function(){switch(this.advertData.currentCreativeType){case Xe.COMPANION:for(var r=Tt(this.advertData.companionAds.companions),n;!(n=r()).done;){var a=n.value;a.postParse(this.creativeData.extensions)}break;case Xe.LINEAR:this.advertData.linearCreative&&this.advertData.linearCreative.postParse(this.creativeData.extensions);break;case Xe.NONLINEAR:for(var o=Tt(this.advertData.nonLinearAds.nonLinearCreatives),s;!(s=o()).done;){var c=s.value;c.postParse(this.creativeData.extensions)}break}this.creativeData.clearAll()},i.handleEndCustomClick=function(){var r=this.characters.trim();r!==""?this.creativeData.clickThroughCustoms.push(r):O.YoLog.w("Discarding empty custom click URL")},i.handleEndError=function(r){var n=this.characters.trim();(0,pt.getUrl)(n)?this.advertData.errors?this.advertData.errors.addTrackingUrl(n):this.advertData.errors=new Me.TrackingReport(r,[n]):O.YoLog.w("Discarding empty Error")},i.handleEndExecutableResource=function(){if(this.advertData.verificationApiFramework&&this.advertData.verificationResourceType){var r=new Ae.VASTProperty("ExecutableResource",this.characters.trim(),"apiFramework",this.advertData.verificationApiFramework);r.addAttribute("type",this.advertData.verificationResourceType),this.advertData.verificationResources.push(r)}this.advertData.verificationApiFramework=null,this.advertData.verificationResourceType=null},i.handleEndIcon=function(){var r=null;(!(0,Te.isNullOrEmpty)(this.iconData.clickThroughUrl)||this.iconData.viewTrackings.length>0)&&((0,Te.isNullOrEmpty)(this.iconData.clickThroughUrl)?r=new ar.VideoClicks(null,null,this.iconData.viewTrackings):r=new ar.VideoClicks(this.iconData.clickThroughUrl,this.iconData.clickTrackings,this.iconData.viewTrackings));var n=new Ug.IndustryIcon(this.iconData.properties,this.iconData.resources,r,this.iconData.clickFallbackImages,this.broker);n.isValid()?this.creativeData.icons.push(n):O.YoLog.w("Discarding invalid Icon"),this.iconData.clear()},i.handleEndIFrameResource=function(){var r=this.characters.trim();this.iconData.properties.length>0?this.iconData.resources.push(new Ce.Resource(Ce.ResourceType.IFRAME,r)):this.creativeData.nonLinearResources.push(new Ce.Resource(Ce.ResourceType.IFRAME,r))},i.handleEndExtensionElement=function(r){this.processingAdvertExtensions?this.handleAdvertExtensionsForOnEndDefault(r):this.handleCreativeExtensionsForOnEndDefault(r)},i.handleEndHtmlResource=function(){if(this.iconData.properties.length>0){var r=this.characters.trim();this.iconData.resources.push(new Ce.Resource(Ce.ResourceType.HTML,r,null,this.iconData.htmlResourceEncoded))}else this.creativeData.nonLinearResources.push(new Ce.Resource(Ce.ResourceType.HTML,this.characters,null,this.creativeData.htmlResourceEncoded))},i.handleEndIconClickFallbackImage=function(){var r=new Bg.IconClickFallbackImage(this.iconClickFallbackImageData.properties,this.iconClickFallbackImageData.altText,this.iconClickFallbackImageData.resource);r.isValid()?this.iconData.clickFallbackImages.push(r):O.YoLog.w("Discarding invalid IconClickFallbackImage"),this.iconClickFallbackImageData.clear()},i.handleEndIconClickTracking=function(){var r=this.characters.trim();(0,pt.getUrl)(r)?this.iconData.clickTrackings.push(r):O.YoLog.w("Discarding empty Icon click tracking URL")},i.handleEndIconViewTracking=function(){var r=this.characters.trim();(0,pt.getUrl)(r)?this.iconData.viewTrackings.push(r):O.YoLog.w("Discarding empty Icon view tracking URL")},i.handleEndInteractiveTracking=function(){this.creativeData.interactiveTracking?this.creativeData.interactiveTracking.addTrackingUrl(this.characters.trim()):this.creativeData.interactiveTracking=new Me.TrackingReport(this.creativeData.trackingEvent,[this.characters.trim()])},i.handleEndLinear=function(){var r=null;(!(0,Te.isNullOrEmpty)(this.creativeData.clickThroughUrl)||this.creativeData.clickThroughCustoms.length>0)&&((0,Te.isNullOrEmpty)(this.creativeData.clickThroughUrl)?r=new ar.VideoClicks(null,null,this.creativeData.clickThroughCustoms):r=new ar.VideoClicks(this.creativeData.clickThroughUrl,this.creativeData.clickThroughTrackings,this.creativeData.clickThroughCustoms));var n=null;this.creativeData.properties.length>0&&(n=new Fg.InteractiveCreative(this.creativeData.icSource,this.creativeData.properties,this.broker,this.creativeData.interactiveTracking),n.isValid()||(O.YoLog.w("Discarding invalid InteractiveCreative"),n=null));var a=new Vg.LinearCreative(this.creativeData,r,n,this.broker);a.isValid()?this.advertData.linearCreative=a:O.YoLog.w("Discarding invalid LinearCreative"),this.creativeData.clear()},i.handleEndImpression=function(r){var n=this.characters.trim();(0,pt.getUrl)(n)?this.advertData.impressions?this.advertData.impressions.addTrackingUrl(n):this.advertData.impressions=new Me.TrackingReport(r,[n]):O.YoLog.w("Discarding empty Impression")},i.handleEndInteractiveCreativeFile=function(){this.creativeData.icSource=this.characters.trim()},i.handleEndJavaScriptResource=function(){if(this.advertData.verificationApiFramework&&this.advertData.verificationBrowserOptional){var r=new Ae.VASTProperty(po,this.characters.trim(),"apiFramework",this.advertData.verificationApiFramework);r.addAttribute("browserOptional",this.advertData.verificationBrowserOptional),this.advertData.verificationResources.push(r)}this.advertData.verificationApiFramework=null,this.advertData.verificationBrowserOptional=null},i.handleEndMediaFile=function(){this.creativeData.properties.length!==0?this.creativeData.icSource=this.characters.trim():this.creativeData.currentAssetUri=this.characters.trim()},i.handleEndNonLinearClickTracking=function(){var r=this.characters.trim();(0,pt.getUrl)(r)?this.creativeData.clickThroughTrackings.push(r):O.YoLog.w("Discarding empty Nonlinear click tracking URL")},i.handleEndPricing=function(){var r=this.characters.trim();if(r!==""){var n=new Ae.VASTProperty(uo,r,"currency",this.advertData.pricingCurrency);n.addAttribute("model",this.advertData.pricingModel),!(0,Te.isNullOrEmpty)(this.advertData.pricingCurrency)&&!(0,Te.isNullOrEmpty)(this.advertData.pricingModel)?this.advertData.properties.push(n):O.YoLog.w("Discarding invalid Pricing property")}else O.YoLog.w("Discarding invalid Pricing property")},i.handleEndUniversalAdId=function(){var r=this.characters.trim();r!==""?this.creativeData.universalAdIds.push(new Ae.VASTProperty(ho,r,"idRegistry",this.creativeData.universalAdIdRegistry)):O.YoLog.w("Discarding empty UniversalAdId URL")},i.handleEndVerification=function(){var r=new Hg.AdVerification(this.advertData);r.isValid()?this.advertData.adVerifications.push(r):O.YoLog.w("Discarding invalid AdVerification"),this.advertData.verificationEvents=new Map,this.advertData.verificationResources=[],this.advertData.verificationParameters=null},i.handleEndVmapTracking=function(){var r=this.characters.trim();if(!Me.TrackingReport.isValidAdBreakEvent(this.adBreakData.trackingEvent))O.YoLog.d(O.DebugFlags.DEBUG_PARSING,"Discarding invalid vmap:Tracking event");else if((0,Te.isNullOrEmpty)(r))O.YoLog.w("Discarding empty VMAP");else{var n=this.adBreakData.timelineTrackingMap.get(this.adBreakData.trackingEvent);n?n.addTrackingUrl(r):(n=new Me.TrackingReport(this.adBreakData.trackingEvent,[r]),this.adBreakData.timelineTrackingMap.set(this.adBreakData.trackingEvent,n))}},i.handleEndNonLinear=function(){var r=null;this.creativeData.clickThroughUrl&&this.creativeData.clickThroughUrl!==""&&(r=new ar.VideoClicks(this.creativeData.clickThroughUrl,this.creativeData.clickThroughTrackings,null));var n=new Yg.NonLinearCreative(this.creativeData,r,this.creativeData.nonLinearResources,this.broker);n.isValid()?(n.setNonLinear(this.advertData.nonLinear),this.nonLinearAdsData.nonLinearCreatives.push(n)):O.YoLog.w("Discarding invalid NonLinear"),this.creativeData.clear()},i.handleEndStaticResource=function(){var r=this.characters.trim();if(this.iconClickFallbackImageData.properties.length>0){var n=new Ce.Resource(Ce.ResourceType.STATIC,r,this.iconClickFallbackImageData.staticResourceCreativeType);if(n.isValid()){this.iconClickFallbackImageData.resource=n;return}}else if(this.iconData.properties.length>0){var a=new Ce.Resource(Ce.ResourceType.STATIC,r,this.iconData.staticResourceCreativeType);if(a.isValid()){this.iconData.resources.push(a);return}}else{var o=new Ce.Resource(Ce.ResourceType.STATIC,r,this.creativeData.staticResourceCreativeType);if(o.isValid()){this.creativeData.nonLinearResources.push(o);return}}O.YoLog.w("Discarding invalid StaticResource")},i.handleEndTracking=function(){var r=this.characters.trim();if((0,Te.isNullOrEmpty)((0,pt.getUrl)(r))){O.YoLog.w("Discarding empty tracking URL");var a=new oe.ParsingError(null,oe.ParsingError.Message.INVALID_TRACKING_URL,"Bad tracking url:"+r+" event: "+this.creativeData.trackingEvent);this.broker.addParsingError(a)}else{var n=null;Me.TrackingReport.isValidVerificationEvent(this.creativeData.trackingEvent)?n=this.advertData.verificationEvents:this.advertData.currentCreativeType===Xe.LINEAR&&Me.TrackingReport.isValidLinearEvent(this.creativeData.trackingEvent)||this.creativeData.trackingEvent.indexOf("progress")===0?n=this.creativeData.trackingMap:this.advertData.currentCreativeType===Xe.LINEAR&&Me.TrackingReport.isValidInteractiveEvent(this.creativeData.trackingEvent)?this.handleEndInteractiveTracking():this.advertData.currentCreativeType===Xe.COMPANION&&Me.TrackingReport.isValidCompanionEvent(this.creativeData.trackingEvent)?n=this.creativeData.trackingMap:this.advertData.currentCreativeType===Xe.NONLINEAR&&Me.TrackingReport.isValidNonLinearEvent(this.creativeData.trackingEvent)&&(n=this.nonLinearAdsData.trackingMap),n&&this.parseMapForOnEndTracking(n)}},i.handleEndViewableImpression=function(r){var n=this.characters.trim();if((0,Te.isNullOrEmpty)((0,pt.getUrl)(n)))O.YoLog.w("Discarding empty ViewableImpression URL");else{var a=this.advertData.viewableImpressions.get(r);a?a.addTrackingUrl(n):(a=new Me.TrackingReport(r,[n]),this.advertData.viewableImpressions.set(r,a))}},i.handleTextDataForExtensions=function(){var r=this.characters.trim();if(r!==""){var n=[];if(this.processingAdvertExtensions?n=this.advertData.extensionStack:n=this.advertData.processingCompanionCreative?this.creativeData.companionExtensionStack:this.creativeData.extensionStack,n.length>0){var a=n[n.length-1];a.setInnerText(r)}}},i.handleVmapAdBreak=function(){if(this.adBreakData.earlyReturn!==null){this.streamData.earlyReturn=this.adBreakData.earlyReturn,this.adBreakData.clear();return}He.AdBreak.getBreakTypeFromString(this.adBreakData.breakType)===He.BreakType.LINEAR&&!this.skipNormalisation&&(this.adBreakData.start=this.broker.normaliseAdBreakStart(this.adBreakData.start,this.adBreakData.position));var r=new He.AdBreak(this.adBreakData.start,this.adBreakData.duration,this.adBreakData.position,this.adBreakData.timelineTrackingMap,this.adBreakData.breakType,this.adBreakData.identifier,null,this.adBreakData.adTagUri);if(this.adBreakData.adverts.length>0&&r.setAdverts(this.adBreakData.adverts),r.postParse(this.broker),r.isValid()){var n=He.AdBreak.getBreakTypeFromString(this.adBreakData.breakType);switch(n){case He.BreakType.LINEAR:this.linearAdBreaks.push(r);break;case He.BreakType.NONLINEAR:this.nonLinearAdBreaks.push(r);break;case He.BreakType.DISPLAY:this.displayAdBreaks.push(r);break}}else{var a=this.streamData.hasPlaceholder?" placeholder ":" ";O.YoLog.w("Discarding empty"+a+"ad break"),this.checkAdBreakForParsingErrors(r)}this.adBreakData.clear()},i.handleVmapAdTagURI=function(){this.streamData.hasPlaceholder=!0,this.adBreakData.adTagUri=this.characters.trim()},i.handleStartYospaceAdBreak=function(r){var n=r.duration,a=-1;if(n&&(this.adBreakData.duration=(0,Bt.timeStringToMillis)(n,a)),He.AdBreak.getBreakTypeFromString(this.adBreakData.breakType)===He.BreakType.LINEAR&&this.adBreakData.duration===a){var o=new oe.ParsingError(this.adBreakData.identifier,oe.ParsingError.Message.INVALID_DURATION,oe.ParsingError.Message.INVALID_DURATION+": "+n);this.broker.addParsingError(o)}var s=r.position;s&&(this.adBreakData.position=s);var c=r.earlyReturn;if(c){var d=(0,Bt.timeStringToMillis)(c,a);this.adBreakData.earlyReturn=d!==a?d+this.adBreakData.start:-1}},i.handleYospaceStream=function(r){var n=r.urlDomain;n&&(this.streamData.hostNode=n);var a=r.urlSuffix;a&&(this.streamData.hostSuffix=a);var o=r.duration;if(o){var s=(0,Bt.timeStringToMillis)(r.duration,0);s&&(this.streamData.duration=s)}if(this.streamData.hostSuffix){var c=this.streamData.hostSuffix.match(bv);c&&(this.streamData.sessionIdentifier=c[1])}this.streamData.pdtInitial=(0,Bt.pdtToMillis)(r.pdtinitial,null),this.streamData.pdtStart=(0,Bt.pdtToMillis)(r.pdtstart,null),this.streamData.pdtEnd=(0,Bt.pdtToMillis)(r.pdtend,null),(this.streamData.pdtStart===null||this.streamData.pdtEnd===null||this.streamData.pdtStart>this.streamData.pdtEnd)&&(this.streamData.pdtStart=null,this.streamData.pdtEnd=null,this.streamData.pdtInitial=null)},i.onCdata=function(r){this.characters=r,(this.processingAdvertExtensions||this.processingCreativeExtensions)&&this.handleTextDataForExtensions()},i.onOpenTag=function(r){var n=r.attributes;if(this.processingAdvertExtensions||this.processingCreativeExtensions){this.handleStartExtensionElement(n,r);return}if(r.name===hv&&(this.isVmap=!0),r.name===pv&&this.handleYospaceStream(n),r.name===Dl){this.adBreakData.timeOffset=n.timeOffset,this.adBreakData.timeOffset&&(this.adBreakData.start=(0,Bt.timeStringToMillis)(this.adBreakData.timeOffset,-1));var a=n.breakType;a&&(this.adBreakData.breakType=a);var o=n.breakId;o&&(this.adBreakData.identifier=o)}r.name===fv&&this.handleStartYospaceAdBreak(n),r.name===Rl&&(this.adBreakData.trackingEvent=n.event),r.name===gv&&(this.adBreakData.vastVersion=n.version,this.checkValidVersion(this.adBreakData.vastVersion)||(O.YoLog.e("Invalid or missing VAST version; is AV tag defined?"),this.isValidVAST=!1)),r.name===Ll&&this.handleStartAd(n),r.name===vv&&this.handleStartAdWrapper(n),r.name===so&&(this.advertData.categoryAuthority=n.authority),r.name===Nl&&(this.advertData.adSystemVersion=n.version),r.name===lo&&(this.advertData.advertiserId=n.id),r.name===co&&(this.advertData.surveyType=n.type),r.name===uo&&this.handleStartPricing(n),r.name===ho&&(this.creativeData.universalAdIdRegistry=n.idRegistry),r.name===Ol&&this.advertData.extensionStack.push(new or.XmlNode(r.name,(0,sr.objectToMap)(n))),r.name===Ml&&this.handleStartCreative(n),r.name===Bl&&(this.advertData.currentCreativeType=Xe.LINEAR,this.creativeData.skipOffset=n.skipoffset),r.name===Ul&&this.populateIconPropertyList(n),r.name===Fl&&this.populateIconClickFallbackImagePropertyList(n),r.name===fo&&(this.creativeData.adParameters=new Ae.VASTProperty(fo,null,"xmlEncoded",n.xmlEncoded)),r.name===Vl&&this.populateInteractiveCreativePropertyList(n),r.name===xl&&(this.advertData.currentCreativeType=Xe.NONLINEAR),r.name===Yl&&this.populateNonLinearPropertyList(n),r.name===Hl&&(this.advertData.currentCreativeType=Xe.COMPANION,this.advertData.processingCompanionCreative=!0,this.companionAdsData.required=n.required),r.name===ql&&this.populateCompanionPropertyList(n),r.name===Gl&&this.handleStartStaticResource(n),r.name===jl&&this.handleStartHtmlResource(n),r.name===Wl&&this.handleStartTracking(n),r.name===Kl&&(this.advertData.verificationVendor=n.vendor),r.name===po&&(this.advertData.verificationApiFramework=n.apiFramework,this.advertData.verificationBrowserOptional=n.browserOptional),r.name===zl&&(this.advertData.verificationApiFramework=n.apiFramework,this.advertData.verificationResourceType=n.type),r.name===Ev&&this.handleStartExtension(n,r),r.name===Xl&&this.addToCreativeExtensionStack(new or.XmlNode(r.name,(0,sr.objectToMap)(n))),r.name===Av&&this.handleStartCreativeExtension(n,r),r.isSelfClosing&&this.onCloseTag(r)},i.onCloseTag=function(r){if(this.processingAdvertExtensions||this.processingCreativeExtensions){this.handleEndExtensionElement(r),this.characters="";return}r===Dl&&this.handleVmapAdBreak(),r===Rl&&this.handleEndVmapTracking(),r===Ll&&this.handleEndAd(),r===Nl&&this.advertData.properties.push(new Ae.VASTProperty("AdSystem",this.characters.trim(),"version",this.advertData.adSystemVersion)),r===Kg&&this.handleEndAdTitle(),r===yv&&this.handleEndImpression(r),r===wl&&this.advertData.properties.push(new Ae.VASTProperty(wl,this.characters.trim())),r===so&&this.advertData.properties.push(new Ae.VASTProperty(so,this.characters.trim(),"authority",this.advertData.categoryAuthority)),r===Cl&&this.advertData.properties.push(new Ae.VASTProperty(Cl,this.characters.trim())),r===lo&&this.advertData.properties.push(new Ae.VASTProperty(lo,this.characters.trim(),"id",this.advertData.advertiserId)),r===co&&this.advertData.properties.push(new Ae.VASTProperty(co,this.characters.trim(),"type",this.advertData.surveyType)),r===tv&&this.handleEndError(r),r===uo&&this.handleEndPricing(),r===ho&&this.handleEndUniversalAdId(),r===Ol&&this.pop(!0,!1),r===Xl&&this.pop(!1,!1),r===Kl&&this.handleEndVerification(),r===cv&&(this.advertData.verificationParameters=this.characters.trim()),r===mv&&this.handleEndMediaFile(),r===Vl&&this.handleEndInteractiveCreativeFile(),(r===Xg||r===ov||r===Qg)&&(this.creativeData.clickThroughUrl=this.characters.trim()),r===rv&&(this.iconData.clickThroughUrl=this.characters.trim()),r===$g&&this.handleEndClickTracking(),r===sv&&this.handleEndNonLinearClickTracking(),r===Jg&&this.handleEndCompanionClickTracking(),r===iv&&this.handleEndIconClickTracking(),r===Fl&&this.handleEndIconClickFallbackImage(),r===zg&&(this.iconClickFallbackImageData.properties.length>0?this.iconClickFallbackImageData.altText=this.characters.trim():this.creativeData.altText=this.characters.trim()),r===Zg&&this.handleEndCustomClick(),r===nv&&this.handleEndIconViewTracking(),r===Ml&&this.handleEndCreative(),r===Bl&&this.handleEndLinear(),r===xl&&(this.advertData.nonLinearAds=new xg.NonLinearAds(this.nonLinearAdsData.trackingMap,this.nonLinearAdsData.nonLinearCreatives),this.nonLinearAdsData.clear()),r===Yl&&this.handleEndNonLinear(),r===Hl&&(this.advertData.companionAds=new qg.CompanionAds(this.companionAdsData.required,this.companionAdsData.companions),this.companionAdsData.clear(),this.advertData.processingCompanionCreative=!1),r===ql&&this.handleEndCompanion(),r===Ul&&this.handleEndIcon(),r===fo&&this.creativeData.adParameters.setValue(this.characters.trim()),r===ev&&(this.creativeData.duration=this.characters.trim()),(r===uv||r===lv||r===dv)&&this.handleEndViewableImpression(r),r===Gl&&this.handleEndStaticResource(),r===jl&&this.handleEndHtmlResource(),r===av&&this.handleEndIFrameResource(),r===Wl&&this.handleEndTracking(),r===po&&this.handleEndJavaScriptResource(),r===zl&&this.handleEndExecutableResource(),r===Tv&&this.handleVmapAdTagURI()},i.onText=function(r){this.characters=r,(this.processingAdvertExtensions||this.processingCreativeExtensions)&&this.handleTextDataForExtensions()},t.parse=function(r,n,a){var o=new t(n);return o.parse(r,a)},i.parse=function(r,n){var a=this;this.skipNormalisation=n&&n.skipNormalisation?n.skipNormalisation:!1;var o=!1;return new Promise(function(s,c){try{var d=Rg.default.parser(!0);d.onerror=function(f){o=!0,O.YoLog.e("Failed to parse document: "+f),a.broker.addParsingError(new oe.ParsingError(null,oe.ParsingError.Message.BAD_XML,f.message)),s(null)},d.ontext=a.onText,d.onopentag=a.onOpenTag,d.onclosetag=a.onCloseTag,d.oncdata=a.onCdata,d.write(r).close();var p=null;if(o)return;if(a.isVmap){if(!a.isValidVAST){a.broker.addParsingError(new oe.ParsingError(null,oe.ParsingError.Message.INCORRECT_VAST_VERSION,"Version is "+a.adBreakData.vastVersion+", expected >= 4.2")),O.YoLog.e("Failed to parse document.  VAST not valid"),s(null);return}}else{a.broker.addParsingError(new oe.ParsingError(null,oe.ParsingError.Message.NO_VMAP)),O.YoLog.e("Failed to parse document.  VMAP not found"),s(null);return}kv(a),p=new Gg.AnalyticPayload(a,r.toString()),s(p)}catch(f){a.broker.addParsingError(new oe.ParsingError(null,oe.ParsingError.Message.BAD_XML,f.message)),c(f)}})},i.parseMapForOnEndTracking=function(r){var n=this.characters.trim(),a=r.get(this.creativeData.trackingEvent);a?a.addTrackingUrl(n):(this.creativeData.trackingEvent.indexOf("progress")!==-1?a=new Me.TrackingReport("progress",[n]):a=new Me.TrackingReport(this.creativeData.trackingEvent,[n]),r.set(this.creativeData.trackingEvent,a))},i.pop=function(r,n){var a=[];r?a=this.advertData.extensionStack:a=this.advertData.processingCompanionCreative?this.creativeData.companionExtensionStack:this.creativeData.extensionStack;var o=a.pop();n?a[a.length-1].addChild(o):r?this.advertData.extensions=o:this.advertData.processingCompanionCreative?this.creativeData.companionExtensions=o:this.creativeData.extensions=o},i.populateCompanionProperty=function(r,n){this.populateCreativeProperty(r,n)},i.populateCompanionPropertyList=function(r){this.populateCompanionProperty(r,"id"),this.populateCompanionProperty(r,"width"),this.populateCompanionProperty(r,"height"),this.populateCompanionProperty(r,"assetWidth"),this.populateCompanionProperty(r,"assetHeight"),this.populateCompanionProperty(r,"expandedWidth"),this.populateCompanionProperty(r,"expandedHeight"),this.populateCompanionProperty(r,"apiFramework"),this.populateCompanionProperty(r,"adSlotId"),this.populateCompanionProperty(r,"pxratio"),this.populateCompanionProperty(r,"renderingMode")},i.populateCreativeProperty=function(r,n){var a=r[n];(0,Te.isNullOrEmpty)(a)||this.creativeData.properties.push(new Ae.VASTProperty(n,a))},i.populateIconProperty=function(r,n){var a=r[n];(0,Te.isNullOrEmpty)(a)||this.iconData.properties.push(new Ae.VASTProperty(n,a))},i.populateIconPropertyList=function(r){this.populateIconProperty(r,"width"),this.populateIconProperty(r,"height"),this.populateIconProperty(r,"program"),this.populateIconProperty(r,"xPosition"),this.populateIconProperty(r,"yPosition"),this.populateIconProperty(r,"offset"),this.populateIconProperty(r,"duration"),this.populateIconProperty(r,"apiFramework"),this.populateIconProperty(r,"pxratio")},i.populateIconClickFallbackImageProperty=function(r,n){var a=r[n];(0,Te.isNullOrEmpty)(a)||this.iconClickFallbackImageData.properties.push(new Ae.VASTProperty(n,a))},i.populateIconClickFallbackImagePropertyList=function(r){this.populateIconClickFallbackImageProperty(r,"width"),this.populateIconClickFallbackImageProperty(r,"height")},i.populateInteractiveCreativeProperty=function(r,n){this.populateCreativeProperty(r,n)},i.populateInteractiveCreativePropertyList=function(r){this.populateInteractiveCreativeProperty(r,"apiFramework"),this.populateInteractiveCreativeProperty(r,"type");var n=r.variableDuration;(0,Te.isNullOrEmpty)(n)?this.creativeData.properties.push(new Ae.VASTProperty("variableDuration","false")):this.populateInteractiveCreativeProperty(r,"variableDuration")},i.populateNonLinearProperty=function(r,n){this.populateCreativeProperty(r,n)},i.populateNonLinearPropertyList=function(r){this.populateNonLinearProperty(r,"id"),this.populateNonLinearProperty(r,"width"),this.populateNonLinearProperty(r,"height"),this.populateNonLinearProperty(r,"expandedWidth"),this.populateNonLinearProperty(r,"expandedHeight"),this.populateNonLinearProperty(r,"scalable"),this.populateNonLinearProperty(r,"maintainAspectRatio"),this.populateNonLinearProperty(r,"apiFramework"),this.populateNonLinearProperty(r,"minSuggestedDuration")},t}();st.Parser=wv});var nc=D(pn=>{"use strict";pn.__esModule=!0;pn.SessionDVRLive=void 0;var Cv=Ya(),Dv=io(),Rv=Rr(),ec=no(),Nv=Ct(),tc=ao(),Ov=hn(),fn=et(),rc=X(),x=J(),go=Ht(),F=Ve(),Mv=si(),Bv=Ne(),Uv=br();function Fv(t,i){var e=typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e)return(e=e.call(t)).next.bind(e);if(Array.isArray(t)||(e=Vv(t))||i&&t&&typeof t.length=="number"){e&&(t=e);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vv(t,i){if(t){if(typeof t=="string")return ic(t,i);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return ic(t,i)}}function ic(t,i){(i==null||i>t.length)&&(i=t.length);for(var e=0,r=new Array(i);e<i;e++)r[e]=t[e];return r}function xv(t,i){t.prototype=Object.create(i.prototype),t.prototype.constructor=t,vo(t,i)}function vo(t,i){return vo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},vo(t,i)}var Yv=function(t){xv(i,t);function i(r){var n;return n=t.call(this,r)||this,n.streamStart=F.INVALID_WINDOW,n.manifestData=new Map,n.windowStart=F.INVALID_WINDOW,n.windowEnd=F.INVALID_WINDOW,n.windowSize=F.INVALID_WINDOW,n.pausePoller=null,n.pauseUrl="",n.targetDuration=Bv.Constant.DEFAULT_POLLING_DELAY,n.setPlaybackPolicyHandler(new Uv.DefaultPlaybackPolicyHandler(F.PlaybackMode.DVRLIVE)),n}i.create=function(n,a,o){var s=new i(a);if(o)s.initialiseFromSession(n).then(function(){x.YoLog.d(x.DebugFlags.DEBUG_LIFECYCLE,"Session initialised")}).catch(function(){x.YoLog.d(x.DebugFlags.DEBUG_LIFECYCLE,"Session failed to initialise")}).finally(function(){o(new Rv.Event(s))});else return s.initialiseFromSession(n)};var e=i.prototype;return e.initialiseFromSession=function(n){var a=this;return new Promise(function(o,s){if(x.YoLog.trace("sdk init"),!(0,fn.getUrl)(n)){a.completeWithStatus(F.SessionState.FAILED,F.MALFORMED_URL),s(a);return}Nv.HttpConnection.get(n,{method:"GET"},a.sessionProperties.getRequestTimeout(),a.sessionProperties.getCustomHttpHeaders()).then(function(c){if(c.ok){var d=c.headers.get("content-type");if(d&&d.toLowerCase().includes("application/json"))a.handleFallbackUrl(c.body)?o(a):s(a);else{var p=c.url,f=a.parseManifestResponse(c.body,p);a.setPlaybackUrl(p),a.initialiseFromPayload(f),a.getSessionState()!==F.SessionState.INITIALISED&&a.getSessionState()!==F.SessionState.NO_ANALYTICS&&s(a),a.getSessionState()===F.SessionState.INITIALISED&&a.initialisePoller(),o(a)}}else c.timeout?(x.YoLog.e("Primary Url request failed: "+n+", reason: timeout"),a.completeWithStatus(F.SessionState.FAILED,F.CONNECTION_TIMEOUT)):(x.YoLog.e("Primary Url request failed: "+n+", status: "+c.status+", error: "+c.statusText),a.completeWithStatus(F.SessionState.FAILED,c.status)),s(a)})})},e.getDuration=function(){return this.windowEnd},e.getPauseUrl=function(){return this.pauseUrl},e.getStreamStart=function(){return this.streamStart},e.getManifestData=function(n){return n?this.manifestData.get(n):this.manifestData},e.getWindowStart=function(){return this.windowStart},e.getWindowEnd=function(){return this.windowEnd},e.getWindowSize=function(){return this.windowSize},e.removeExpiredAdBreaks=function(){for(var n=this.streamStart===F.INVALID_WINDOW?this.getPlayhead():this.windowStart,a=this.getAdBreakForPlayhead(this.getPlayhead()),o=this.linearAdBreaks.length-1;o>=0;o--){var s=this.linearAdBreaks[o];if(s.getStart()+s.getDuration()<=n){if(x.YoLog.d(x.DebugFlags.DEBUG_LIFECYCLE,"Removing ad break.  Start: "+s.getStart()+"; duration: "+s.getDuration()),s===a){x.YoLog.d(x.DebugFlags.DEBUG_LIFECYCLE,"Removing the current adbreak");var c=a.getAdvertFromPlayhead(this.getPlayhead());c&&c.setInactive(),this.onAdvertEnd(),this.onAdvertBreakEnd()}this.linearAdBreaks.splice(o,1)}}},e.shutdown=function(){t.prototype.shutdown.call(this),this.analyticPoller&&(this.analyticPoller.shutdown(),this.analyticPoller=null),this.pausePoller&&(this.pausePoller.shutdown(),this.pausePoller=null),x.YoLog.d(x.DebugFlags.DEBUG_LIFECYCLE,"resources released")},e.getPlaybackMode=function(){return F.PlaybackMode.DVRLIVE},e.initialisePoller=function(){var n=this;!this.getAnalyticsUrl()||!this.pauseUrl||this.getSessionState()!==F.SessionState.INITIALISED||(this.analyticPoller=new tc.UrlPoller(this.getAnalyticsUrl(),this.getSessionProperties().getRequestTimeout(),function(a,o){a.status===400?n.onSessionError(F.SessionErrorCode.TIMEOUT):a.ok&&(n.targetDuration=o,n.parseAnalyticPayload(a.body))}),this.pausePoller=new tc.UrlPoller(this.pauseUrl,this.getSessionProperties().getRequestTimeout(),null))},e.hasAnalyticUpdateChanged=function(n){return this.getLastAnalyticUpdate()&&this.getLastAnalyticUpdate().isEqualTo(n)?(x.YoLog.d(x.DebugFlags.DEBUG_PARSING,"Content unchanged.  Analytic update not delivered"),!1):!0},e.adjustForPdtInitial=function(n){if(this.streamStart===F.INVALID_WINDOW){var a=n.getPdtInitial();a!==null&&(this.streamStart=a,this.manifestData.get("availabilityStartTime")||this.manifestData.set("availabilityStartTime",new Date(a)))}},e.handlePdtStartEnd=function(n){var a=!1,o=n.getPdtStart(),s=n.getPdtEnd();if(o!==null&&s!==null){var c=o,d=s;this.streamStart===F.INVALID_WINDOW&&(this.streamStart=c);var p=c-this.streamStart,f=d-this.streamStart;(p!==this.windowStart||f!==this.windowEnd)&&(a=!0,this.windowStart=p,this.windowEnd=f,this.windowSize=this.windowEnd-this.windowStart)}else x.YoLog.w("PDT start/end value(s) invalid or missing");return a},e.updateAdBreaks=function(n){var a=n.getLinearAdBreaks(),o=n.getNonLinearAdBreaks(),s=n.getDisplayAdBreaks(),c=a.length,d=o.length,p=s.length;Array.prototype.push.apply(this.linearAdBreaks,a),Array.prototype.push.apply(this.nonLinearAdBreaks,o),this.streamStart===F.INVALID_WINDOW?x.YoLog.d(x.DebugFlags.DEBUG_PARSING,"Received "+c+" linear, "+d+" nonlinear "+p+" display ad breaks"):x.YoLog.d(x.DebugFlags.DEBUG_PARSING,"Received: "+c+" linear, "+d+" nonlinear  "+p+" display ad breaks. New window start: "+this.windowStart+", end: "+this.windowEnd+" (total: "+this.windowSize+")"),this.removeExpiredAdBreaks()},e.parseAnalyticPayload=function(n){var a=this;return this.clearParsingErrors(),Ov.Parser.parse(n,this).then(function(o){if(a.parsingErrors.length>0&&a.getReportsManager().raiseSessionErrorCallback(F.SessionErrorCode.PARSING_ERROR,a),!o)return null;if(!a.hasAnalyticUpdateChanged(o))return o;var s=o.getEarlyReturn();s&&s!==-1&&a.adjustForEarlyReturn(s),a.adjustForPdtInitial(o);var c=a.handlePdtStartEnd(o);return a.updateAdBreaks(o),(a.streamStart!==F.INVALID_WINDOW&&c||o.hasAdBreaks())&&(x.YoLog.trace("sdk analytics "+o.getLinearAdBreaks().length+" "+o.getNonLinearAdBreaks().length+" "+o.getDisplayAdBreaks().length+" "+a.getDuration()),a.setLastAnalyticUpdate(o),a.getReportsManager().raiseAnalyticUpdateCallback(a)),o}).catch(function(o){x.YoLog.d(x.DebugFlags.DEBUG_POLLING,"Analytic Poll completed with unreadable data: "+o),a.parsingErrors.length>0&&a.getReportsManager().raiseSessionErrorCallback(F.SessionErrorCode.PARSING_ERROR,a)})},e.setAdBreaksInactivePriorTo=function(n){for(var a=Fv(this.linearAdBreaks),o;!(o=a()).done;){var s=o.value;if(!s.setAdvertsInactivePriorTo(n))break}},e.setStreamStart=function(n){this.streamStart=n},e.parseManifestResponse=function(n,a){var o=n;return ec.HlsManifestParser.isHlsManifest(o)?(x.YoLog.d(x.DebugFlags.DEBUG_PARSING,"Processing HLS master manifest: "+a),ec.HlsManifestParser.parse(o)):(x.YoLog.d(x.DebugFlags.DEBUG_PARSING,"Processing DASH manifest: "+a),Dv.DashManifestParser.parse(o))},e.initialiseFromPayload=function(n){n?(0,rc.isNullOrEmpty)(n.getAnalyticUrl())?(x.YoLog.w("Analytics URL not found in manifest payload"),this.completeWithStatus(F.SessionState.NO_ANALYTICS,0)):(0,fn.getUrl)(n.getAnalyticUrl())?(0,fn.getUrl)(n.getPlaybackUrl())?(this.setPlaybackUrl(n.getPlaybackUrl()),(0,rc.isNullOrEmpty)(n.getPauseUrl())?(x.YoLog.e("Pause URL not found in manifest"),this.completeWithStatus(F.SessionState.NO_ANALYTICS,F.NO_DVRLIVE)):(0,fn.getUrl)(n.getPauseUrl())?(this.setIdentifier(n.getSessionIdentifier()),this.setAnalyticsUrl(n.getAnalyticUrl()),this.pauseUrl=n.getPauseUrl(),this.manifestData.set("availabilityStartTime",n.getAvailabilityStartTime()),this.completeWithStatus(F.SessionState.INITIALISED,0),x.YoLog.d(x.DebugFlags.DEBUG_LIFECYCLE,"Successful. Url: "+this.getPlaybackUrl())):(x.YoLog.w("Malformed pause URL in manifest"),this.completeWithStatus(F.SessionState.NO_ANALYTICS,F.NO_DVRLIVE))):(x.YoLog.w("Player URL is invalid: "+n.getPlaybackUrl()),this.completeWithStatus(F.SessionState.NO_ANALYTICS,F.MALFORMED_URL)):(x.YoLog.w("Malformed analytics URL in manifest"),this.completeWithStatus(F.SessionState.NO_ANALYTICS,F.MALFORMED_URL)):(x.YoLog.e("Unable to process master manifest"),this.completeWithStatus(F.SessionState.NO_ANALYTICS,F.UNKNOWN_FORMAT))},e.onPlaybackStart=function(n){this.isNotPlaying()?this.getSessionState()!==F.SessionState.INITIALISED?x.YoLog.w("Reporting START when session is not initialised"):this.analyticPoller&&(t.prototype.onPlaybackStart.call(this,n),this.analyticPoller.start()):x.YoLog.w("Reporting START when start has already been reported")},e.onPlaybackReady=function(){t.prototype.onPlaybackReady.call(this),this.getSessionState()===F.SessionState.INITIALISED&&this.playing!==!0&&this.analyticPoller&&this.analyticPoller.request()},e.onPlaybackPause=function(){this.isNotPlaying()||this.pausePoller&&this.getSessionState()===F.SessionState.INITIALISED&&this.pausePoller.start(),t.prototype.onPlaybackPause.call(this)},e.onPlaybackResume=function(){this.isNotPlaying()&&this.pausePoller&&this.pausePoller.stop(),t.prototype.onPlaybackResume.call(this)},e.onPlayerEvent=function(n,a){(n===go.PlayerEvent.SEEK||n===go.PlayerEvent.ADVERT_SKIP||n===go.PlayerEvent.ADVERT_REWIND)&&(this.didSeek=!0),t.prototype.onPlayerEvent.call(this,n,a)},e.onPlayheadUpdate=function(n){this.handleHeartbeat(n),t.prototype.onPlayheadUpdate.call(this,n)},e.canPause=function(){return this.streamStart!==F.INVALID_WINDOW&&t.prototype.canPause.call(this)},e.canSkip=function(){if(this.streamStart===F.INVALID_WINDOW)return-1;if(this.policyHandler){var n=(0,Mv.raiseCallback)(this.policyHandler,this.policyHandler.canSkip,this.getPlayhead(),this.linearAdBreaks,this.getDuration());return n===null&&(n=this.defaultPolicyHandler.canSkip(this.getPlayhead(),this.linearAdBreaks,this.getDuration())),n}else return 0},e.willSeekTo=function(n){return this.streamStart===F.INVALID_WINDOW?this.getPlayhead():t.prototype.willSeekTo.call(this,n)},i}(Cv.SessionSeekable);pn.SessionDVRLive=Yv});var cc=D(vn=>{"use strict";vn.__esModule=!0;vn.SessionLive=void 0;var gn=Ne(),Hv=io(),qv=br(),Gv=Rr(),ne=Ve(),L=J(),ac=X(),Yr=ui(),oc=no(),jv=hi(),Wv=Ct(),sc=et(),Kv=ao(),zv=hn();function Ut(t,i){var e=typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e)return(e=e.call(t)).next.bind(e);if(Array.isArray(t)||(e=Xv(t))||i&&t&&typeof t.length=="number"){e&&(t=e);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xv(t,i){if(t){if(typeof t=="string")return lc(t,i);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return lc(t,i)}}function lc(t,i){(i==null||i>t.length)&&(i=t.length);for(var e=0,r=new Array(i);e<i;e++)r[e]=t[e];return r}function $v(t,i){t.prototype=Object.create(i.prototype),t.prototype.constructor=t,yo(t,i)}function yo(t,i){return yo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},yo(t,i)}var St=Object.freeze({PLAYED_OUT:0,NOT_PLAYED_OUT:1,NEW_ADVERT_STARTING:2}),Qv=function(t){$v(i,t);function i(r,n){var a;return a=t.call(this,r)||this,a.advertEndWatchdog=null,a.interSegmentTimeout=gn.Constant.INTERSEGMENT_TIMEOUT,a.lastTimedMetadata=null,a.pendingTimedMetadata=null,a.historicalTimedMetadata=[],a.inAdBreak=!1,a.targetDuration=gn.Constant.DEFAULT_POLLING_DELAY,a.setAnalyticsUrl(n),a.setPlaybackPolicyHandler(new qv.DefaultPlaybackPolicyHandler(ne.PlaybackMode.LIVE)),a}i.create=function(n,a,o){var s=new i(a,null);if(o)s.initialiseFromSession(n).then(function(){L.YoLog.d(L.DebugFlags.DEBUG_LIFECYCLE,"Session initialised")}).catch(function(){L.YoLog.d(L.DebugFlags.DEBUG_LIFECYCLE,"Session failed to initialise")}).finally(function(){o(new Gv.Event(s))});else return s.initialiseFromSession(n)};var e=i.prototype;return e.cancelScheduleWatchdog=function(){this.advertEndWatchdog!==null&&(clearTimeout(this.advertEndWatchdog),this.advertEndWatchdog=null,L.YoLog.d(L.DebugFlags.DEBUG_LIFECYCLE,"Cancelled watchdog timer"))},e.getAdBreakForAdvert=function(n){if(n&&this.linearAdBreaks.length>0)for(var a=n.getMediaIdentifier(),o=Ut(this.linearAdBreaks),s;!(s=o()).done;){var c=s.value,d=c.getAdvertFromIdentifier(a);if(d)return c}return null},e.getFirstAdvertRemovingAllPrevious=function(n){if(this.linearAdBreaks.length===0)return null;for(var a=null,o=-1,s=0;s<this.linearAdBreaks.length;++s){for(var c=this.linearAdBreaks[s],d=Ut(c.getAdverts()),p;!(p=d()).done;){var f=p.value;if(f.getMediaIdentifier()===n&&f.isActive()){a=f,o=s;break}else f.setInactive()}if(a!==null)break}return o>0&&this.linearAdBreaks.splice(0,o),a},e.getMetadataTimeout=function(n){return n&&n.getTypeWithinSegment()===jv.TypeWithinSegment.END?this.interSegmentTimeout:Math.max(this.targetDuration+1e3>>1,gn.Constant.MIN_INTRASEGMENT_TIMEOUT)},e.getPlaybackMode=function(){return ne.PlaybackMode.LIVE},e.handleMetaDataInSequence=function(n,a){var o=this.getCurrentAdvert();if(a.isFirstInSequence())this.onAdvertStart(n,a.getPlayhead());else if(a.isLastInSequence())o&&(!o.isFiller()||this.hasAdvertExpired(o,a))&&this.onAdvertEnd(St.PLAYED_OUT);else if(o)if(a.isLastInSegment()&&(o.isFiller()||o.isTruncated())&&this.hasAdvertExpired(o,a))L.YoLog.d(L.DebugFlags.DEBUG_STATE_MACHINE,"Filler expired or truncated advert completed.  Ending advert and ad break"),this.onAdvertEnd(St.PLAYED_OUT);else{var s=Math.max(a.getPlayhead()-o.getStart(),0);this.signalTimelineTrackingEvents(s)}else this.onAdvertBreakStart(n)},e.handleMetaDataOutOfSequence=function(n,a){var o=this.getCurrentAdvert();o?o.getMediaIdentifier()!==n.getMediaIdentifier()&&(this.onAdvertEnd(St.NOT_PLAYED_OUT),a.isFirstInSequence()?this.onAdvertStart(n,a.getPlayhead()):(a.isLastInSequence()||(n.isFiller()||n.isTruncated())&&a.isLastInSegment()&&this.hasAdvertExpired(n,a))&&(n.setInactive(),this.getCurrentAdBreak().isActive()||this.onAdvertBreakEnd())):a.isFirstInSequence()?this.onAdvertStart(n,a.getPlayhead()):this.scheduleAdvertBreakEnd(this.interSegmentTimeout)},e.hasAdvertExpired=function(n,a){var o=this.interSegmentTimeout,s=a.getPlayhead()-n.getStart()+o;return L.YoLog.d(L.DebugFlags.DEBUG_STATE_MACHINE,"("+(n.isFiller()?"FILLER":"ADVERT")+" CHECK): Ad duration: "+n.getDuration()+", elapsed: "+(a.getPlayhead()-n.getStart()+this.interSegmentTimeout)),s>=n.getDuration()},e.initialiseFromSession=function(n){var a=this;return new Promise(function(o,s){if(L.YoLog.trace("sdk init"),!(0,sc.getUrl)(n)){a.completeWithStatus(ne.SessionState.FAILED,ne.MALFORMED_URL),s(a);return}return Wv.HttpConnection.get(n,{method:"GET"},a.sessionProperties.getRequestTimeout(),a.sessionProperties.getCustomHttpHeaders()).then(function(c){if(c.ok){var d=c.headers.get("content-type");if(d&&d.toLowerCase().includes("application/json"))a.handleFallbackUrl(c.body)?o(a):s(a);else{var p=c.url?c.url:n;a.parseManifestResponse(c.body,p),a.getSessionState()===ne.SessionState.INITIALISED&&a.initialisePoller(),o(a)}}else c.timeout?(L.YoLog.e("Primary Url request failed: "+n+", reason: timeout"),a.completeWithStatus(ne.SessionState.FAILED,ne.CONNECTION_TIMEOUT)):(L.YoLog.e("Primary Url request failed: "+n+", status: "+c.status+", error: "+c.statusText),a.completeWithStatus(ne.SessionState.FAILED,c.status)),s(a)})})},e.initialisePoller=function(){var n=this;!this.getAnalyticsUrl()||this.getSessionState()!==ne.SessionState.INITIALISED||(this.analyticPoller=new Kv.UrlPoller(this.getAnalyticsUrl(),this.getSessionProperties().getRequestTimeout(),function(a,o){a.status===400?n.onSessionError(ne.SessionErrorCode.TIMEOUT):a.ok&&(n.targetDuration=o,n.parseAnalyticPayload(a.body))}))},e.isMetadataInSequence=function(n,a){return this.pendingTimedMetadata?(L.YoLog.d(L.DebugFlags.DEBUG_STATE_MACHINE,"Pending metadata"),!1):a.isInSequence(n)},e.onAdvertBreakEnd=function(){if(this.inAdBreak){var n=this.getCurrentAdBreak();if(n){var a=n.getTrackingReport("breakEnd",!0);this.getReportsManager().fireBeacon(a,new Yr.ReportingParams(this.getPlayhead()))}this.inAdBreak=!1,L.YoLog.trace("adbreakEnd"),this.getReportsManager().raiseAdBreakCallback("end",null,this),this.trackingErrors.length>0&&this.getReportsManager().raiseSessionErrorCallback(ne.SessionErrorCode.TRACKING_ERROR,this),this.linearAdBreaks.length>0&&(this.linearAdBreaks.splice(0,1),L.YoLog.d(L.DebugFlags.DEBUG_LIFECYCLE,"Removed AdBreak.  Remaining: "+this.linearAdBreaks.length)),this.pendingTimedMetadata=null,this.historicalTimedMetadata=[],this.setCurrentAdvert(null),this.setCurrentAdBreak(null)}},e.onAdvertBreakStart=function(n){var a=this.getAdBreakForAdvert(n);if(this.inAdBreak){if(a!=null){var o=a.getTrackingReport("breakStart",!this.reportsManager.reportsSuppressed());this.getReportsManager().fireBeacon(o,new Yr.ReportingParams(this.getPlayhead()))}return}if(this.inAdBreak=!0,this.clearTrackingErrors(),this.setCurrentAdBreak(a),L.YoLog.d(L.DebugFlags.DEBUG_LIFECYCLE,"AdBreak count: "+this.linearAdBreaks.length),L.YoLog.trace("adbreakStart"),this.getReportsManager().raiseAdBreakCallback("start",a,this),a){var s=a.getTrackingReport("breakStart",!this.reportsManager.reportsSuppressed());this.getReportsManager().fireBeacon(s,new Yr.ReportingParams(this.getPlayhead()))}},e.onAdvertEnd=function(n){this.getCurrentAdvert()&&(n!==St.NEW_ADVERT_STARTING?this.cancelScheduleWatchdog():L.YoLog.d(L.DebugFlags.DEBUG_STATE_MACHINE,"onAdvertEnd(): new ad starting, not firing adbreak watchdog timer"),n===St.PLAYED_OUT?this.signalTimelineTrackingEvents(this.getCurrentAdvert().getDuration()):this.getCurrentAdvert().clearTrackingSchedule(),this.getCurrentAdvert().setInactive(),L.YoLog.trace("advertEnd"),this.getReportsManager().raiseAdvertCallback("end",null,this),this.setCurrentAdvert(null),this.getCurrentAdBreak().isActive()?n!==St.NEW_ADVERT_STARTING&&this.scheduleAdvertBreakEnd(this.interSegmentTimeout):this.onAdvertBreakEnd())},e.onAdvertStart=function(n,a){if(n.setStart(a),this.onAdvertEnd(St.NEW_ADVERT_STARTING),this.onAdvertBreakStart(n),this.setCurrentAdBreak(this.getAdBreakForAdvert(n)),!this.getCurrentAdBreak()){L.YoLog.e("*** AdBreak is null ***");return}this.setCurrentAdvert(n),t.prototype.onAdvertStart.call(this,n),this.reportsManager.reportsSuppressed()&&this.getCurrentAdvert().clearTrackingSchedule(),L.YoLog.trace("advertStart"),this.getReportsManager().raiseAdvertCallback("start",n,this),this.fireImpressionReport(),this.signalTimelineTrackingEvents(gn.Constant.ADVERT_START_TIMESLOT)},e.parseAnalyticPayload=function(n){var a=this;return this.clearParsingErrors(),zv.Parser.parse(n,this).then(function(o){if(a.parsingErrors.length>0&&a.getReportsManager().raiseSessionErrorCallback(ne.SessionErrorCode.PARSING_ERROR,a),!o)return null;if(a.getLastAnalyticUpdate()&&o.isEqualTo(a.getLastAnalyticUpdate()))return L.YoLog.d(L.DebugFlags.DEBUG_PARSING,"Content unchanged.  Analytic update not delivered"),o;var s=o.getEarlyReturn();if(s&&s!==-1&&a.adjustForEarlyReturn(s),a.setLastAnalyticUpdate(o),!o.hasAdBreaks())return L.YoLog.d(L.DebugFlags.DEBUG_PARSING,"No ad breaks in payload"),a.playing||(L.YoLog.trace("sdk analytics 0 0 0"),a.reportsManager.raiseAnalyticUpdateCallback(a)),o;L.YoLog.trace("sdk analytics: "+o.getLinearAdBreaks().length+" "+o.getNonLinearAdBreaks().length+" "+o.getDisplayAdBreaks().length);for(var c=!1,d=Ut(o.getLinearAdBreaks()),p;!(p=d()).done;){var f=p.value;if(f.getAdverts().length===0){var w=new Yr.ReportingParams(a.getPlayhead());a.getReportsManager().fireBeacon(f.getTrackingReport("breakStart",!0),w),a.getReportsManager().fireBeacon(f.getTrackingReport("breakEnd",!0),w)}else a.linearAdBreaks.push(f),c=!0}for(var B=Ut(o.getNonLinearAdBreaks()),_;!(_=B()).done;){var G=_.value;a.nonLinearAdBreaks.push(G),c=!0}for(var Z=Ut(o.getDisplayAdBreaks()),ee;!(ee=Z()).done;){var se=ee.value;a.displayAdBreaks.push(se),c=!0}if(c&&!a.pendingTimedMetadata&&a.getReportsManager().raiseAnalyticUpdateCallback(a),a.pendingTimedMetadata){L.YoLog.d(L.DebugFlags.DEBUG_STATE_MACHINE,"Process pending metadata: "+a.pendingTimedMetadata);var te=a.pendingTimedMetadata;a.pendingTimedMetadata=null,a.onTimedMetadata(te)}return a.processHistoricalData(),o}).catch(function(o){L.YoLog.d(L.DebugFlags.DEBUG_POLLING,"Analytic Poll completed with unreadable data: "+o),a.parsingErrors.length>0&&a.getReportsManager().raiseSessionErrorCallback(ne.SessionErrorCode.PARSING_ERROR,a)})},e.onPlaybackContinue=function(){this.isPlaybackBuffering()&&(this.getCurrentAdvert()?this.scheduleAdvertEnd():this.getCurrentAdBreak()&&this.scheduleAdvertBreakEnd(this.interSegmentTimeout)),t.prototype.onPlaybackContinue.call(this)},e.onPlaybackPause=function(){t.prototype.onPlaybackPause.call(this),this.cancelScheduleWatchdog()},e.onPlaybackReady=function(){t.prototype.onPlaybackReady.call(this),this.getSessionState()===ne.SessionState.INITIALISED&&this.playing!==!0&&this.analyticPoller&&this.analyticPoller.request()},e.onPlaybackResume=function(){this.isNotPlaying()&&!this.isPlaybackBuffering()&&(this.getCurrentAdvert()?this.scheduleAdvertEnd(null):this.getCurrentAdBreak()&&this.scheduleAdvertBreakEnd(this.interSegmentTimeout)),t.prototype.onPlaybackResume.call(this)},e.onPlaybackStall=function(){t.prototype.onPlaybackStall.call(this),this.cancelScheduleWatchdog()},e.onPlaybackStart=function(n){this.isNotPlaying()?this.getSessionState()!==ne.SessionState.INITIALISED?L.YoLog.w("Reporting START when session has not been initialised"):(t.prototype.onPlaybackStart.call(this,n),this.analyticPoller.start()):L.YoLog.w("Reporting START when start has already been reported")},e.onTimedMetadata=function(n){if(L.YoLog.trace("timedmetadata "+n.getTypeWithinSegment().key+n.getSegmentNumber()+":"+n.getSegmentCount()+" "+n.getPlayhead()),L.YoLog.d(L.DebugFlags.DEBUG_STATE_MACHINE,"Received metadata: "+n+", timestamp: "+n.getTimestamp()),this.isPlaybackBuffering()){L.YoLog.w("Playback buffering - should not be receiving timed metadata");return}if(this.isNotPlaying()){L.YoLog.w("Playback not playing - should not be receiving timed metadata");return}if(this.scheduleAdvertEnd(n),n.isDuplicate(this.lastTimedMetadata)||n.isDuplicate(this.pendingTimedMetadata)){L.YoLog.d(L.DebugFlags.DEBUG_STATE_MACHINE,"Duplicate metadata: "+n);return}var a=n.getMediaId(),o=this.getFirstAdvertRemovingAllPrevious(a);if(!o){n.isFirstInSequence()?(L.YoLog.d(L.DebugFlags.DEBUG_STATE_MACHINE,"FIRST pending metadata for advert "+a),this.pendingTimedMetadata=n,this.lastTimedMetadata=null,this.analyticPoller&&this.analyticPoller.request()):n.isLastInSequence()&&this.getSessionProperties().getFireHistoricalBeacons()&&this.pendingTimedMetadata&&(L.YoLog.d(L.DebugFlags.DEBUG_STATE_MACHINE,"LAST pending metadata for advert: "+a+" .  Moving to historical list"),this.historicalTimedMetadata.push(this.pendingTimedMetadata),this.pendingTimedMetadata=null),this.onAdvertBreakStart(null);return}if(this.isMetadataInSequence(this.lastTimedMetadata,n)){this.lastTimedMetadata=n,this.handleMetaDataInSequence(o,n);return}L.YoLog.d(L.DebugFlags.DEBUG_STATE_MACHINE,"Metadata out of sequence"),this.pendingTimedMetadata=null,this.lastTimedMetadata=n,this.handleMetaDataOutOfSequence(o,n)},e.parseManifestResponse=function(n,a){var o=n,s=null;oc.HlsManifestParser.isHlsManifest(o)?(L.YoLog.d(L.DebugFlags.DEBUG_PARSING,"Processing HLS master playlist: "+a),s=oc.HlsManifestParser.parse(o)):(L.YoLog.d(L.DebugFlags.DEBUG_PARSING,"Processing DASH manifest: "+a),s=Hv.DashManifestParser.parse(o)),s?(0,ac.isNullOrEmpty)(s.getAnalyticUrl())?(this.setPlaybackUrl(a),L.YoLog.w("Analytics URL not found in manifest payload"),this.completeWithStatus(ne.SessionState.NO_ANALYTICS,0)):(0,sc.getUrl)(s.getAnalyticUrl())?(0,ac.isNullOrEmpty)(s.getPlaybackUrl())?(this.setPlaybackUrl(a),L.YoLog.w("Playback URL not found in manifest payload"),this.completeWithStatus(ne.SessionState.NO_ANALYTICS,ne.MALFORMED_URL)):(this.setPlaylistProperties(s),this.interSegmentTimeout=s.getIntersegmentTimeout(),this.completeWithStatus(ne.SessionState.INITIALISED,0),L.YoLog.d(L.DebugFlags.DEBUG_LIFECYCLE,"Successful.  URL: "+this.getPlaybackUrl())):(this.setPlaybackUrl(a),L.YoLog.w("Malformed analytics URL in manifest payload"),this.completeWithStatus(ne.SessionState.NO_ANALYTICS,ne.MALFORMED_URL)):(this.setPlaybackUrl(a),L.YoLog.w("Playlist/manifest processing unsuccesful"),this.completeWithStatus(ne.SessionState.NO_ANALYTICS,ne.UNKNOWN_FORMAT))},e.processHistoricalData=function(){var n=this.getCurrentAdBreak();if(n)for(var a=Ut(this.historicalTimedMetadata),o;!(o=a()).done;){var s=o.value,c=s.getMediaId(),d=n.getAdvertFromIdentifier(c);if(d){L.YoLog.d(L.DebugFlags.DEBUG_REPORTS,"Firing beacon for historical advert: "+c);for(var p=new Yr.ReportingParams(this.getPlayhead(),d.getStart(),d.getLinearCreative().getAssetUri(),d.getMacroSubstitutions()),f=[],w=Ut(d.getTrackingSchedule()),B;!(B=w()).done;){var _=B.value,G=_[0],Z=_[1];f.push(G);var ee=d.getTrackingReportLinear(Z);ee&&(L.YoLog.d(L.DebugFlags.DEBUG_REPORTS,"Firing beacon(s) for event: "+G),this.getReportsManager().fireBeacon(ee,p))}this.removeKeysFromTrackingSchedule(f)}}this.historicalTimedMetadata=[]},e.scheduleAdvertBreakEnd=function(n){this.cancelScheduleWatchdog(),this.advertEndWatchdog=setTimeout(this.metadataWatchdogEndBreak.bind(this),n),L.YoLog.d(L.DebugFlags.DEBUG_STATE_MACHINE,"Scheduled adbreak end watchdog timer: "+n+"ms")},e.scheduleAdvertEnd=function(n){this.cancelScheduleWatchdog();var a=this.getMetadataTimeout(n);this.advertEndWatchdog=setTimeout(this.metadataWatchdog.bind(this),a),L.YoLog.d(L.DebugFlags.DEBUG_STATE_MACHINE,"Scheduled advert end watchdog timer: "+a+"ms")},e.setTargetDuration=function(n){this.targetDuration=n},e.shutdown=function(){t.prototype.shutdown.call(this),this.cancelScheduleWatchdog(),this.analyticPoller&&(this.analyticPoller.shutdown(),this.analyticPoller=null,L.YoLog.d(L.DebugFlags.DEBUG_LIFECYCLE,"Analytic poller cancelled"))},e.setPlaylistProperties=function(n){this.setIdentifier(n.getSessionIdentifier()),this.setAnalyticsUrl(n.getAnalyticUrl()),this.setPlaybackUrl(n.getPlaybackUrl())},e.metadataWatchdog=function(){L.YoLog.w("Watchdog timer expired before metadata was received"),this.pendingTimedMetadata?this.onAdvertBreakEnd():this.onAdvertEnd(St.NOT_PLAYED_OUT)},e.metadataWatchdogEndBreak=function(){L.YoLog.w("Watchdog timer expired before metadata was received"),this.onAdvertBreakEnd()},i}(ne.Session);vn.SessionLive=Qv});var vc=D(yn=>{"use strict";yn.__esModule=!0;yn.SessionVOD=void 0;var Jv=Rr(),le=J(),ye=Ve(),uc=hn(),dc=X(),mo=Ht(),hc=Ct(),fc=et(),Zv=Ya(),ey=br();function ty(t,i){var e=typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e)return(e=e.call(t)).next.bind(e);if(Array.isArray(t)||(e=ry(t))||i&&t&&typeof t.length=="number"){e&&(t=e);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ry(t,i){if(t){if(typeof t=="string")return pc(t,i);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return pc(t,i)}}function pc(t,i){(i==null||i>t.length)&&(i=t.length);for(var e=0,r=new Array(i);e<i;e++)r[e]=t[e];return r}function iy(t,i){t.prototype=Object.create(i.prototype),t.prototype.constructor=t,Eo(t,i)}function Eo(t,i){return Eo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},Eo(t,i)}var gc=/(.+?:\/\/)/,ny=function(t){iy(i,t),i.create=function(n,a,o){var s=new i(a);return o?s.initialiseSession(n).then(function(){le.YoLog.d(le.DebugFlags.DEBUG_LIFECYCLE,"Session initialised")}).catch(function(){le.YoLog.d(le.DebugFlags.DEBUG_LIFECYCLE,"Session failed to initialise")}).finally(function(){o(new Jv.Event(s))}):s.initialiseSession(n)};function i(r){var n;return n=t.call(this,r)||this,n.setPlaybackPolicyHandler(new ey.DefaultPlaybackPolicyHandler(ye.PlaybackMode.VOD)),n}var e=i.prototype;return e.getContentPositionForPlayhead=function(n){if(this.duration===0||n===0)return 0;if(this.linearAdBreaks.length===0)return n;for(var a=ty(this.linearAdBreaks),o;!(o=a()).done;){var s=o.value;if(s.getStart()<=n&&n<s.getStart()+s.getDuration()){n=s.getStart()+s.getDuration();break}}for(var c=0,d=n;c<this.linearAdBreaks.length&&this.linearAdBreaks[c].getStart()<n;)d-=this.linearAdBreaks[c++].getDuration();return d},e.getPlaybackMode=function(){return ye.PlaybackMode.VOD},e.getPlayheadForContentPosition=function(n){if(this.linearAdBreaks.length===0)return n;for(var a=0;a<this.linearAdBreaks.length&&this.linearAdBreaks[a].getStart()<=n;)n+=this.linearAdBreaks[a++].getDuration();return n},e.initialiseSession=function(n){var a=this;return new Promise(function(o,s){if(le.YoLog.trace("sdk init"),!(0,fc.getUrl)(n)){a.completeWithStatus(ye.SessionState.FAILED,ye.MALFORMED_URL),s(a);return}return hc.HttpConnection.get(n,{method:"GET"},a.sessionProperties.getRequestTimeout(),a.sessionProperties.getCustomHttpHeaders()).then(function(c){if(c.ok){var d=c.headers.get("content-type");if(d&&d.toLowerCase().includes("application/json"))a.handleFallbackUrl(c.body)?o(a):s(a);else return uc.Parser.parse(c.body,a).then(function(p){!p||p.getStreamDuration()===0||(0,dc.isNullOrEmpty)(p.getHostNode()||(0,dc.isNullOrEmpty)(p.getHostSuffix()))?(a.setPlaybackUrl(n),a.logVmapParseWarning(p),p?(a.completeWithStatus(ye.SessionState.NO_ANALYTICS,0),o(a)):(a.completeWithStatus(ye.SessionState.NO_ANALYTICS,ye.UNKNOWN_FORMAT),o(a))):p.getHasPlaceholder()?(a.handlePlaceholderBreaks(p,n),a.completeWithStatus(ye.SessionState.INITIALISED,ye.PARTIAL_VMAP),o(a)):(a.initialiseFromAnalyticData(p,a.findScheme(n)),le.YoLog.d(le.DebugFlags.DEBUG_PARSING,p.toString()),a.completeWithStatus(ye.SessionState.INITIALISED,0),o(a))})}else le.YoLog.e("VMAP request failed.  URL: "+n+", status: "+c.status+", error: "+c.statusText),a.completeWithStatus(ye.SessionState.FAILED,c.status),s(a)})})},e.logVmapParseWarning=function(n){var a=`Unable to parse VMAP data.
 - Stream duration: `+(n?n.getStreamDuration():"null")+`
 - Host node: `+(n?n.getHostNode():"null")+`
 - Host suffix: `+(n?n.getHostSuffix():null);le.YoLog.d(le.DebugFlags.DEBUG_LIFECYCLE,a)},e.findScheme=function(n){if(gc.exec(n)){var a=gc.exec(n);return a[1]}else return le.YoLog.w("Unable to match scheme in primary URL.  Assuming http://"),"http://"},e.handlePlaceholderBreaks=function(n,a){var o=this;le.YoLog.d(le.DebugFlags.DEBUG_LIFECYCLE,"Found partial VMAP"),this.initialiseFromAnalyticData(n,this.findScheme(a),!0);var s=n.getLinearAdBreaks();if(!s.length){le.YoLog.e("Fulfilment payload contains no breaks"),this.onSessionError(ye.SessionErrorCode.UNRESOLVED_BREAK);return}var c=s[s.length-1].getAdTagUri();if(!(0,fc.getUrl)(c)){le.YoLog.e("Fulfilment payload followup URL is not valid: "+c),this.onSessionError(ye.SessionErrorCode.UNRESOLVED_BREAK);return}return hc.HttpConnection.get(c,{method:"GET"},this.sessionProperties.getRequestTimeout(),this.sessionProperties.getCustomHttpHeaders()).then(function(d){if(d.ok)return uc.Parser.parse(d.body,o,{skipNormalisation:!0}).then(function(p){o.parsingErrors.length>0&&o.getReportsManager().raiseSessionErrorCallback(ye.SessionErrorCode.PARSING_ERROR,o),p?(o.mergePlaceholderBreaks(p)?o.reportsManager&&o.reportsManager.raiseAnalyticUpdateCallback(o):(le.YoLog.e("Fulfilment payload could not be merged"),o.onSessionError(ye.SessionErrorCode.UNRESOLVED_BREAK)),le.YoLog.d(le.DebugFlags.DEBUG_PARSING,p.toString())):(le.YoLog.e("Fulfilment payload could not be parsed"),o.onSessionError(ye.SessionErrorCode.UNRESOLVED_BREAK))});le.YoLog.e("Fulfilment payload request failed: "+d.statusText),o.onSessionError(ye.SessionErrorCode.UNRESOLVED_BREAK)})},e.onPlayerEvent=function(n,a){(n===mo.PlayerEvent.SEEK||n===mo.PlayerEvent.ADVERT_SKIP||n===mo.PlayerEvent.ADVERT_REWIND)&&(this.didSeek=!0),t.prototype.onPlayerEvent.call(this,n,a)},e.onPlayheadUpdate=function(n){this.handleHeartbeat(n),t.prototype.onPlayheadUpdate.call(this,n)},e.setAdBreaksInactivePriorTo=function(n){t.prototype.setAdBreaksInactivePriorTo.call(this,n)},e.setDuration=function(n){this.duration=n},i}(Zv.SessionSeekable);yn.SessionVOD=ny});var mn=D(M=>{"use strict";M.__esModule=!0;var $e=J();M.DEBUG_ALL=$e.DEBUG_ALL;M.DEBUG_PLAYBACK=$e.DEBUG_PLAYBACK;M.DEBUG_HTTP_REQUESTS=$e.DEBUG_HTTP_REQUESTS;M.DEBUG_LIFECYCLE=$e.DEBUG_LIFECYCLE;M.DEBUG_PARSING=$e.DEBUG_PARSING;M.DEBUG_POLLING=$e.DEBUG_POLLING;M.DEBUG_REPORTS=$e.DEBUG_REPORTS;M.DEBUG_STATE_MACHINE=$e.DEBUG_STATE_MACHINE;M.DEBUG_VALIDATION=$e.DEBUG_VALIDATION;M.DebugFlags=$e.DebugFlags;M.YoLog=$e.YoLog;var yc=kr();M.AdBreak=yc.AdBreak;M.BreakType=yc.BreakType;var ay=Vn();M.AdBreakEventHandler=ay.AdBreakEventHandler;var oy=Bi();M.AdVerification=oy.AdVerification;var sy=Gt();M.Advert=sy.Advert;var mc=Ta();M.AdvertEventHandler=mc.AdvertEventHandler;M.ViewableEvent=mc.ViewableEvent;var ly=Fi();M.AdvertWrapper=ly.AdvertWrapper;var cy=Qn();M.AnalyticEventObserver=cy.AnalyticEventObserver;var uy=Di();M.CompanionCreative=uy.CompanionCreative;var dy=Lr();M.Creative=dy.Creative;var hy=Ir();M.CreativeEventHandler=hy.CreativeEventHandler;var fy=xi();M.IconClickFallbackImage=fy.IconClickFallbackImage;var py=qi();M.IndustryIcon=py.IndustryIcon;var gy=zi();M.InteractiveCreative=gy.InteractiveCreative;var vy=Cr();M.LinearCreative=vy.LinearCreative;var yy=Or();M.NonLinearCreative=yy.NonLinearCreative;var Ao=Ht();M.PlaybackEventHandler=Ao.PlaybackEventHandler;M.PlayerEvent=Ao.PlayerEvent;M.ViewSize=Ao.ViewSize;var my=Wn();M.PlaybackPolicy=my.PlaybackPolicy;var Ey=gi();M.PlaybackPolicyHandler=Ey.PlaybackPolicyHandler;var qe=Ve();M.PlaybackMode=qe.PlaybackMode;M.Session=qe.Session;M.SessionProperties=qe.SessionProperties;M.SessionState=qe.SessionState;M.SessionErrorCode=qe.SessionErrorCode;M.CONNECTION_ERROR=qe.CONNECTION_ERROR;M.CONNECTION_TIMEOUT=qe.CONNECTION_TIMEOUT;M.MALFORMED_URL=qe.MALFORMED_URL;M.UNKNOWN_FORMAT=qe.UNKNOWN_FORMAT;M.NO_DVRLIVE=qe.NO_DVRLIVE;M.FALLBACK_URL=qe.FALLBACK_URL;M.INVALID_WINDOW=qe.INVALID_WINDOW;var Ec=Ne();M.CAT_AD_BREAK_EVENTS=Ec.CAT_AD_BREAK_EVENTS;M.CAT_TIMELINE_EVENTS=Ec.CAT_TIMELINE_EVENTS;var Ac=rt();M.Resource=Ac.Resource;M.ResourceType=Ac.ResourceType;var Ay=nc();M.SessionDVRLive=Ay.SessionDVRLive;var Ty=cc();M.SessionLive=Ty.SessionLive;var Sy=vc();M.SessionVOD=Sy.SessionVOD;var by=hi();M.TimedMetadata=by.TimedMetadata;var ky=dt();M.VASTProperty=ky.VASTProperty;var Iy=ba();M.VerificationEventHandler=Iy.VerificationEventHandler});var Cy={};wc(Cy,{SsaiPlugin:()=>bn});var In={AdStarted:"advertising:AdStarted",AdStopped:"advertising:AdStopped",AdSlotStarted:"advertising:AdSlotStarted",AdSlotStopped:"advertising:AdSlotStopped",AdSlotCompleted:"advertising:AdSlotCompleted"};var bt={GrunerUndJahr:"grunerundjahr",RTLPlusWatch:"rtlplusmpawatch",RTLPlusRadio:"rtlplusmparadio",RTLPlusAudiobook:"rtlplusmpaaudiobook",RTLPlusPodcast:"rtlplusmpapodcast",SuperRTLToggo:"superrtltoggo",MediaHub:"mediahub",RTLDigitalNews:"rtldigitalnews",CorporateSites:"corporatesites"},Oy={[bt.RTLPlusWatch]:{Web:"web",Tizen:"tizen",LG:"lg",Magenta:"magenta",Sky:"sky",Chromecast:"chromecast"},[bt.RTLPlusRadio]:{Web:"web",Tizen:"tizen",LG:"lg",Magenta:"magenta",Sky:"sky",Chromecast:"chromecast"},[bt.RTLPlusAudiobook]:{Web:"web",Tizen:"tizen",LG:"lg",Magenta:"magenta",Sky:"sky",Chromecast:"chromecast"},[bt.RTLPlusPodcast]:{Web:"web",Tizen:"tizen",LG:"lg",Magenta:"magenta",Sky:"sky",Chromecast:"chromecast"},[bt.RTLDigitalNews]:{NTV:"ntv",Capital:"capital",Geo:"geo",RTL:"rtl",Sport:"sport",Stern:"stern",Wetter:"wetter"},[bt.CorporateSites]:{BusinessPortal:"businessportal",Crime:"crime",GeoTV:"geotv",JournalistenSchule:"journalistenschule",Living:"living",Nitro:"nitro",Passion:"passion",RTLSuper:"rtlsuper",RTLUp:"rtlup",SchlagerLiebe:"schlagerliebe",VOX:"vox"},[bt.GrunerUndJahr]:{BabyClub:"babyclub",Brigitte:"brigitte",Eltern:"eltern",EssenUndTrinken:"essenundtrinken",Gala:"gala",Geolino:"geolino",LivingAtHome:"livingathome",SchoenerWohnen:"schoenerwohnen",Urbia:"urbia",VIP:"vip",Vorname:"vorname"}};var dr={None:0,Error:10,Warn:20,Info:30,Debug:40,Trace:50};var Vt={VOD:"vod",Live:"live",Event:"event",FAST:"fast",Podcast:"podcast",Audiobook:"audiobook",Radio:"radio"};var Pn={PlayerCreated:"player:PlayerCreated",MediaStarted:"player:MediaStarted",ContentStart:"player:ContentStart",ContentEnd:"player:ContentEnd",SessionStart:"player:SessionStart",SessionEnd:"player:SessionEnd",Destroy:"player:Destroy",HDCPFallback:"player:HDCPFallback",CueEnter:"player:CueEnter",CueExit:"player:CueExit",Error:"player:Error",Muted:"player:Muted",Unmuted:"player:Unmuted",Play:"player:Play",Paused:"player:Paused",PlaybackSpeedChanged:"player:PlaybackSpeedChanged",Playing:"player:Playing",Ready:"player:Ready",Seek:"player:Seek",Seeked:"player:Seeked",StallStarted:"player:StallStarted",StallEnded:"player:StallEnded",TimeChanged:"player:TimeChanged",VolumeChanged:"player:VolumeChanged",AudioTrackSelected:"player:AudioTrackSelected",TextTrackSelected:"player:SubtitlesSelected",SubtitlesSelected:"player:SubtitlesSelected",MetadataUpdated:"player:MetadataUpdated"};var Wc=Re(je());var _n=Re(je());var he=t=>{var e;if(!t){let r=new Error("Cannot return a logger for an empty namespace");throw Object.assign(r,{code:_n.ErrorCodes.INTERNAL_PLAYER_ERROR}),r}let i=(e=window.foundation)==null?void 0:e.logger;if(!i){let r=new Error("Logger on the window object wasn't initialized yet when getLogger() was called");throw Object.assign(r,{code:_n.ErrorCodes.PLAYER_DEPENDENCY_MISSING}),r}return i.getLogger(t)},Hy=dr.Warn;var Uo="",Po="?";var Rc="undefined",Nc="object",Fo="string";var P="model",C="name",k="type",I="vendor",R="version",ct="architecture",jr="console",q="mobile",H="tablet",Be="smarttv",hr="wearable",_o="embedded",Oc=500,Wr="Amazon",fr="Apple",Lo="ASUS",wo="BlackBerry",kt="Browser",Kr="Chrome",Mc="Edge",zr="Firefox",Xr="Google",Co="Huawei",Ln="LG",wn="Microsoft",Do="Motorola",pr="Opera",$r="Samsung",Ro="Sharp",Qr="Sony",Cn="Xiaomi",Dn="Zebra",No="Facebook",Bc="Chromium OS",Uc="Mac OS";var Oo=function(t,i){return typeof t===Fo?gr(i).indexOf(gr(t))!==-1:!1},gr=function(t){return t.toLowerCase()};var Mo=function(t,i){if(typeof t===Fo)return t=t.replace(/^\s\s*/,Uo),typeof i===Rc?t:t.substring(0,Oc)};var Rn=function(t,i){for(let e in i)if(typeof i[e]===Nc&&i[e].length>0){for(let r=0;r<i[e].length;r++)if(Oo(i[e][r],t))return e===Po?void 0:e}else if(Oo(i[e],t))return e===Po?void 0:e;return t},Fc={"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"},Bo={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Gy={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[R,[C,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[R,[C,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[C,R],[/opios[\/ ]+([\w\.]+)/i],[R,[C,pr+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[R,[C,pr+" GX"]],[/\bopr\/([\w\.]+)/i],[R,[C,pr]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[R,[C,"Baidu"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim)\s?(?:browser)?[\/ ]?([\w\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[C,R],[/\bddg\/([\w\.]+)/i],[R,[C,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[R,[C,"UC"+kt]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[R,[C,"WeChat"]],[/konqueror\/([\w\.]+)/i],[R,[C,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[R,[C,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[R,[C,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[R,[C,"Smart Lenovo "+kt]],[/(avast|avg)\/([\w\.]+)/i],[[C,/(.+)/,"$1 Secure "+kt],R],[/\bfocus\/([\w\.]+)/i],[R,[C,zr+" Focus"]],[/\bopt\/([\w\.]+)/i],[R,[C,pr+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[R,[C,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[R,[C,"Dolphin"]],[/coast\/([\w\.]+)/i],[R,[C,pr+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[R,[C,"MIUI "+kt]],[/fxios\/([-\w\.]+)/i],[R,[C,zr]],[/\bqihu|(qi?ho?o?|360)browser/i],[[C,"360 "+kt]],[/(oculus|sailfish|huawei|vivo)browser\/([\w\.]+)/i],[[C,/(.+)/,"$1 "+kt],R],[/samsungbrowser\/([\w\.]+)/i],[R,[C,$r+" Internet"]],[/(comodo_dragon)\/([\w\.]+)/i],[[C,/_/g," "],R],[/metasr[\/ ]?([\d\.]+)/i],[R,[C,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[C,"Sogou Mobile"],R],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345Explorer)[\/ ]?([\w\.]+)/i],[C,R],[/(lbbrowser)/i,/\[(linkedin)app\]/i],[C],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[C,No],R],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[C,R],[/\bgsa\/([\w\.]+) .*safari\//i],[R,[C,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[R,[C,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[R,[C,Kr+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[C,Kr+" WebView"],R],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[R,[C,"Android "+kt]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[C,R],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[R,[C,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[R,C],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[C,[R,Rn,Fc]],[/(webkit|khtml)\/([\w\.]+)/i],[C,R],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[C,"Netscape"],R],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[R,[C,zr+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[C,R],[/(cobalt)\/([\w\.]+)/i],[C,[R,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[ct,"amd64"]],[/(ia32(?=;))/i],[[ct,gr]],[/((?:i[346]|x)86)[;\)]/i],[[ct,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[ct,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[ct,"armhf"]],[/windows (ce|mobile); ppc;/i],[[ct,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[ct,/ower/,Uo,gr]],[/(sun4\w)[;\)]/i],[[ct,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[ct,gr]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[P,[I,$r],[k,H]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[P,[I,$r],[k,q]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[P,[I,fr],[k,q]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[P,[I,fr],[k,H]],[/(macintosh);/i],[P,[I,fr]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[P,[I,Ro],[k,q]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[P,[I,Co],[k,H]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[P,[I,Co],[k,q]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[P,/_/g," "],[I,Cn],[k,q]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[P,/_/g," "],[I,Cn],[k,H]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[P,[I,"OPPO"],[k,q]],[/\b(opd2\d{3}a?) bui/i],[P,[I,"OPPO"],[k,H]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[P,[I,"Vivo"],[k,q]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[P,[I,"Realme"],[k,q]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[P,[I,Do],[k,q]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[P,[I,Do],[k,H]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[P,[I,Ln],[k,H]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[P,[I,Ln],[k,q]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[P,[I,"Lenovo"],[k,H]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[P,/_/g," "],[I,"Nokia"],[k,q]],[/(pixel c)\b/i],[P,[I,Xr],[k,H]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[P,[I,Xr],[k,q]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[P,[I,Qr],[k,q]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[P,"Xperia Tablet"],[I,Qr],[k,H]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[P,[I,"OnePlus"],[k,q]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[P,[I,Wr],[k,H]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[P,/(.+)/g,"Fire Phone $1"],[I,Wr],[k,q]],[/(playbook);[-\w\),; ]+(rim)/i],[P,I,[k,H]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[P,[I,wo],[k,q]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[P,[I,Lo],[k,H]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[P,[I,Lo],[k,q]],[/(nexus 9)/i],[P,[I,"HTC"],[k,H]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[I,[P,/_/g," "],[k,q]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[P,[I,"Acer"],[k,H]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[P,[I,"Meizu"],[k,q]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[P,[I,"Ulefone"],[k,q]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[I,P,[k,q]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[I,P,[k,H]],[/(surface duo)/i],[P,[I,wn],[k,H]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[P,[I,"Fairphone"],[k,q]],[/(u304aa)/i],[P,[I,"AT&T"],[k,q]],[/\bsie-(\w*)/i],[P,[I,"Siemens"],[k,q]],[/\b(rct\w+) b/i],[P,[I,"RCA"],[k,H]],[/\b(venue[\d ]{2,7}) b/i],[P,[I,"Dell"],[k,H]],[/\b(q(?:mv|ta)\w+) b/i],[P,[I,"Verizon"],[k,H]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[P,[I,"Barnes & Noble"],[k,H]],[/\b(tm\d{3}\w+) b/i],[P,[I,"NuVision"],[k,H]],[/\b(k88) b/i],[P,[I,"ZTE"],[k,H]],[/\b(nx\d{3}j) b/i],[P,[I,"ZTE"],[k,q]],[/\b(gen\d{3}) b.+49h/i],[P,[I,"Swiss"],[k,q]],[/\b(zur\d{3}) b/i],[P,[I,"Swiss"],[k,H]],[/\b((zeki)?tb.*\b) b/i],[P,[I,"Zeki"],[k,H]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[I,"Dragon Touch"],P,[k,H]],[/\b(ns-?\w{0,9}) b/i],[P,[I,"Insignia"],[k,H]],[/\b((nxa|next)-?\w{0,9}) b/i],[P,[I,"NextBook"],[k,H]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[I,"Voice"],P,[k,q]],[/\b(lvtel\-)?(v1[12]) b/i],[[I,"LvTel"],P,[k,q]],[/\b(ph-1) /i],[P,[I,"Essential"],[k,q]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[P,[I,"Envizen"],[k,H]],[/\b(trio[-\w\. ]+) b/i],[P,[I,"MachSpeed"],[k,H]],[/\btu_(1491) b/i],[P,[I,"Rotor"],[k,H]],[/(shield[\w ]+) b/i],[P,[I,"Nvidia"],[k,H]],[/(sprint) (\w+)/i],[I,P,[k,q]],[/(kin\.[onetw]{3})/i],[[P,/\./g," "],[I,wn],[k,q]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[P,[I,Dn],[k,H]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[P,[I,Dn],[k,q]],[/smart-tv.+(samsung)/i],[I,[k,Be]],[/hbbtv.+maple;(\d+)/i],[[P,/^/,"SmartTV"],[I,$r],[k,Be]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[I,Ln],[k,Be]],[/(apple) ?tv/i],[I,[P,fr+" TV"],[k,Be]],[/crkey/i],[[P,Kr+"cast"],[I,Xr],[k,Be]],[/droid.+aft(\w+)( bui|\))/i],[P,[I,Wr],[k,Be]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[P,[I,Ro],[k,Be]],[/(bravia[\w ]+)( bui|\))/i],[P,[I,Qr],[k,Be]],[/(mitv-\w{5}) bui/i],[P,[I,Cn],[k,Be]],[/Hbbtv.*(technisat) (.*);/i],[I,P,[k,Be]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[I,Mo],[P,Mo],[k,Be]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[k,Be]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[I,P,[k,jr]],[/droid.+; (shield) bui/i],[P,[I,"Nvidia"],[k,jr]],[/(playstation [345portablevi]+)/i],[P,[I,Qr],[k,jr]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[P,[I,wn],[k,jr]],[/((pebble))app/i],[I,P,[k,hr]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[P,[I,fr],[k,hr]],[/droid.+; (glass) \d/i],[P,[I,Xr],[k,hr]],[/droid.+; (wt63?0{2,3})\)/i],[P,[I,Dn],[k,hr]],[/(quest( \d| pro)?)/i],[P,[I,No],[k,hr]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[I,[k,_o]],[/(aeobc)\b/i],[P,[I,Wr],[k,_o]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[P,[k,q]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[P,[k,H]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[k,H]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[k,q]],[/(android[-\w\. ]{0,9});.+buil/i],[P,[I,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[R,[C,Mc+"HTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[R,[C,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[C,R],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[R,C]],os:[[/microsoft (windows) (vista|xp)/i],[C,R],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[C,[R,Rn,Bo]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[R,Rn,Bo],[C,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[R,/_/g,"."],[C,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[C,Uc],[R,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[R,C],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[C,R],[/\(bb(10);/i],[R,[C,wo]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[R,[C,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[R,[C,zr+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[R,[C,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[R,[C,"watchOS"]],[/crkey\/([\d\.]+)/i],[R,[C,Kr+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[C,Bc],R],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[C,R],[/(sunos) ?([\w\.\d]*)/i],[[C,"Solaris"],R],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[C,R]]};var Vc=()=>{var i;let t=(i=window.foundation)==null?void 0:i.platformCheck;if(!t)throw new Error("platformCheck on the window object wasn't initialized yet when getPlatformCheck() was called");return t},Ie=()=>{let t=Vc();if(!t.uaParser)throw new Error("uaParser on the window object wasn't initialized yet when getUAParser() was called");return t.uaParser},Vo=()=>Ie().getUA().includes("Sky, ES160"),xo=()=>{let t=Ie().getUA();return["Sky, XiOne","Sky, ES340"].some(i=>t.includes(i))},Jr=()=>Vo()||xo(),vr=()=>{var t;return(t=Ie().getOS().name)!=null?t:""},yr=()=>["tizen"].includes(vr().toLocaleLowerCase()),Nn=()=>Ie().getUA().includes("Vodafone_Germany_GigaTV_4k_Box"),On=()=>Ie().getUA().includes("VODAFONE_STB"),Mn=()=>Nn()||On(),mr=()=>vr().toLocaleLowerCase().includes("webos"),xc=()=>{if(yr())return"Chrome";let t=Ie().getBrowser().name||"";return t==="Safari"&&(Mn()||Jr()||mr())?"WebKit":t||""};var Yo=()=>Ie().getUA().includes("DT,MR200_MR400"),Ho=()=>{let t=Ie().getUA();return["DT,MR601SAT","DT,MR401","DT,MR201"].some(i=>t.includes(i))},qo=()=>Ie().getUA().includes("DT,MRG5"),Go=()=>{let i=Ie().getDevice().model;if(i)return i;switch(!0){case Vo():return"Q";case xo():return"XiOne";case Yo():return"G3";case Ho():return"G4";case qo():return"G5";case Nn():return"GTV";case On():return"VTV";case yr():return"TV";case mr():return"TV";default:return""}},Bn=()=>Yo()||Ho()||qo()?!0:Ie().getUA().includes("DT_STB_BCM72"),Yc=()=>xc().toLocaleLowerCase().includes("samsung internet"),jo=()=>{let i=Ie().getDevice().vendor;if(i)return i;switch(!0){case Yc():case yr():return"Samsung";case mr():return"LG";case Jr():return"Sky";case Bn():return"Telekom";case Nn():case On():return"Vodafone";default:return""}},Wo=()=>Ie().getOS().version||"";var Ko=()=>Ie().getUA().includes("CrKey");var Kc=Re(je());var It=class{constructor(t,i){this.statusCode=t,this.body=i}getStatus(){return this.statusCode}getBody(){return Promise.resolve(this.body)}},Er=class{post(t,i,e={}){var r,n;return this.fetch(t,{body:JSON.stringify(i),headers:this.getHeaders((r=e.headers)!=null?r:{}),method:"POST",timeout:(n=e.timeout)!=null?n:void 0})}get(t,i={}){var e,r;return this.fetch(t,{headers:this.getHeaders((e=i.headers)!=null?e:{}),method:"GET",timeout:(r=i.timeout)!=null?r:void 0})}fetch(t,i){if(!this.isFetchSupported())return Promise.reject("'fetch' is not available in this browser environment");if(i.timeout&&this.canAbortFetch()){let e=this.controller,r=setTimeout(()=>e.abort("timeout"),i.timeout);return this.handleFetch(t,{...i,signal:e.signal}).then(n=>(clearTimeout(r),n))}return this.handleFetch(t,i)}handleFetch(t,i){return fetch(t,i).then(this.handleResponse).catch(this.handleError)}handleResponse(t){let i=t.clone(),e=t.json().catch(()=>i.text()),r=new It(t.status,e);return t.status>=200&&t.status<300?Promise.resolve(r):Promise.reject(r)}handleError(t){throw t instanceof It?t:new It(0,typeof t.message=="string"?t.message.trim():t.message)}getHeaders(t){return{Accept:"application/json","Content-Type":"application/json",...t}}isFetchSupported(){return typeof fetch!="undefined"}canAbortFetch(){return!this.controller&&typeof AbortController!="undefined"&&(this.controller=new AbortController),!!this.controller}};var zc=Re(je());var Xc=Re(je());var $c=Re(je());var Qc=Re(je());var Jc=Re(je());var Zc=Re(je()),Ee={...Pn,UpdateMetaData:"player:UpdateMetaData",TimedMetadata:"player:TimedMetadata",MetricAdded:"player:MetricAdded",PlayerLoaded:"player:PlayerLoaded",MediaLoad:"player:MediaLoad",MediaLoaded:"player:MediaLoaded",Destroyed:"player:Destroyed",Metadata:"player:Metadata",PlaybackFinished:"player:PlaybackFinished",ContentReady:"player:ContentReady",SourceLoaded:"player:SourceLoaded",SourceUnloaded:"player:SourceUnloaded",StallingFix:"player:StallingFix",MediaAdaptation:"player:MediaAdaptation",AutoplaySuccessful:"player:AutoplaySuccessful",TrackChanged:"player:TrackChanged",KeySystemSelected:"player:KeySystemSelected"},Gc=class extends Event{constructor(t,i={}){super(t),this.originalEvent=i.originalEvent}};var $o=class extends Gc{constructor(t,i){super(t,i),this.code=i.code,this.message=i.message,this.response=i.response,this.responseText=i.responseText,this.name=i.name,this.context=i.context,jc(this.response)&&(this.code=this.response.errorCode,this.message=this.response.error)}};function jc(t){return t!==null&&typeof t=="object"&&"origin"in t&&typeof t.origin=="string"&&"errorCode"in t&&typeof Number(t.errorCode)=="number"&&"error"in t&&typeof t.error=="string"}var nm={...In,AdSlotsCreated:"advertising:AdSlotsCreated",InitAdSlot:"advertising:InitAdSlot",AdSlotReady:"advertising:AdSlotReady",PauseAd:"advertising:PauseAd",ResumeAd:"advertising:ResumeAd",SkipAd:"advertising:SkipAd",StartAdSlot:"advertising:StartAdSlot",StopAdSlot:"advertising:StopAdSlot",OpenClickThrough:"advertising:OpenClickThrough",HomadActivation:"advertising:HomadActivation",HomadPenalty:"advertising:HomadPenalty",AdError:"advertising:AdError",AdQuartileReached:"advertising:AdQuartileReached"};var Qo=class{setPlayer(t){this.player=t}};var Zr=class{constructor(i,e,r=he("ssai.ManifestSourcesUrlRewriter")){this.smartclipAtvIdResolver=i;this.pluginConfig=e;this.logger=r;this.values={}}async updateSource(i,e){if(!i.isYospace)return i;try{this.values.consentString=await e.getConsent()}catch(n){this.logger.warn("couldn't get consent string",n)}this.isTrackingConsentOptIn()&&(this.values.atvId=await this.smartclipAtvIdResolver.getId()),this.isTrackingConsentOptIn()||(this.values.opt="out"),this.values.make=jo(),this.values.model=vr(),this.values.hwv=Go(),this.values.os=vr(),this.values.osv=Wo(),this.values.yoBr="true",this.values.fwdYssdk="0",this.pluginConfig&&(this.values.fwd_rpusr=this.pluginConfig.fwd_rpusr);let r=e.getPlayerAdapter().getVideoElement();return this.values.angPlrW=r!=null&&r.offsetWidth?String(r.offsetWidth):"",this.values.angPlrH=r!=null&&r.offsetHeight?String(r.offsetHeight):"",this.values.angRef=window.location.href,this.values.angDevSet=eu(),{...i,url:this.rewriteSource(i.url)}}isTrackingConsentOptIn(){return!!this.values.consentString}rewriteSource(i){let e=new URL(i);return Pe(e,"userid",this.values.atvId),Pe(e,"consent",this.values.consentString),Pe(e,"opt",this.values.opt),Pe(e,"make",this.values.make),Pe(e,"model",this.values.model),Pe(e,"hwv",this.values.hwv),Pe(e,"os",this.values.os),Pe(e,"osv",this.values.osv),Pe(e,"yo.br",this.values.yoBr),Pe(e,"fwd_yssdk",this.values.fwdYssdk),Pe(e,"fwd_rpusr",this.values.fwd_rpusr),Pe(e,"ang_plrh",this.values.angPlrH),Pe(e,"ang_plrw",this.values.angPlrW),Pe(e,"ang_ref",this.values.angRef),tu(e,"ang_devset",this.values.angDevSet),e.searchParams.delete("yo.av"),e.toString()}},eu=()=>Bn()?"193":yr()||Jr()||mr()?"48":Ko()?"28":Mn()?"30":"",Pe=(t,i,e)=>{t.searchParams.has(i)&&(!!e&&e!==void 0&&e!=="")&&(t.searchParams.delete(i),t.searchParams.append(i,e))},tu=(t,i,e)=>{!t.searchParams.get(i)&&e&&(t.searchParams.delete(i),t.searchParams.append(i,e))};var Ar=Re(je());var ru=t=>{let i=document.cookie.match("(^|;) ?"+t+"=([^;]*)(;|$)");return i?i[2]:void 0},iu=(t,i,e)=>{let n=864e5*e;document.cookie=t+"="+i+";path=/;max-age="+n},nu=t=>{document.cookie=t+"= ;path=/;expires=Thu, 01 Jan 1970 00:00:00 GMT"},Jo=t=>localStorage?{get:i=>localStorage.getItem(i)||void 0,set:(i,e)=>localStorage.setItem(i,e),remove:i=>localStorage.removeItem(i)}:{get:i=>ru(i),set:(i,e)=>iu(i,e,t),remove:i=>nu(i)};var au=Ar.ErrorCodes.ATV_SCHEDULER_UNAVAILABLE,ou=Ar.ErrorCodes.ATV_SCHEDULER_REQUEST_FAILED_HTTP_STATUS_CODE_4XX,su=Ar.ErrorCodes.ATV_SCHEDULER_REQUEST_FAILED_HTTP_STATUS_CODE_5XX,lu=Ar.ErrorCodes.ATV_SCHEDULER_REQUEST_TIMED_OUT,Pt=class Pt{constructor(i,e,{fetchService:r=new Er,store:n=Jo(30),logger:a=he("ssai.SmartclipAtvIdResolver")}={}){this.player=i;this.config=e;this.fetchService=r,this.store=n,this.logger=a}async getId(){return this.id?this.id:(this.id=this.store.get(Pt.LOCAL_STORAGE_KEY),this.id?this.id:(this.id=await this.fetchId(),this.id&&this.store.set(Pt.LOCAL_STORAGE_KEY,this.id),this.id))}async fetchId(){var i;try{let e={timeout:((i=this.config)==null?void 0:i.atvTimeout)||400};return(await(await this.fetchService.get(Pt.UUID_API_URL,e)).getBody()).uuid}catch(e){let[r,n]=await this.getErrorCodeAndMessage(e);this.logger.warn(n,e);let a=e instanceof It?await e.getBody():void 0,o=new $o(Ee.Error,{message:n,context:a,code:r,originalEvent:e});this.player.dispatchEvent(o);return}}async getErrorCodeAndMessage(i){let e=au,r="Fetching an ATV id from smartclip failed";if(!(i instanceof It))return[e,r];if(await i.getBody()=="timeout")return e=lu,r="Fetching an ATV id from smartclip failed (Timeout Error)",[e,r];let n=i.getStatus();return r=`Fetching an ATV id from smartclip failed (HTTP Status ${n})`,n>=400&&n<500?e=ou:n>=500&&n<600&&(e=su),[e,r]}};Pt.LOCAL_STORAGE_KEY="smartclipAtvId",Pt.UUID_API_URL="https://scheduler.atv.smartclip.net/api/uuid?bounced=1";var ei=Pt;var $=Re(mn());var An=Re(mn()),En=class extends An.AnalyticEventObserver{constructor(e,r=he("ssai.Yospace.EventObserver")){super();this.handleTimelineUpdate=e;this.logger=r}onAdvertBreakStart(e,r){this.logger.trace("Break start")}onAdvertBreakEnd(e){this.logger.trace("Break end")}onAdvertEnd(e){this.logger.trace("Advert end"),this.handleTimelineUpdate&&this.handleTimelineUpdate()}onAdvertStart(e,r){this.logger.trace("Advert start")}onAdvertBreakEarlyReturn(e,r){this.logger.trace("Early return")}onAnalyticUpdate(e){this.logger.trace("Analytic update"),this.handleTimelineUpdate&&this.handleTimelineUpdate()}onSessionError(e,r){switch(e){case An.SessionErrorCode.TIMEOUT:this.logger.trace("Session timeout"),r.shutdown();break;default:this.logger.trace(`unhandled session error with code: ${e}`);break}}onTrackingEvent(e,r){this.logger.trace("Tracking event:"+e)}};var lr=Re(mn()),Tn=class extends lr.PlaybackPolicyHandler{constructor(e){super();this.playbackMode=e}canChangeVolume(e,r,n){return!0}canClickThrough(e,r,n){return!0}canPause(e,r){return this.playbackMode!==lr.PlaybackMode.LIVE}canResize(e,r,n){return!0}canResizeCreative(e,r,n){return!0}canSkip(e,r,n){if(this.playbackMode!==lr.PlaybackMode.LIVE)return-1;{let a=this.isInAdvert(e,r);if(!a)return-1;let o=a.getSkipOffset();return o===-1?-1:(a.isActive()?o>=0&&(o=Math.max(0,a.getStart()+o-e)):o=0,o)}}canStop(e,r){return!0}closestActiveBreakPriorTo(e,r){let n=null;for(let a of r)a.getStart()<e&&a.isActive()&&(n=a);return n}didSeek(e,r,n){this.playbackMode!==lr.PlaybackMode.LIVE&&e<r&&this.setInactiveAllAdBreaksBetween(e,r,n)}isInActiveBreak(e,r){for(let n=0;n<r.length;++n){let a=r[n];if(a.getStart()<=e&&e<a.getStart()+a.getDuration())return a.isActive()?a:null}return null}isInAdvert(e,r){for(let n=0;n<r.length;++n){let a=r[n];if(a.getStart()<=e&&e<a.getStart()+a.getDuration())for(let o=0;o<a.getAdverts.length;++o){let s=a.getAdverts()[o];if(s.getStart()<=e&&e<s.getStart()+s.getDuration())return s}}return null}didSkip(e,r,n){return this.didSeek(e,r,n)}setInactiveAllAdBreaksBetween(e,r,n){for(let a=0;a<n.length;++a){let o=n[a];o.isActive()&&o.getStart()>=e&&o.getStart()+o.getDuration()<=r&&o.setInactive()}}setPlaybackMode(e){this.playbackMode=e}willSeekTo(e,r,n){let a=n,o=this.isInActiveBreak(n,r);return o||(o=this.closestActiveBreakPriorTo(e,r),o?a=o.getStart():a=e),a}};var Py="4",_y="1",Sn=class{constructor(i,e=he("ssai.Yospace.Adapter"),r=he("ssai.Yospace.SDK")){this.player=i;this.logger=e;this.loggerForYospaceSdkOnly=r;this.started=!1;Ly(this.loggerForYospaceSdkOnly),this.setupPlayerEventHandling()}async createNewSessionForSource(i){if(this.shutdownCurrentSession(),!i.isYospace)return this.logger.error("cannot use the Yospace SDK for non isYospace sources"),i;try{this.session=await this.initSession(i)}catch(e){return this.logger.error("creating a Yospace CSM live session failed",e),i}return this.session.getSessionState()===$.SessionState.INITIALISED?this.handleSessionInitialized(this.session,i):(this.session.getSessionState()===$.SessionState.NO_ANALYTICS?this.logger.info("session state: NO_ANALYTICS"):this.session.getSessionState()===$.SessionState.FAILED&&this.logger.error("failed to initialize session. ResultCode = "+this.session.getResultCode()),i)}handleSessionInitialized(i,e){this.logger.info("session state: INITIALISED"),i.addAnalyticObserver(new En),i.setPlaybackPolicyHandler(new Tn($.PlaybackMode.LIVE));let r=i.getPlaybackUrl();return{...e,url:r}}async initSession(i){let e=new $.SessionProperties;e.setUserAgent(navigator.userAgent);let r=new URL(i.url);r.searchParams.set("yo.av",Py),r.searchParams.set("fwd_yssdk",_y);let n=r.toString();this.logger.trace(`url USED AS INPUT for session creation: ${n}`);let a=await $.SessionLive.create(n,e);return this.logger.trace("session created",this.session),a}addOnPlayerEventForwarders(){this.player.addEventListener(Ee.Ready,()=>{Ge(this.session)&&this.session.onPlayerEvent($.PlayerEvent.PLAYBACK_READY,this.getPlayheadInMs())}),this.player.addEventListener(Ee.ContentStart,()=>{Ge(this.session)&&(this.session.onPlayerEvent($.PlayerEvent.START,this.getPlayheadInMs()),this.started=!0)}),this.player.addEventListener(Ee.ContentEnd,()=>{Ge(this.session)&&this.session.onPlayerEvent($.PlayerEvent.STOP,this.getPlayheadInMs())}),this.player.addEventListener(Ee.Paused,()=>{Ge(this.session)&&this.started&&this.session.onPlayerEvent($.PlayerEvent.PAUSE,this.getPlayheadInMs())}),this.player.addEventListener(Ee.Play,()=>{Ge(this.session)&&this.started&&this.session.onPlayerEvent($.PlayerEvent.RESUME,this.getPlayheadInMs())}),this.player.addEventListener(Ee.StallStarted,()=>{Ge(this.session)&&this.session.onPlayerEvent($.PlayerEvent.STALL,this.getPlayheadInMs())}),this.player.addEventListener(Ee.StallEnded,()=>{Ge(this.session)&&this.session.onPlayerEvent($.PlayerEvent.CONTINUE,this.getPlayheadInMs())}),this.player.addEventListener(Ee.Seeked,()=>{Ge(this.session)&&this.session.onPlayerEvent($.PlayerEvent.SEEK,this.getPlayheadInMs())})}setupPlayerEventHandling(){this.player.addEventListener(Ee.Destroy,()=>this.shutdownCurrentSession()),this.addOnPlayerEventForwarders(),this.player.addEventListener(Ee.TimedMetadata,i=>{if(!Ge(this.session))return;let e=i.metadata;if(!("ymid"in e&&"yseq"in e&&"ytyp"in e&&"ydur"in e)){this.logger.trace("TimedMetadataEvent WITHOUT Yospace SDK relevant values ignored",i);return}let{ymid:n,yseq:a,ytyp:o,ydur:s}=e;this.logger.trace("TimedMetadataEvent WITH Yospace SDK relevant values",i);let c=$.TimedMetadata.createFromMetadata(n,a,o,Number.parseFloat(s),i.playhead*1e3);this.logger.trace("created YospaceTimedMetadata",c),this.session.onTimedMetadata(c)}),this.player.addEventListener(Ee.VolumeChanged,()=>{Ge(this.session)&&this.session.onVolumeChange(this.player.getVolume()===0)}),this.player.addEventListener(Ee.Muted,()=>{Ge(this.session)&&this.session.onVolumeChange(!0)}),this.player.addEventListener(Ee.Unmuted,()=>{Ge(this.session)&&this.session.onVolumeChange(!1)})}getPlayheadInMs(){return this.player.getCurrentTime(!0)*1e3}shutdownCurrentSession(){if(this.session){try{this.session.shutdown()}catch(i){this.logger.warn("shutdown of Yospace CSM session failed",i)}this.session=void 0,this.started=!1}}},Ly=t=>{class i{static debug(r){t.debug(r)}static error(r){t.error(r)}static info(r){t.info(r)}static trace(r){t.trace(r)}static warn(r){t.warn(r)}}$.YoLog.setLogger(i),t.isLoggingActiveForLevel(dr.Debug)&&$.YoLog.setDebugFlags($.DebugFlags.DEBUG_ALL)};function Ge(t){return t!==void 0&&t.getSessionState()===$.SessionState.INITIALISED}var wy=[Vt.Live,Vt.Event,Vt.FAST],bn=class extends Qo{constructor(e){super();this.pluginConfig=e}getKey(){return"foundation.plugin.ssai"}setPlayer(e){super.setPlayer(e);let r=new ei(e,this.pluginConfig);this.manifestSourcesUrlRewriter=new Zr(r,this.pluginConfig)}async prepareMediaSource(e){var o,s;if(!this.player||!this.manifestSourcesUrlRewriter)return e.source;let r=await this.manifestSourcesUrlRewriter.updateSource(e.source,this.player),n=(s=(o=this.pluginConfig)==null?void 0:o.yospaceSdkEnabledForSourceTypes)==null?void 0:s.includes(e.type),a=wy.includes(e.type);return n&&a&&(this.yospaceSdkAdapter||(this.yospaceSdkAdapter=new Sn(this.player)),r=await this.yospaceSdkAdapter.createNewSessionForSource(r)),r}beforeWindowUnload(){this.yospaceSdkAdapter&&this.yospaceSdkAdapter.shutdownCurrentSession()}};return Cc(Cy);})();
